{"version":3,"sources":["db/index.ts","types/db.ts","@primer/components/AlertTransition.tsx","@primer/utils/alert.tsx","@primer/components/Divider.tsx","@primer/components/AutoHeight.tsx","@primer/types/index.ts","@primer/components/Stack.tsx","@primer/hooks/useAutoFocus.ts","@primer/components/Button.tsx","@primer/alerts/Confirm.tsx","@primer/alerts/Slideout.tsx","@primer/utils/toast.tsx","@primer/utils/constants.ts","config.ts","@primer/hooks/usePopper.tsx","@primer/hooks/useDismissable.ts","@primer/components/CustomMenu.tsx","@primer/components/ActionMenu.tsx","@primer/components/Inline.tsx","@primer/components/Actions.tsx","@primer/components/BasicTruncate.tsx","@primer/components/Table.tsx","@primer/utils/funcs.tsx","@primer/components/Icon.tsx","@primer/components/Loader.tsx","@primer/hooks/useLocalStorage.ts","@primer/components/Tooltip.tsx","@primer/components/Sidebar.tsx","assets/img/logo-text.svg","@primer/hooks/useDarkMode.ts","@primer/components/Topbar.tsx","@primer/components/MobileMenu.tsx","@primer/components/OnRouteChange.tsx","@primer/utils/versions.ts","components/Logo.tsx","@primer/components/Layouts/PageSidebar.tsx","@primer/components/Layouts/PageTopbar.tsx","@primer/components/Card.tsx","@primer/components/Form/Form.tsx","@primer/components/Form/utils.ts","@primer/components/Form/FormInput.tsx","@primer/components/Tabs.tsx","@primer/components/Form/FormSelect.tsx","db/types/Action.ts","db/types/ActionPermission.ts","db/types/Entity.ts","db/types/EntityPermission.ts","utils/funcs.tsx","db/types/Field.ts","db/types/FieldPermission.ts","db/types/Relation.ts","db/types/RelationPermission.ts","db/types/Role.ts","db/types/Unit.ts","db/types/Value.ts","db/types/Plan.ts","db/types/WorkflowStep.ts","db/types/WorkflowStepConnection.ts","pages/Login/Login.tsx","@primer/components/ButtonSpacer.tsx","@primer/components/PageHeading.tsx","@primer/components/PageContent.tsx","db/seed.ts","pages/Home.tsx","assets/img/undraw_not_found_60pq.svg","pages/NotFound.tsx","pages/Units/Units.tsx","pages/PageBuilder/utils/index.tsx","pages/PageBuilder/Widgets/types.ts","@primer/components/Suspender.tsx","@primer/hooks/openSlideout.tsx","@primer/components/TableFrame.tsx","@primer/components/Form/FormLabel.tsx","pages/PageBuilder/Widgets/Card/Edit.tsx","@primer/components/CardHeader.tsx","components/Builder/utils.tsx","components/Builder/Dropper.tsx","pages/PageBuilder/components/DropTarget.tsx","hooks/useHoverable.tsx","pages/PageBuilder/Widgets/Card/Build.tsx","pages/PageBuilder/Widgets/Card/index.ts","pages/PageBuilder/Widgets/Card/View.tsx","@primer/components/Well.tsx","pages/PageBuilder/Widgets/Well/Edit.tsx","pages/PageBuilder/Widgets/Well/Build.tsx","pages/PageBuilder/Widgets/Well/index.ts","pages/PageBuilder/Widgets/Well/View.tsx","pages/PageBuilder/Widgets/PageTitle/Edit.tsx","pages/PageBuilder/Widgets/PageTitle/index.ts","pages/PageBuilder/Widgets/PageTitle/Build.tsx","pages/PageBuilder/Widgets/PageTitle/View.tsx","components/Icon.tsx","pages/PageBuilder/Widgets/Columns/Edit.tsx","pages/PageBuilder/Widgets/Columns/Build.tsx","pages/PageBuilder/Widgets/Columns/index.ts","pages/PageBuilder/Widgets/Columns/View.tsx","pages/PageBuilder/Widgets/Field/Edit.tsx","pages/PageBuilder/Widgets/Field/index.ts","pages/PageBuilder/Widgets/Field/Build.tsx","pages/PageBuilder/Widgets/Field/View.tsx","pages/PageBuilder/Widgets/Divider/Edit.tsx","pages/PageBuilder/Widgets/Divider/index.ts","pages/PageBuilder/Widgets/Divider/Build.tsx","pages/PageBuilder/Widgets/Divider/View.tsx","@primer/components/Form/FormToggle.tsx","pages/PageBuilder/Widgets/Section/Edit.tsx","@primer/components/SectionHeader.tsx","pages/PageBuilder/Widgets/Section/Build.tsx","pages/PageBuilder/Widgets/Section/index.ts","pages/PageBuilder/Widgets/Section/View.tsx","components/Builder/Dragger.tsx","pages/PageBuilder/Widgets/index.tsx","pages/PageBuilder/PageRenderer.tsx","pages/Units/ViewUnit.tsx","@primer/components/Form/FormDate.tsx","pages/Units/UnitForm.tsx","@primer/components/Select.tsx","@primer/components/DatePicker.tsx","pages/Units/UnitHistory.tsx","assets/img/bg-grid.svg","components/Layouts/Canvas.tsx","pages/PageBuilder/components/DraggableTool.tsx","pages/PageBuilder/PageBuilder.tsx","pages/Values/ValueHistory.tsx","pages/Settings/Settings.tsx","@primer/components/NavList.tsx","@primer/components/PageNavbar.tsx","@primer/components/Badge.tsx","pages/Settings/Notifications/Notifications.tsx","@primer/components/Form/FormSection.tsx","pages/Settings/Notifications/utils/options.tsx","@primer/components/Form/useFieldArray.ts","@primer/components/Form/FormEditor.tsx","@primer/components/Expandable.tsx","pages/Settings/Templates/utils/actions.tsx","components/FormTemplateEditor.tsx","pages/Settings/Notifications/NotificationForm.tsx","pages/Settings/Templates/Templates.tsx","pages/Settings/Templates/TemplateForm.tsx","pages/Settings/Roles/Roles.tsx","@primer/components/Form/FormCheckbox.tsx","pages/Settings/Roles/RoleForm.tsx","pages/Settings/Entities/Entities.tsx","@primer/components/Form/FormInputRaw.tsx","slideouts/openField.tsx","slideouts/openAction.tsx","slideouts/openRelation.tsx","pages/Settings/Entities/EntityForm.tsx","pages/Settings/Workflows/Workflows.tsx","pages/Settings/Workflows/openWorkflowStep.tsx","pages/Settings/Workflows/WorkflowForm.tsx","db/types/Workflow.ts","pages/Settings/Modules/Modules.tsx","@primer/components/DataListColumns.tsx","@primer/components/Checkbox.tsx","pages/Settings/Modules/AddModule.tsx","pages/Settings/SiteSettings/SiteSettings.tsx","assets/img/layout-sidebar.svg","assets/img/layout-topbar.svg","pages/Settings/SiteSettings/SiteSettingsForm.tsx","pages/Test.tsx","Router.tsx","App.tsx","index.tsx"],"names":["initialSettings","title","layout","storage","siteSettings","units","values","entities","entityPermissions","fields","fieldPermissions","actions","actionPermissions","relations","relationPermissions","notifications","templates","workflows","workflowSteps","workflowStepConnections","roles","plans","renderContainer","current","dataActions","prop","all","filter","Array","prototype","call","find","id","x","save","data","added","map","push","persist","uuid","created","Date","toISOString","remove","set","key","val","get","localStorage","setItem","JSON","stringify","clear","parse","getItem","restore","AlertTransition","show","className","children","motion","div","clsx","style","originY","variants","hidden","y","visible","transition","type","ease","duration","initial","animate","exit","BackdropTransition","AnimatePresence","opacity","mountedAlerts","alert","DialogContent","Promise","resolvePromise","alertRoot","document","createElement","body","appendChild","ReactDOM","resolve","close","splice","findIndex","contains","removeChild","Divider","AutoHeight","useState","initialState","setInitialState","isAnimating","setAnimating","isVisible","setVisible","useEffect","setTimeout","padding","margin","overflow","height","onAnimationComplete","isNotNone","undefined","isLinkActionType","action","to","isButtonActionType","onClick","isSubmitActionType","isActionMenuActionType","isCustomMenuActionType","menu","isLinkRouteConfig","isAnchorRouteConfig","url","spaces","Stack","space","dividers","filteredItems","Children","toArray","reduce","list","i","props","omit","Fragment","concat","item","useAutoFocus","enabled","ref","useRef","focus","sizes","xs","sm","md","lg","xl","inline","roundedness","none","rounded","full","intents","primary","span","button","secondary","light","danger","borderless","invisible","Button","forwardRef","intent","size","disabled","isLoading","as","Comp","attrs","Confirm","message","buttonLabel","dismissable","onAccept","open","setOpen","loading","setLoading","autoFocusRef","closeAlert","handleAccept","a","e","target","stroke","fill","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","buttonIntents","buttonRoundness","buttonSizes","tabIndex","confirm","answer","Slideout","mode","closeSlideout","useCallback","backdropRef","slideout","toastRoot","holidays","name","date","site","process","REACT_APP_ENV","REACT_APP_SITE","usePopper","options","reference","popper","cleanupCallback","instantiatePopper","createPopper","modifiers","flip","offset","preventOverflow","destroy","useMemo","referenceDomNode","popperDomNode","useDismissable","Math","floor","random","ignoreClass","onClose","prevState","setPrevState","onOpen","handle","window","addEventListener","removeEventListener","useClickOutside","CustomMenu","placement","maxWidth","strategy","tooltip","scale","submit","cancel","anchor","ActionInner","side","iconSide","icon","ActionMenu","hoverable","isHover","setHover","hoverTimer","setHoverTimer","actionList","index","divider","prevOpen","onMouseOver","clearTimeout","onMouseOut","dispatchEvent","Event","ButtonIntents","ButtonRoundness","ButtonSizes","Items","static","Item","active","state","replace","console","log","disableDismiss","preventDefault","stopPropagation","isDividerActionType","wrapper","Inline","items","Actions","render","isRenderActionType","BasicTruncate","timer","isOverflowing","setOverflowing","check","clientWidth","clientHeight","scrollWidth","scrollHeight","handler","colSpan","breakpoints","xxl","visibilities","pass","vis","visibility","Table","schema","getKey","_","isStriped","queries","mediaQueryLists","q","matchMedia","getValue","mql","matches","value","setValue","forEach","addListener","removeListener","useMedia","Object","mqs","cols","responsive","tmplCols","width","join","gridTemplateColumns","col","j","truncate","onlyText","length","smartReplaceClasses","fixes","names","split","fix","pattern","test","defaultValue","isValidDate","isNaN","valueOf","ensureDate","getReservedDate","isSameDay","ordinal","k","slugify","trim","toLowerCase","fixClasses","Spinner","xmlns","cx","cy","r","Loader","spin","useLocalStorage","initialValue","error","storedValue","setStoredValue","valueToStore","Function","Tooltip","hover","X","setX","Y","setY","offsetLeft","offsetWidth","offsetTop","left","top","originX","link","inactive","white","getProps","route","min","isCurrent","isPartiallyCurrent","exact","MenuLink","href","rel","NavLink","loc","useLocation","pathname","indexOf","Sidebar","header","footer","links","setMin","changeDarkMode","querySelector","classList","useDarkMode","setDarkMode","matchesMedia","func","hasOwnProperty","Topbar","logout","darkMode","MobileMenu","withTopbar","src","logo","alt","block","OnRouteChangeWorker","prevProps","this","location","Component","OnRouteChange","versions","number","new","change","bug","LogoWithText","Logo","PageSidebar","releases","sort","b","semver","gt","db","entity","plural","fallback","scrollTo","PageTopbar","CardWrapper","CardContent","CardFooter","Card","wrapperRef","Form","context","useForm","onSubmit","handleSubmit","formData","helpers","setSubmitting","useFormik","validate","validations","required","max","watch","getIn","FormInput","label","autoFocus","hideOptional","placeholder","description","inputProps","isRequired","useField","touched","setTouched","formik","useFormikContext","uuidv4","token","extraClassName","extraProps","onChange","onBlur","isSubmitting","tabIntents","default","container","tab","isActive","card","Tabs","tabs","htmlFor","FormSelect","clearable","onChangeProp","select","option","autoComplete","autoCorrect","spellCheck","classNamePrefix","isClearable","isDisabled","menuPlacement","components","ClearIndicator","hasValue","innerProps","restInnerProps","DropdownIndicator","actionResource","entityResource","entityId","actionId","actionPermissionResource","permission","roleId","role","roleResource","fieldResource","relationResource","unitResource","entityPermissionResource","plan","planResource","sortValuesByLatest","v4","replaceMarkers","delimiter","entries","output","unitId","unit","valueResource","fieldId","fieldPermissionResource","relatedId","relationPermissionResource","relationId","fieldPermission","field","actionPermission","relationPermission","relation","resolvedValues","foundValue","format","dateFormat","workflowStepResource","sourceId","workflowStepConnectionResource","targetId","userEntity","userOptions","firstNameField","lastNameField","Login","formContext","initialValues","username","password","user","setTab","ButtonSpacer","PageHeading","pageTitle","infoList","info","PageContent","seed","caseEntity","eventEntity","changes","triggerType","triggerRepeat","triggerEvery","triggerYearIn","triggerMonthOn","triggerWeekOn","triggerDayAt","triggerAction","obeyTriggerTiming","triggerTimingType","triggerTiming","triggerDate","ruleGroups","rules","operator","subject","content","adminRole","caseManagerRole","reviewerRole","applicantRole","view","modify","entityField","entityAction","perform","entityType","bob","String","Home","NotFound","illustration","Units","visibleFields","setVisibleFields","includes","formatted","f","PageBuilderContext","createContext","itemList","addItem","removeItem","updateItem","PageBuilderProvider","Provider","PageRendererContext","PageRendererProvider","CardType","WellType","PageTitleType","ColumnsType","FieldType","DividerType","SectionType","ErrorBoundary","Sentry","dir","defaultError","Suspender","loader","withSuspense","SlideoutInner","SlideoutHeader","subtitle","SlideoutContent","openSlideout","TableFrame","FormLabel","isOptional","OpenEdit","path","permissionsSchema","defaultChecked","tool","tools","openEdit","CardHeader","distance_aux","p","lower","upper","Dropper","accept","onDrop","distance","useDrop","drop","collect","monitor","isOver","canDrop","dropRef","handleMove","pageX","pageY","event","isClose","setClose","element","withinDistance","point","box","dx","right","dy","bottom","inside","sqrt","calcDistance","getBoundingClientRect","DropTarget","isFirst","isLast","useContext","existingItem","oldPath","create","isTool","useHoverable","isHovered","setHovered","Accepts","CardTool","CardBuild","lensPath","bindHoverable","CardView","openEditCard","Well","WellTool","WellBuild","WellView","openEditWell","PageTitleTool","PageTitleBuild","PageTitleView","markers","str","openEditPageTitle","Columns11Icon","rx","Columns12Icon","Columns21Icon","HandleIcon","WorkflowIcon","setFieldValue","ColumnsTool","ColumnsBuild","ColumnsView","openEditColumns","customOption","FieldTool","customFormat","FieldBuild","FieldView","openEditField","DividerTool","DividerBuild","DividerView","openEditDivider","Toggle","checked","color","FormCheckbox","FormToggle","SectionHeader","SectionTool","bottomBorder","SectionBuild","SectionView","openEditSection","Dragger","useDrag","isDragging","dragRef","builds","views","BuildComp","ViewComp","PageRenderer","structure","ViewUnit","weekDays","isDate","FormDate","minDate","maxDate","inputDisabled","disableHolidays","inputClassName","display","setDisplay","startOfMonth","setContext","prevValue","setPrevValue","ensuredDate","dateValue","dismissableRef","preDays","getISODay","subDays","endOfMonth","subMonths","reverse","postDays","addDays","addMonths","days","getDaysInMonth","composeRefs","onKeyDown","displayDate","c","day","isBefore","isAfter","UnitForm","valueData","newUnit","history","back","Select","theme","colors","primary25","DatePicker","hasError","UnitHistory","fieldFilter","setFieldFilter","dateFromFilter","setDateFromFilter","dateToFilter","setDateToFilter","userFilter","setUserFilter","filteredHistory","dateTime","formatRelative","Canvas","noBackground","backgroundImage","bg","DraggableTool","PageBuilder","keyName","setName","setItemList","DndProvider","backend","HTML5Backend","l","pathStart","slice","over","arr","before","after","newValue","navigate","keys","ValueHistory","Admin","toggle","NavList","PageNavbar","themes","gray","red","orange","yellow","green","teal","blue","indigo","purple","pink","Badge","Notifications","FormSection","vertical","types","repeatOptions","weekOnOptions","yearInOptions","generateMonthList","getMonthOnOptions","january","february","march","april","may","june","july","august","september","october","november","december","entityTiming","entityTimingType","useFieldArray","getFieldProps","meta","getFieldMeta","fieldArray","update","$push","swap","indexA","indexB","swapA","swapB","$splice","move","from","toMove","insert","unshift","$unshift","removedItem","pop","lastIndex","poppedItem","arrayHelpers","defaultEditorModules","toolbar","align","FormEditor","modules","readOnly","Expandable","isExpanded","setExpanded","templateTagActions","insertFn","level","FormTemplateEditor","insertTag","editor","getEditor","selection","getSelection","text","getText","deleteText","insertText","RuleGroup","appendRule","removeRule","groupIndex","prefix","Rule","string","boolean","users","NotificationForm","originalNotification","enabledDate","appendRuleGroup","removeRuleGroup","Infinity","Templates","CreateTemplate","originalTemplate","Roles","RoleForm","originalRole","formValues","entityTypeKey","Entities","typeOptions","optionsHelpers","FormInputRaw","openField","openAction","relationTypeOptions","oppositeRelationTypeOptions","openRelation","EntityForm","original","originalFields","originalActions","originalRelations","permissions","formSchema","newEntityType","toDelete","fieldsHelpers","actionsHelpers","relationsHelpers","setToDelete","fieldSchema","editedField","produce","draft","actionsSchema","editedAction","relationSchema","editedRelation","template","newField","newAction","newRelation","Workflows","isStep","isConnection","triggerOptions","step","elements","connections","outgoingConnections","incomingConnections","workflowId","isTransition","isStart","targetWorkflow","posX","posY","con","startStep","connection","TriggerSection","trigger","triggerField","fieldOptions","openWorkflowStep","dagreGraph","dagre","graphlib","Graph","setDefaultEdgeLabel","WorkflowForm","workflow","workflowResource","steps","setSteps","flat","setConnections","nodes","useStoreState","edges","generateElements","updatedStep","cons","updatedStepValues","s","onDelete","onElementsRemove","position","source","ConnectionLineType","SmoothStep","arrowHeadType","ArrowHeadType","Arrow","stepsToDelete","setStepsToDelete","connectionsToDelete","setConnectionsToDelete","onElementAdd","elementsToRemove","el","updateNodePosition","node","instance","setInstance","containerRef","menuRef","menuPos","setMenuPos","clickRef","direction","isHorizontal","setGraph","rankdir","isNode","setNode","__rf","setEdge","nodeWithPosition","targetPosition","sourcePosition","getLayoutedElements","setTransform","zoom","edge","isEdge","fieldValue","newStep","newStepValues","onNodeDragStop","onSelectionDragStop","onLoad","onConnect","params","deleteKeyCode","onPaneContextMenu","rect","connectionMode","ConnectionMode","Loose","variant","BackgroundVariant","Dots","gap","StepDisplay","Modules","columnClassNames","DataListColumns","columns","lists","Checkbox","AddModule","selected","setSelected","SiteSettingsForm","nav","signature","navSchema","perms","LayoutSidebar","LayoutTopbar","Test","Route","Router2","Wrapper","basepath","noThrow","Settings","TemplateForm","SiteSettings","App","useReducer","dispatch","Router","getElementById"],"mappings":"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","file":"static/js/main.4074a077.chunk.js","sourcesContent":["import { isUnsaved, Unsaved } from 'types/db'\nimport {\n\tEntityModel,\n\tFieldModel,\n\tActionModel,\n\tRelationModel,\n\tNotificationModel,\n\tTemplateModel,\n\tRoleModel,\n\tActionPermissionModel,\n\tRelationPermissionModel,\n\tFieldPermissionModel,\n\tEntityPermissionModel,\n\tUnitModel,\n\tValueModel,\n\tWorkflowModel,\n\tSiteSettings,\n\tWorkflowStepModel,\n} from 'db/types'\nimport { v4 as uuid } from 'uuid'\nimport { PlanModel } from './types/Plan'\nimport { WorkflowStepConnectionModel } from './types/WorkflowStepConnection'\n\ninterface Storage {\n\tsiteSettings: SiteSettings\n\tunits: UnitModel[]\n\tvalues: ValueModel[]\n\tentities: EntityModel[]\n\tentityPermissions: EntityPermissionModel[]\n\tfields: FieldModel[]\n\tfieldPermissions: FieldPermissionModel[]\n\tactions: ActionModel[]\n\tactionPermissions: ActionPermissionModel[]\n\trelations: RelationModel[]\n\trelationPermissions: RelationPermissionModel[]\n\tnotifications: NotificationModel[]\n\ttemplates: TemplateModel[]\n\tworkflows: WorkflowModel[]\n\tworkflowSteps: WorkflowStepModel[]\n\tworkflowStepConnections: WorkflowStepConnectionModel[]\n\troles: RoleModel[]\n\tplans: PlanModel[]\n}\n\nconst initialSettings: SiteSettings = { title: 'Resolutionary', layout: 'sidebar' }\n\nconst storage: Storage = {\n\tsiteSettings: initialSettings,\n\tunits: [],\n\tvalues: [],\n\tentities: [],\n\tentityPermissions: [],\n\tfields: [],\n\tfieldPermissions: [],\n\tactions: [],\n\tactionPermissions: [],\n\trelations: [],\n\trelationPermissions: [],\n\tnotifications: [],\n\ttemplates: [],\n\tworkflows: [],\n\tworkflowSteps: [],\n\tworkflowStepConnections: [],\n\troles: [],\n\tplans: [],\n}\n\nexport const renderContainer = {\n\tcurrent: () => {},\n}\n\nconst dataActions = <T extends Storage[K][0], K extends keyof Omit<Storage, 'siteSettings'>>(prop: K) => ({\n\tall: (filter?: (x: T) => boolean): T[] => {\n\t\tif (filter && storage[prop]) return Array.prototype.filter.call(storage[prop], filter)\n\t\t// @ts-ignore\n\t\treturn storage[prop] || []\n\t},\n\tfind: (id?: string | ((x: T) => boolean)): T | undefined => {\n\t\treturn Array.prototype.find.call(storage[prop], typeof id === 'function' ? id : (x) => x.id === id)\n\t},\n\tsave: (data: T | Unsaved<T>) => {\n\t\tif (isUnsaved<T>(data)) {\n\t\t\tlet x = {\n\t\t\t\t...data,\n\t\t\t\tid: uuid(),\n\t\t\t\tcreated: new Date().toISOString(),\n\t\t\t}\n\t\t\tArray.prototype.push.call(storage[prop], x)\n\t\t\tpersist()\n\t\t\trenderContainer.current()\n\t\t\treturn x\n\t\t} else {\n\t\t\tlet added = false\n\n\t\t\t// @ts-ignore\n\t\t\tstorage[prop] = storage[prop].map((x) => {\n\t\t\t\t// @ts-ignore\n\t\t\t\tif (x.id === data.id) {\n\t\t\t\t\tadded = true\n\t\t\t\t\treturn data\n\t\t\t\t}\n\t\t\t\treturn x\n\t\t\t})\n\n\t\t\tif (!added) Array.prototype.push.call(storage[prop], data)\n\n\t\t\tpersist()\n\t\t\trenderContainer.current()\n\t\t\treturn data\n\t\t}\n\t},\n\tremove: (id: string) => {\n\t\t// @ts-ignore\n\t\tstorage[prop] = storage[prop].filter((x) => x.id !== id)\n\t\tpersist()\n\t\trenderContainer.current()\n\t},\n})\n\nconst data = {\n\tsiteSettings: {\n\t\tset: <K extends keyof SiteSettings>(key: K, val: SiteSettings[K]) => {\n\t\t\tstorage.siteSettings[key] = val\n\t\t\trenderContainer.current()\n\t\t\tpersist()\n\t\t},\n\t\tget: <K extends keyof SiteSettings>(key: K) => {\n\t\t\treturn storage.siteSettings[key]\n\t\t},\n\t},\n\tunits: dataActions('units'),\n\tvalues: dataActions('values'),\n\tentities: dataActions('entities'),\n\tentityPermissions: dataActions('entityPermissions'),\n\tfields: dataActions('fields'),\n\tfieldPermissions: dataActions('fieldPermissions'),\n\tactions: dataActions('actions'),\n\tactionPermissions: dataActions('actionPermissions'),\n\trelations: dataActions('relations'),\n\trelationPermissions: dataActions('relationPermissions'),\n\tnotifications: dataActions('notifications'),\n\ttemplates: dataActions('templates'),\n\tworkflows: dataActions('workflows'),\n\tworkflowSteps: dataActions('workflowSteps'),\n\tworkflowStepConnections: dataActions('workflowStepConnections'),\n\troles: dataActions('roles'),\n\tplans: dataActions('plans'),\n}\n\nexport const persist = () => localStorage.setItem('data', JSON.stringify(storage))\n\nexport const restore = () => {\n\tconst data = JSON.parse(localStorage.getItem('data') || 'null')\n\n\tif (data) {\n\t\tstorage.siteSettings = data.siteSettings || {}\n\t\tstorage.units = data.units || []\n\t\tstorage.values = data.values || []\n\t\tstorage.entities = data.entities || []\n\t\tstorage.entityPermissions = data.entityPermissions || []\n\t\tstorage.fields = data.fields || []\n\t\tstorage.fieldPermissions = data.fieldPermissions || []\n\t\tstorage.actions = data.actions || []\n\t\tstorage.actionPermissions = data.actionPermissions || []\n\t\tstorage.relations = data.relations || []\n\t\tstorage.relationPermissions = data.relationPermissions || []\n\t\tstorage.notifications = data.notifications || []\n\t\tstorage.templates = data.templates || []\n\t\tstorage.workflows = data.workflows || []\n\t\tstorage.workflowSteps = data.workflowSteps || []\n\t\tstorage.workflowStepConnections = data.workflowStepConnections || []\n\t\tstorage.roles = data.roles || []\n\t\tstorage.plans = data.plans || []\n\t}\n}\n\nexport const clear = () => {\n\tstorage.siteSettings = initialSettings\n\tstorage.units = []\n\tstorage.values = []\n\tstorage.entities = []\n\tstorage.entityPermissions = []\n\tstorage.fields = []\n\tstorage.fieldPermissions = []\n\tstorage.actions = []\n\tstorage.actionPermissions = []\n\tstorage.relations = []\n\tstorage.relationPermissions = []\n\tstorage.notifications = []\n\tstorage.templates = []\n\tstorage.workflows = []\n\tstorage.workflowSteps = []\n\tstorage.workflowStepConnections = []\n\tstorage.roles = []\n\n\tpersist()\n}\n\nrestore()\n\nexport default data\n","export type Unsaved<T> = Omit<T, 'id'>\n\nexport const isUnsaved = <T>(x: any): x is Unsaved<T> =>\n\ttypeof x === 'object' && (typeof x.id === 'undefined' || x.id === '')\nexport const isSaved = <T>(x: any): x is Unsaved<T> => typeof x === 'object' && typeof x.id === 'string'\n\nexport type Identifier<T> = string | ((x: T) => boolean) | T\n\nexport type PK = string\nexport type FK = string\n\nexport interface Model {\n\tid: PK\n\tcreated?: string\n}\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { motion, AnimatePresence, MotionStyle } from 'framer-motion'\n\ninterface AlertTransitionProps {\n\tshow: boolean\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nexport const AlertTransition: FC<AlertTransitionProps> = ({ show, className, children }) => (\n\t<motion.div\n\t\tclassName={clsx(className, 'relative z-40')}\n\t\tstyle={{ originY: 0 } as MotionStyle}\n\t\tvariants={{\n\t\t\thidden: { y: -24 },\n\t\t\tvisible: { y: 0 },\n\t\t}}\n\t\ttransition={{\n\t\t\ttype: 'tween',\n\t\t\tease: 'easeOut',\n\t\t\tduration: 0.2,\n\t\t}}\n\t\tinitial=\"hidden\"\n\t\tanimate=\"visible\"\n\t\texit=\"hidden\"\n\t>\n\t\t{children}\n\t</motion.div>\n)\n\nexport const BackdropTransition: FC<AlertTransitionProps> = ({ show, className, children }) => (\n\t<AnimatePresence>\n\t\t{show && (\n\t\t\t<motion.div\n\t\t\t\tclassName={clsx(className, 'relative z-40')}\n\t\t\t\tstyle={{ originY: 0 } as MotionStyle}\n\t\t\t\tvariants={{\n\t\t\t\t\thidden: { opacity: 0 },\n\t\t\t\t\tvisible: { opacity: 1 },\n\t\t\t\t}}\n\t\t\t\ttransition={{\n\t\t\t\t\ttype: 'tween',\n\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\tduration: 0.2,\n\t\t\t\t}}\n\t\t\t\tinitial=\"hidden\"\n\t\t\t\tanimate=\"visible\"\n\t\t\t\texit=\"hidden\"\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</motion.div>\n\t\t)}\n\t</AnimatePresence>\n)\n\ninterface SlideoutTransitionProps {\n\tshow: boolean\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nexport const SlideoutTransition: FC<SlideoutTransitionProps> = ({ show, className, children }) => (\n\t<motion.div\n\t\tclassName={clsx(className)}\n\t\tvariants={{\n\t\t\thidden: { opacity: 0 },\n\t\t\tvisible: { opacity: 1 },\n\t\t}}\n\t\ttransition={{\n\t\t\ttype: 'tween',\n\t\t\tease: 'easeOut',\n\t\t\tduration: 0.2,\n\t\t}}\n\t\tinitial=\"hidden\"\n\t\tanimate=\"visible\"\n\t\texit=\"hidden\"\n\t>\n\t\t{children}\n\t</motion.div>\n)\n\ninterface ToastTransitionProps {\n\tshow: boolean\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nexport const ToastTransition: FC<ToastTransitionProps> = ({ show, className, children }) => (\n\t<AnimatePresence>\n\t\t{show && (\n\t\t\t<motion.div\n\t\t\t\tclassName={clsx(className, 'z-40')}\n\t\t\t\tstyle={{ originY: 1, originX: 1 } as MotionStyle}\n\t\t\t\tvariants={{\n\t\t\t\t\thidden: { scale: 0.95, opacity: 0 },\n\t\t\t\t\tvisible: { scale: 1, opacity: 1 },\n\t\t\t\t}}\n\t\t\t\ttransition={{\n\t\t\t\t\ttype: 'tween',\n\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\tduration: 0.3,\n\t\t\t\t}}\n\t\t\t\tinitial=\"hidden\"\n\t\t\t\tanimate=\"visible\"\n\t\t\t\texit=\"hidden\"\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</motion.div>\n\t\t)}\n\t</AnimatePresence>\n)\n","import { FC } from 'react'\nimport * as ReactDOM from 'react-dom'\n\nconst mountedAlerts: HTMLDivElement[] = []\n\ninterface DialogContentType<T> {\n\tresolve: (x?: T) => void\n\tclose: () => void\n}\n\nfunction alert<T>(DialogContent: FC<DialogContentType<T>>): Promise<T | undefined> {\n\treturn new Promise((resolvePromise) => {\n\t\tconst alertRoot = document.createElement('div')\n\t\tconst body = document.body\n\t\tbody.appendChild(alertRoot)\n\t\tmountedAlerts.push(alertRoot)\n\n\t\tconst close = () => {\n\t\t\tReactDOM.unmountComponentAtNode(alertRoot)\n\t\t\tmountedAlerts.splice(\n\t\t\t\tmountedAlerts.findIndex((x) => x === alertRoot),\n\t\t\t\t1\n\t\t\t)\n\t\t\tif (document.contains(alertRoot)) {\n\t\t\t\tdocument.body.removeChild(alertRoot)\n\t\t\t}\n\t\t}\n\n\t\tconst resolve = (x?: T) => resolvePromise(x)\n\n\t\tReactDOM.render(<DialogContent resolve={resolve} close={close} />, alertRoot)\n\t})\n}\n\nexport default alert\n","import { FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface DividerProps {\n\tclassName?: ClassValue\n}\n\nconst Divider: FC<DividerProps> = ({ className }) => (\n\t<div\n\t\tclassName={clsx('border-t border-black dark:border-white border-opacity-10 dark:border-opacity-10', className)}\n\t/>\n)\n\nexport default Divider\n","import { FC, ReactNode, useEffect, useState } from 'react'\nimport { motion, AnimatePresence, MotionStyle } from 'framer-motion'\n\ninterface AutoHeightProps {\n\tshow: boolean\n\tchildren: ReactNode\n\tstyle?: { [x: string]: string }\n}\n\nconst AutoHeight: FC<AutoHeightProps> = ({ show, style, children }) => {\n\tconst [initialState, setInitialState] = useState(show)\n\tconst [isAnimating, setAnimating] = useState(false)\n\tconst [isVisible, setVisible] = useState<boolean>(show)\n\n\tuseEffect(() => {\n\t\tif (show) {\n\t\t\tsetAnimating(true)\n\t\t\tsetTimeout(() => setVisible(true), 1)\n\t\t\tsetTimeout(() => setAnimating(false), 400)\n\t\t} else {\n\t\t\tsetAnimating(true)\n\t\t\tsetTimeout(() => setVisible(false), 1)\n\t\t\tsetTimeout(() => setAnimating(false), 400)\n\t\t}\n\t}, [show])\n\n\treturn (\n\t\t<AnimatePresence>\n\t\t\t{isVisible && (\n\t\t\t\t<motion.div\n\t\t\t\t\tstyle={\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\toriginY: 0,\n\t\t\t\t\t\t\tpadding: '0.5rem',\n\t\t\t\t\t\t\tmargin: '-0.5rem',\n\t\t\t\t\t\t\toverflow: isAnimating ? 'hidden' : 'visible',\n\t\t\t\t\t\t\t...style,\n\t\t\t\t\t\t} as MotionStyle\n\t\t\t\t\t}\n\t\t\t\t\tvariants={{\n\t\t\t\t\t\thidden: { height: 0 },\n\t\t\t\t\t\tvisible: { height: 'auto' },\n\t\t\t\t\t}}\n\t\t\t\t\ttransition={{\n\t\t\t\t\t\ttype: 'tween',\n\t\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\t\tduration: 0.3,\n\t\t\t\t\t}}\n\t\t\t\t\tonAnimationComplete={() => setInitialState(false)}\n\t\t\t\t\tinitial={initialState ? 'visible' : 'hidden'}\n\t\t\t\t\tanimate=\"visible\"\n\t\t\t\t\texit=\"hidden\"\n\t\t\t\t>\n\t\t\t\t\t{children}\n\t\t\t\t</motion.div>\n\t\t\t)}\n\t\t</AnimatePresence>\n\t)\n}\n\nexport default AutoHeight\n","import { ReactNode, SetStateAction } from 'react'\nimport { AxiosError } from 'axios'\nimport { Placement } from '@popperjs/core/index'\n\nexport const isAxiosError = (obj: any): obj is AxiosError => typeof obj === 'object' && obj.isAxiosError === true\n\nexport type IntentType =\n\t| 'primary'\n\t| 'secondary'\n\t| 'light'\n\t| 'save'\n\t| 'danger'\n\t| 'menu'\n\t| 'menu-danger'\n\t| 'sidebar-menu'\n\t| 'sub-menu'\n\t| 'borderless'\n\t| 'invisible'\n\t| 'none'\n\nexport type ButtonSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'inline'\n\nexport type ButtonRoundness = 'none' | 'sm' | 'rounded' | 'md' | 'lg' | 'full'\n\nexport type None = undefined | '' | false | null\n\nexport const isNotNone = <T>(x: T | None): x is T => {\n\treturn x !== undefined && x !== '' && x !== false && x !== null\n}\n\nexport type Nullish = undefined | null\n\nexport const isNotNullish = <T>(x: T | Nullish): x is T => {\n\treturn typeof x !== 'undefined' && x !== null\n}\n\nexport interface BaseActionType {\n\ttitle?: ReactNode\n\tintent?: IntentType\n\tclassName?: string\n\ticon?: ReactNode\n\ticonSide?: 'left' | 'right'\n\tdisabled?: boolean\n\tsize?: ButtonSize\n\trounded?: ButtonRoundness\n}\n\nexport interface LinkActionType extends BaseActionType {\n\tto: string\n\tstate?: { [x: string]: any }\n\treplace?: boolean\n}\n\nexport const isLinkActionType = (action: any): action is LinkActionType => typeof action.to === 'string'\n\nexport interface ButtonActionType extends BaseActionType {\n\tonClick: (e: any) => void\n\ttype?: 'button' | 'submit'\n\tisLoading?: boolean\n\tdisableDismiss?: boolean\n}\n\nexport const isButtonActionType = (action: any): action is ButtonActionType => typeof action.onClick === 'function'\n\nexport interface SubmitActionType extends BaseActionType {\n\ttype: 'submit'\n\tisLoading?: boolean\n}\n\nexport const isSubmitActionType = (action: any): action is ButtonActionType => action.type === 'submit'\n\nexport interface DividerActionType extends BaseActionType {\n\tdivider: true\n}\n\nexport const isDividerActionType = (action: any): action is DividerActionType => action?.divider === true\n\nexport interface ActionMenuActionType extends BaseActionType {\n\tactions: ActionType[] | (ActionType[] | None)[]\n\tplacement?: Placement\n\toffset?: number | [number, number]\n\thoverable?: boolean\n}\n\nexport const isActionMenuActionType = (action: any): action is ActionMenuActionType => action.actions instanceof Array\n\nexport interface CustomMenuActionType extends BaseActionType {\n\tmenu: ReactNode\n\tmaxWidth?: number\n\tplacement?: Placement\n}\n\nexport const isCustomMenuActionType = (action: any): action is CustomMenuActionType => !!action.menu\n\nexport interface RenderActionType extends BaseActionType {\n\trender: ReactNode\n}\n\nexport const isRenderActionType = (action: any): action is RenderActionType => !!action.render\n\nexport type ActionType =\n\t| LinkActionType\n\t| ButtonActionType\n\t| SubmitActionType\n\t| ActionMenuActionType\n\t| CustomMenuActionType\n\t| DividerActionType\n\t| RenderActionType\n\t| None\n\nexport interface RouteConfig {\n\ttitle: string\n\ticon: ReactNode\n\tshow?: () => boolean\n\texact: boolean\n\tchildren?: RouteConfig[]\n\ttooltip?: ReactNode\n}\n\nexport interface LinkRouteConfig extends RouteConfig {\n\tto: string\n}\n\nexport const isLinkRouteConfig = (x: any): x is LinkRouteConfig => typeof x.to !== 'undefined'\n\nexport interface AnchorRouteConfig extends RouteConfig {\n\turl: string\n}\n\nexport const isAnchorRouteConfig = (x: any): x is AnchorRouteConfig => typeof x.url !== 'undefined'\n\nexport type SetState<T> = (x: SetStateAction<T>) => void\n\nexport interface BaseTabType {\n\ttitle: ReactNode\n\tsimpleTitle?: string\n\terrors?: number\n\tkey?: number | string\n}\n\nexport interface LinkTabType extends BaseTabType {\n\tto: string\n\tstate?: { [x: string]: any }\n\treplace?: boolean\n}\n\nexport const isLinkTabType = (action: any): action is LinkTabType => typeof action.to === 'string'\n\nexport interface ButtonTabType extends BaseTabType {\n\tonClick: (item: TabType, n: number) => void\n}\n\nexport const isButtonTabType = (action: any): action is ButtonTabType => typeof action.onClick === 'function'\n\nexport type TabType = LinkTabType | ButtonTabType\n\nexport interface PaginatedSet<T> {\n\titems: T[]\n\tpageNumber: number\n\tpageSize: number\n\ttotalCount: number\n\ttotalPages: number\n}\n\nexport interface FilterFormProps {\n\tclear: () => void\n}\n\nexport const isFile = (x: any): x is File => x instanceof File\n\nexport type RefetchFn = () => Promise<unknown>\n\nexport type ModalResolveFn<T = unknown> = (answer?: T) => void\nexport type SlideoutResolveFn<T = unknown> = (answer?: T) => void\n\nexport interface PresetValue<T> {\n\tvalue: T\n\tlocked?: boolean\n}\n\nexport type Keyed<T> = T & { key: string }\n\nexport interface PaginationSearch {\n\t[x: string]: any\n}\n\nexport interface PaginationState {\n\tpage: number\n\tpageSize: number\n\torderBy?: string\n\torderDir: number\n\tsearch?: PaginationSearch\n}\n\nexport interface InitialPaginationState {\n\tpage?: number\n\tpageSize?: number\n\torderBy?: string\n\torderDir?: number\n\tsearch?: PaginationSearch\n}\n","import { Children, FC, Fragment, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport Divider from '@primer/components/Divider'\nimport AutoHeight from '@primer/components/AutoHeight'\nimport { omit } from 'ramda'\nimport { isNotNone } from '@primer/types'\n\ninterface StackProps {\n\tspace?: SpaceType\n\tdividers?: boolean\n\tchildren: ReactNode\n\tclassName?: ClassValue\n}\n\ntype SpaceType = 0 | 1 | 2 | 3 | 4 | 6 | 8\n\nconst spaces = {\n\t0: '',\n\t1: 'pt-1',\n\t2: 'pt-2',\n\t3: 'pt-3',\n\t4: 'pt-4',\n\t6: 'pt-6',\n\t8: 'pt-8',\n}\n\nconst Stack: FC<StackProps> = ({ space = 6, dividers, className, children }: StackProps) => {\n\tconst items = Children.toArray(children)\n\n\tconst filteredItems = items.reduce<ReactNode[]>((list, x, i) => {\n\t\t// @ts-ignore\n\t\tconst type = x?.type\n\t\t// @ts-ignore\n\t\tconst children: ReactNode[] | null = x?.props?.children || null\n\t\t// @ts-ignore\n\t\tconst props = omit(['children', 'show'], x.props) || null\n\t\t// @ts-ignore\n\t\tconst show = x?.props?.show || null\n\n\t\tif (type === Fragment) {\n\t\t\treturn list.concat(children)\n\t\t}\n\n\t\treturn [\n\t\t\t...list,\n\t\t\ttype === AutoHeight ? (\n\t\t\t\t<AutoHeight show={show} {...props}>\n\t\t\t\t\t<div className={clsx(i > 0 && spaces[space || 0])}>\n\t\t\t\t\t\t{dividers && i > 0 && <Divider className={spaces[space || 0]} />}\n\t\t\t\t\t\t{children}\n\t\t\t\t\t</div>\n\t\t\t\t</AutoHeight>\n\t\t\t) : (\n\t\t\t\tx\n\t\t\t),\n\t\t]\n\t}, [])\n\n\treturn (\n\t\t<div className={clsx(`flex flex-col`, className)}>\n\t\t\t{filteredItems.filter(isNotNone).map((item, i) =>\n\t\t\t\t// @ts-ignore\n\t\t\t\titem.type === AutoHeight ? (\n\t\t\t\t\t<Fragment key={i}>{item}</Fragment>\n\t\t\t\t) : (\n\t\t\t\t\t<div key={i} className={clsx(i > 0 && spaces[space || 0])}>\n\t\t\t\t\t\t{dividers && i > 0 && <Divider className={spaces[space || 0]} />}\n\t\t\t\t\t\t{item}\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport default Stack\n","import { useEffect, useRef } from \"react\"\n\nconst useAutoFocus = <T = HTMLElement>(enabled: boolean = true) => {\n\tconst ref = useRef<T>(null)\n\n\tuseEffect(() => {\n\t\tif (ref.current && enabled) { \n\t\t\t// @ts-ignore\n\t\t\tif (typeof ref.current?.focus === 'function') {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tref.current?.focus()\n\t\t\t\t}, 100)\n\t\t\t}\n\t\t}\n\t}, [enabled])\n\n\treturn ref\n}\n\nexport default useAutoFocus","import { ReactNode, MouseEvent, forwardRef, ElementType } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { IntentType, ButtonSize, ButtonRoundness } from '@primer/types'\nimport { Spinner } from './Icon'\n\nexport const sizes = {\n\txs: 'px-2.5 py-1.5 text-xs leading-4',\n\tsm: 'px-3 py-2 text-sm leading-4',\n\tmd: 'px-4 py-2 text-sm leading-5',\n\tlg: 'px-4 py-2 text-base leading-6',\n\txl: 'px-6 py-3 text-base leading-6',\n\tinline: '',\n}\n\nexport const roundedness = {\n\tnone: '',\n\tsm: 'rounded-sm',\n\trounded: 'rounded',\n\tmd: 'rounded-md',\n\tlg: 'rounded-lg',\n\tfull: 'rounded-full',\n}\n\nexport const intents = {\n\tprimary: {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center font-medium border transition ease-in-out duration-150 antialiased',\n\t\t\t'disabled:cursor-not-allowed',\n\t\t\t'text-white dark:text-white',\n\t\t\t'border-0 border-primary-500',\n\t\t\t'bg-primary-600 hover:bg-primary-700 dark:bg-primary-600 dark:hover:bg-primary-500 active:bg-primary-700 dark:active:bg-primary-700',\n\t\t\t'focus:outline-none dark:focus:outline-none focus:ring-2 focus:ring-primary-300 dark:focus:ring-primary-300 dark:ring-offset-gray-800',\n\t\t\t'disabled:opacity-50'\n\t\t),\n\t},\n\tsecondary: {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center font-medium border transition ease-in-out duration-150',\n\t\t\t'disabled:cursor-not-allowed',\n\t\t\t'border-gray-300 focus:border-primary-500 dark:border-gray-600 dark:focus:border-primary-500',\n\t\t\t'text-gray-700 active:text-gray-800 hover:text-gray-500 dark:text-gray-200 dark:active:text-white dark:hover:text-white',\n\t\t\t'bg-white active:bg-gray-50 dark:bg-gray-800 dark:active:bg-gray-900 dark:hover:bg-gray-750',\n\t\t\t'focus:outline-none dark:focus:outline-none focus:ring-1 focus:ring-primary-500 dark:focus:ring-primary-500',\n\t\t\t'disabled:opacity-50'\n\t\t),\n\t},\n\tlight: {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center font-medium border transition ease-in-out duration-150 antialiased',\n\t\t\t'disabled:cursor-not-allowed',\n\t\t\t'text-gray-800 dark:text-white',\n\t\t\t'border-0 border-gray-500',\n\t\t\t'bg-gray-100 hover:bg-gray-200 dark:bg-gray-600 dark:hover:bg-gray-500 active:bg-gray-300 dark:active:bg-gray-700',\n\t\t\t'focus:outline-none dark:focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-300 dark:ring-offset-gray-800',\n\t\t\t'disabled:opacity-50'\n\t\t),\n\t},\n\tsave: {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center font-medium border transition ease-in-out duration-150 antialiased',\n\t\t\t'disabled:cursor-not-allowed',\n\t\t\t'text-white dark:text-white',\n\t\t\t'border-0',\n\t\t\t'bg-emerald-500 hover:bg-emerald-600 dark:bg-emerald-500 hover:bg-emerald-400 dark:hover:bg-emerald-400 active:bg-emerald-600 dark:active:bg-emerald-700',\n\t\t\t'focus:outline-none dark:focus:outline-none focus:ring-2 focus:ring-emerald-300 dark:focus:ring-emerald-700'\n\t\t),\n\t},\n\tdanger: {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center font-medium border transition ease-in-out duration-150 antialiased',\n\t\t\t'disabled:cursor-not-allowed',\n\t\t\t'text-white dark:text-white',\n\t\t\t'border-0',\n\t\t\t'bg-red-600 hover:bg-red-700 dark:bg-red-600 dark:hover:bg-red-500 active:bg-red-700 dark:active:bg-red-700',\n\t\t\t'focus:outline-none dark:focus:outline-none focus:ring-2 focus:ring-red-300 dark:focus:ring-red-300'\n\t\t),\n\t},\n\tmenu: {\n\t\tspan: 'flex',\n\t\tbutton: clsx(\n\t\t\t'w-8 h-8 inline-flex items-center justify-center rounded-full',\n\t\t\t'bg-transparent hover:bg-primary-300 hover:bg-opacity-25 dark:hover:bg-primary-300 dark:hover:bg-opacity-25 focus:bg-primary-200',\n\t\t\t'text-gray-400 hover:text-gray-500 focus:text-gray-500 dark:hover:text-gray-300',\n\t\t\t'focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t'transition ease-in-out duration-100',\n\t\t\t'dark:hover:bg-gray-800 dark:focus:bg-gray-900 dark:hover:text-gray-400'\n\t\t),\n\t},\n\t'menu-danger': {\n\t\tspan: 'inline-flex', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'w-8 h-8 inline-flex items-center justify-center rounded-full',\n\t\t\t'bg-transparent hover:bg-red-300 hover:bg-opacity-25 dark:hover:bg-red-300 dark:hover:bg-opacity-25 focus:bg-red-200',\n\t\t\t'text-red-400 hover:text-red-500 focus:text-red-500 dark:hover:text-red-300',\n\t\t\t'focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t'transition ease-in-out duration-100',\n\t\t\t'dark:hover:bg-red-800 dark:focus:bg-red-900 dark:hover:text-red-400'\n\t\t),\n\t},\n\t'sidebar-menu': {\n\t\tspan: 'flex',\n\t\tbutton: clsx(\n\t\t\t'w-8 h-8 inline-flex items-center justify-center rounded-full',\n\t\t\t'bg-transparent hover:bg-gray-700 focus:bg-gray-600',\n\t\t\t'text-gray-400 hover:text-gray-300 focus:text-gray-200',\n\t\t\t'focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t'transition ease-in-out duration-100',\n\t\t\t'dark:hover:bg-gray-800 dark:focus:bg-gray-900 dark:hover:text-gray-400'\n\t\t),\n\t},\n\t'sub-menu': {\n\t\tspan: 'flex',\n\t\tbutton: 'flex items-center justify-between text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out font-normal dark:text-gray-200 dark:hover:bg-gray-800 dark:focus:bg-gray-750',\n\t},\n\tborderless: {\n\t\tspan: 'inline hover', // shadow-sm\n\t\tbutton: clsx(\n\t\t\t'inline text-left border border-transparent hover:border-gray-300 focus:bg-gray-50 transition ease-in-out duration-150 dark:hover:border-gray-600 dark:focus:bg-gray-750',\n\t\t\t'focus:border-primary-500 dark:focus:border-primary-500',\n\t\t\t'focus:outline-none focus:ring-1 focus:ring-primary-500'\n\t\t),\n\t},\n\tinvisible: {\n\t\tspan: 'inline',\n\t\tbutton: clsx(\n\t\t\t'inline-flex items-center text-left border border-transparent',\n\t\t\t'hover:bg-gray-800 dark:hover:bg-gray-100 bg-opacity-10 hover:bg-opacity-10 dark:hover:bg-opacity-10',\n\t\t\t'focus:outline-none focus:ring-2 focus:ring-primary-500'\n\t\t),\n\t},\n\tnone: {\n\t\tspan: '',\n\t\tbutton: '',\n\t},\n}\n\ninterface ButtonProps {\n\tonClick?: (e: MouseEvent) => void\n\tchildren: ReactNode\n\tclassName?: ClassValue\n\tintent?: IntentType\n\ttype?: 'button' | 'submit'\n\tdisabled?: boolean\n\tisLoading?: boolean\n\tsize?: ButtonSize\n\trounded?: ButtonRoundness\n\tas?: ElementType\n}\n\nconst Button = forwardRef<HTMLElement, ButtonProps>(\n\t(\n\t\t{\n\t\t\tonClick,\n\t\t\ttype = 'button',\n\t\t\tintent = 'secondary',\n\t\t\tsize = 'md',\n\t\t\trounded = 'rounded',\n\t\t\tdisabled,\n\t\t\tisLoading,\n\t\t\tclassName,\n\t\t\tas = 'button',\n\t\t\tchildren,\n\t\t},\n\t\tref\n\t) => {\n\t\tconst Comp = as\n\n\t\tconst attrs = {}\n\n\t\tif (as === 'button') {\n\t\t\t// @ts-ignore\n\t\t\tattrs.type = type\n\t\t}\n\n\t\treturn (\n\t\t\t<span className={clsx('inline-flex select-none', intents[intent].span, roundedness[rounded])} ref={ref}>\n\t\t\t\t<Comp\n\t\t\t\t\t{...attrs}\n\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t'focus:outline-none',\n\t\t\t\t\t\tintents[intent].button,\n\t\t\t\t\t\tsizes[size],\n\t\t\t\t\t\troundedness[rounded],\n\t\t\t\t\t\tclassName\n\t\t\t\t\t)}\n\t\t\t\t\tonClick={onClick}\n\t\t\t\t\tdisabled={disabled || isLoading || false}\n\t\t\t\t>\n\t\t\t\t\t{isLoading && <Spinner className=\"animate-spin -ml-1 mr-3 h-4 w-4\" />}\n\t\t\t\t\t{children}\n\t\t\t\t</Comp>\n\t\t\t</span>\n\t\t)\n\t}\n)\n\nexport default Button\n","import { FC, ReactNode, useState, useRef, MouseEvent } from 'react'\nimport { BackdropTransition, AlertTransition } from '@primer/components/AlertTransition'\nimport alert from '@primer/utils/alert'\nimport { Spinner } from '@primer/components/Icon'\nimport useAutoFocus from '@primer/hooks/useAutoFocus'\nimport {\n\tintents as buttonIntents,\n\troundedness as buttonRoundness,\n\tsizes as buttonSizes,\n} from '@primer/components/Button'\nimport clsx from 'clsx'\n\ntype ConfirmIntent = 'danger' | 'primary'\n\ninterface ConfirmProps {\n\tresolve: (x?: boolean | undefined) => void\n\tclose: () => void\n\ttitle: ReactNode\n\tmessage?: ReactNode\n\tbuttonLabel?: ReactNode\n\tdismissable?: boolean\n\tintent?: ConfirmIntent\n\tonAccept?: () => Promise<any> | void\n}\n\nconst Confirm: FC<ConfirmProps> = ({\n\tresolve,\n\tclose,\n\ttitle,\n\tmessage,\n\tbuttonLabel = 'Yes',\n\tdismissable = true,\n\tintent = 'danger',\n\tonAccept,\n}) => {\n\tconst [open, setOpen] = useState(true)\n\tconst [loading, setLoading] = useState(false)\n\tconst ref = useRef<HTMLDivElement>(null)\n\n\tconst autoFocusRef = useAutoFocus<HTMLButtonElement>()\n\n\tconst closeAlert = (x: boolean) => {\n\t\tsetOpen(false)\n\t\tresolve(x)\n\t\tsetTimeout(() => {\n\t\t\tclose()\n\t\t}, 300)\n\t}\n\n\tconst handleAccept = async () => {\n\t\tif (onAccept) {\n\t\t\tsetLoading(true)\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 500))\n\t\t\tawait onAccept()\n\t\t\tcloseAlert(true)\n\t\t} else {\n\t\t\tcloseAlert(true)\n\t\t}\n\t}\n\n\treturn (\n\t\t<BackdropTransition show={open}>\n\t\t\t<div\n\t\t\t\tclassName=\"fixed inset-0 w-screen h-screen flex p-4 justify-center bg-black bg-opacity-50 overflow-y-auto z-60 backdrop-filter backdrop-grayscale\"\n\t\t\t\tonClick={(e: MouseEvent) => {\n\t\t\t\t\tif (e.target === ref.current) {\n\t\t\t\t\t\tdismissable && !loading && closeAlert(false)\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\t<AlertTransition\n\t\t\t\t\tshow={open}\n\t\t\t\t\tclassName=\"w-full pointer-events-none sm:flex sm:justify-center sm:items-start\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"bg-white dark:bg-gray-700 rounded-lg overflow-hidden shadow-xl sm:max-w-lg sm:w-full pointer-events-auto\"\n\t\t\t\t\t\tref={dismissable ? ref : undefined}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"bg-white dark:bg-gray-700 px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n\t\t\t\t\t\t\t<div className=\"sm:flex sm:items-start\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t'mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full sm:mx-0 sm:h-10 sm:w-10',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t'bg-red-100 text-red-600': intent === 'danger',\n\t\t\t\t\t\t\t\t\t\t\t'bg-indigo-100 text-indigo-600': intent === 'primary',\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<svg className=\"h-6 w-6\" stroke=\"currentColor\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left\">\n\t\t\t\t\t\t\t\t\t<h3 className=\"text-lg leading-6 font-medium text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t\t{title}\n\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t{message && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2 text-sm leading-5 text-gray-500 dark:text-gray-300\">\n\t\t\t\t\t\t\t\t\t\t\t{message}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"bg-gray-50 dark:bg-gray-750 px-4 py-3 sm:px-6 flex flex-col-reverse sm:flex-row justify-end sm:space-x-3\">\n\t\t\t\t\t\t\t<span className={clsx(buttonIntents.danger.span, buttonRoundness.md)}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={() => closeAlert(false)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t// className=\"inline-flex justify-center w-full rounded-md border border-gray-300 px-4 py-2 bg-white text-base leading-6 font-medium text-gray-700 shadow-sm hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:ring transition ease-in-out duration-150 sm:text-sm sm:leading-5 antialiased disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-600 dark:text-gray-200 dark:bg-gray-700 dark:hover:text-white dark:focus:bg-gray-700\"\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\tbuttonIntents.secondary.button,\n\t\t\t\t\t\t\t\t\t\tbuttonSizes.md,\n\t\t\t\t\t\t\t\t\t\tbuttonRoundness.md,\n\t\t\t\t\t\t\t\t\t\t'w-full sm:w-auto justify-center'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t\t\t\ttabIndex={1}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t<span className={clsx(buttonIntents[intent].span, buttonRoundness.md)}>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={handleAccept}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t// className=\"inline-flex justify-center w-full rounded-md border border-transparent px-4 py-2 bg-red-600 text-base leading-6 font-medium text-white shadow-sm hover:bg-red-500 focus:outline-none focus:border-red-700 focus:ring-red transition ease-in-out duration-150 sm:text-sm sm:leading-5 antialiased\"\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\tbuttonIntents[intent].button,\n\t\t\t\t\t\t\t\t\t\tbuttonSizes.md,\n\t\t\t\t\t\t\t\t\t\tbuttonRoundness.md,\n\t\t\t\t\t\t\t\t\t\t'w-full sm:w-auto justify-center mb-3 sm:mb-0'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t\t\t\tref={autoFocusRef}\n\t\t\t\t\t\t\t\t\ttabIndex={2}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\n\t\t\t\t\t\t\t\t\t\t{loading && <Spinner className=\"animate-spin -ml-1 mr-3 w-4 h-4\" />}\n\t\t\t\t\t\t\t\t\t\t{buttonLabel}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</AlertTransition>\n\t\t\t</div>\n\t\t</BackdropTransition>\n\t)\n}\n\nexport default Confirm\n\nexport const confirm = async ({\n\ttitle,\n\tmessage,\n\tintent,\n\tbuttonLabel,\n\tonAccept,\n}: {\n\ttitle: ReactNode\n\tmessage?: ReactNode\n\tintent?: ConfirmIntent\n\tbuttonLabel?: ReactNode\n\tonAccept?: () => Promise<any> | void\n}) => {\n\tconst answer = await alert<boolean>(({ resolve, close }) => (\n\t\t<Confirm\n\t\t\tresolve={resolve}\n\t\t\tclose={close}\n\t\t\ttitle={title}\n\t\t\tmessage={message}\n\t\t\tbuttonLabel={buttonLabel}\n\t\t\tonAccept={onAccept}\n\t\t\tdismissable={true}\n\t\t\tintent={intent}\n\t\t/>\n\t))\n\n\treturn answer\n}\n","import { ReactNode, useRef, MouseEvent, useCallback, useState } from 'react'\n// import { BackdropTransition, SlideoutTransition } from '@primer/components/AlertTransition'\nimport alert from '@primer/utils/alert'\nimport { motion, AnimatePresence, MotionStyle } from 'framer-motion'\nimport { SlideoutResolveFn } from '@primer/types'\nimport clsx from 'clsx'\nimport { BackdropTransition } from '@primer/components/AlertTransition'\n\nconst sizes = {\n\tsm: 'max-w-sm',\n\tmd: 'max-w-md',\n\tlg: 'max-w-lg',\n\txl: 'max-w-xl',\n\t'2xl': 'max-w-2xl',\n}\n\nexport type SizeValue = keyof typeof sizes\n\ninterface SlideoutProps<T> {\n\tresolve: SlideoutResolveFn<T>\n\tclose: () => void\n\tdismissable?: boolean\n\tsize?: SizeValue\n\tmode?: 'dark' | ''\n\tchildren: (close: SlideoutResolveFn<T>) => ReactNode\n}\n\nfunction Slideout<T>({ close, resolve, children, size = 'md', mode = '', dismissable = true }: SlideoutProps<T>) {\n\tconst [open, setOpen] = useState(true)\n\n\tconst closeSlideout = useCallback(\n\t\t(x) => {\n\t\t\tresolve(x)\n\n\t\t\tsetOpen(false)\n\t\t\tsetTimeout(() => {\n\t\t\t\tclose()\n\t\t\t}, 500)\n\t\t},\n\t\t[close, resolve]\n\t)\n\n\tconst backdropRef = useRef<HTMLDivElement>(null)\n\n\treturn (\n\t\t<BackdropTransition show={open}>\n\t\t\t<div\n\t\t\t\tclassName={clsx('fixed z-40 inset-0 overflow-hidden', mode)}\n\t\t\t\tonClick={(e: MouseEvent) => {\n\t\t\t\t\tif (e.target === backdropRef.current) {\n\t\t\t\t\t\tdismissable && closeSlideout(false)\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tref={backdropRef}\n\t\t\t>\n\t\t\t\t<div className=\"absolute z-40 inset-0 overflow-hidden\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"absolute z-40 inset-0 bg-black bg-opacity-50 transition-opacity backdrop-filter backdrop-grayscale\"\n\t\t\t\t\t\tonClick={() => closeSlideout(false)}\n\t\t\t\t\t/>\n\t\t\t\t\t<section className={clsx('absolute z-40 inset-y-0 right-0 w-full flex', sizes[size])}>\n\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\tclassName=\"pointer-events-none flex-1\"\n\t\t\t\t\t\t\tvariants={{\n\t\t\t\t\t\t\t\thidden: { x: '100%' },\n\t\t\t\t\t\t\t\tvisible: { x: '0%' },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttransition={{\n\t\t\t\t\t\t\t\ttype: 'tween',\n\t\t\t\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\t\t\t\tduration: 0.2,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tinitial=\"hidden\"\n\t\t\t\t\t\t\tanimate=\"visible\"\n\t\t\t\t\t\t\texit=\"hidden\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"pointer-events-auto h-full w-full\">{children(closeSlideout)}</div>\n\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BackdropTransition>\n\t)\n}\n\nexport default Slideout\n\ninterface slideoutProps<T> {\n\tdismissable?: boolean\n\tsize?: SizeValue\n\tmode: 'dark' | ''\n\tchildren: (close: SlideoutResolveFn<T>) => ReactNode\n}\n\nexport function slideout<T = boolean>({ dismissable, size, mode = '', children }: slideoutProps<T>) {\n\treturn alert<T>(({ resolve, close }) => {\n\t\treturn (\n\t\t\t<Slideout\n\t\t\t\tresolve={resolve}\n\t\t\t\tclose={close}\n\t\t\t\tchildren={children}\n\t\t\t\tdismissable={dismissable}\n\t\t\t\tsize={size}\n\t\t\t\tmode={mode}\n\t\t\t/>\n\t\t)\n\t})\n}\n","import { ReactElement } from 'react'\nimport * as ReactDOM from 'react-dom'\n\nconst toastRoot = document.createElement('div')\ntoastRoot.className = 'flex flex-col justify-start fixed inset-0 pointer-events-none z-50'\ndocument.body.appendChild(toastRoot)\n\nconst toast = (DialogContent: (props: { giveAnswer: (answer: boolean) => void }) => ReactElement): Promise<boolean> =>\n\tnew Promise((res) => {\n\t\tconst toastContainer = document.createElement('div')\n\t\ttoastRoot.appendChild(toastContainer)\n\n\t\tconst giveAnswer = (answer: boolean) => {\n\t\t\tReactDOM.unmountComponentAtNode(toastContainer)\n\t\t\tres(answer)\n\t\t}\n\n\t\tReactDOM.render(<DialogContent giveAnswer={giveAnswer} />, toastContainer)\n\t})\n\nexport default toast\n","export const holidays = [\n\t{ name: \"New Year's Day\", date: new Date('1 Jan 2021') },\n\t{ name: \"Day after New Year's Day\", date: new Date('4 Jan 2021') },\n\t{ name: 'Waitangi Day', date: new Date('8 Feb 2021') },\n\t{ name: 'Good Friday', date: new Date('2 Apr 2021') },\n\t{ name: 'Easter Monday', date: new Date('5 Apr 2021') },\n\t{ name: 'Anzac Day', date: new Date('26 Apr 2021') },\n\t{ name: \"Queen's Birthday\", date: new Date('7 Jun 2021') },\n\t{ name: 'Labour Day', date: new Date('25 Oct 2021') },\n\t{ name: 'Christmas Day', date: new Date('27 Dec 2021') },\n\t{ name: 'Boxing Day', date: new Date('28 Dec 2021') },\n\n\t{ name: \"New Year's Day\", date: new Date('3 Jan 2022') },\n\t{ name: \"Day after New Year's Day\", date: new Date('4 Jan 2022') },\n\t{ name: 'Waitangi Day', date: new Date('7 Feb 2022') },\n\t{ name: 'Good Friday', date: new Date('15 Apr 2022') },\n\t{ name: 'Easter Monday', date: new Date('18 Apr 2022') },\n\t{ name: 'Anzac Day', date: new Date('25 Apr 2022') },\n\t{ name: \"Queen's Birthday\", date: new Date('6 Jun 2022') },\n\t{ name: 'Matariki', date: new Date('24 Jun 2022') },\n\t{ name: 'Labour Day', date: new Date('24 Oct 2022') },\n\t{ name: 'Christmas Day', date: new Date('26 Dec 2022') },\n\t{ name: 'Boxing Day', date: new Date('27 Dec 2022') },\n]\n","export const env = process.env.REACT_APP_ENV || 'dev'\nexport const site = process.env.REACT_APP_SITE || 'dev'\n\nconst registry = 'nzdrc-icra.azurewebsites.net'\n\ninterface Environment {\n\turl: string\n\tregistry: string\n}\n\nconst environments: { [x: string]: Environment } = {\n\tdev: {\n\t\turl: 'https://nzdrc-api-dev.azurewebsites.net/api',\n\t\tregistry,\n\t},\n\tstaging: {\n\t\turl: 'https://nzdrc-api-stage.azurewebsites.net/api',\n\t\tregistry,\n\t},\n\tdemo: {\n\t\turl: 'https://nzdrc-api-demo.azurewebsites.net/api',\n\t\tregistry,\n\t},\n\tlivetest: {\n\t\turl: 'https://nzdrc-api.azurewebsites.net/api', //temporary\n\t\tregistry,\n\t},\n\tproduction: {\n\t\turl: 'https://nzdrc-api.azurewebsites.net/api',\n\t\tregistry,\n\t},\n}\n\nexport default environments[site]\n","import { useRef, useCallback, RefCallback, useMemo } from 'react'\nimport { createPopper, Options } from '@popperjs/core/lib/popper-lite'\nimport flip from '@popperjs/core/lib/modifiers/flip'\nimport offset from '@popperjs/core/lib/modifiers/offset'\nimport preventOverflow from '@popperjs/core/lib/modifiers/preventOverflow'\n\n/**\n * Example implementation to use Popper: https://popper.js.org/\n */\nexport function usePopper(options?: Partial<Options>): [RefCallback<Element | null>, RefCallback<HTMLElement | null>] {\n\tconst reference = useRef<Element | null>(null)\n\tconst popper = useRef<HTMLElement | null>(null)\n\n\tconst cleanupCallback = useRef(() => {})\n\n\tconst instantiatePopper = useCallback(() => {\n\t\tif (!reference.current) return\n\t\tif (!popper.current) return\n\n\t\tif (cleanupCallback.current) cleanupCallback.current()\n\n\t\tcleanupCallback.current = createPopper(reference.current, popper.current, {\n\t\t\t...options,\n\t\t\tmodifiers: [flip, offset, preventOverflow, ...(options?.modifiers || [])],\n\t\t}).destroy\n\t}, [reference, popper, cleanupCallback, options])\n\n\treturn useMemo(\n\t\t() => [\n\t\t\t(referenceDomNode) => {\n\t\t\t\treference.current = referenceDomNode\n\t\t\t\tinstantiatePopper()\n\t\t\t},\n\t\t\t(popperDomNode) => {\n\t\t\t\tpopper.current = popperDomNode\n\t\t\t\tinstantiatePopper()\n\t\t\t},\n\t\t],\n\t\t[reference, popper, instantiatePopper]\n\t)\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport useClickOutside from 'react-cool-onclickoutside'\n\ninterface DismissableOptions {\n\tonOpen?: () => void\n\tonClose?: () => void\n}\n\nconst useDismissable = (options: DismissableOptions = {}) => {\n\tconst [open, setOpen] = useState(false)\n\n\tconst [ignoreClass] = useState(`ignore-dismissable-${Math.floor(Math.random() * 999999)}`)\n\n\tconst close = useCallback(() => {\n\t\toptions.onClose && options.onClose()\n\t\tsetOpen(false)\n\t}, [options])\n\n\tconst [prevState, setPrevState] = useState(open)\n\tuseEffect(() => {\n\t\tif (open !== prevState) {\n\t\t\toptions.onOpen && open && options.onOpen()\n\t\t\tsetPrevState(open)\n\t\t}\n\t}, [open, options, prevState])\n\n\tuseEffect(() => {\n\t\tconst handle = (e: KeyboardEvent) => e.key === 'Escape' && setOpen(false)\n\n\t\tif (open) {\n\t\t\twindow.addEventListener('keyup', handle)\n\t\t} else {\n\t\t\twindow.removeEventListener('keyup', handle)\n\t\t}\n\n\t\treturn () => window.removeEventListener('keyup', handle)\n\t}, [open, close])\n\n\tconst ref = useClickOutside(\n\t\t(e) => {\n\t\t\tsetOpen(false)\n\t\t},\n\t\t{ ignoreClass }\n\t)\n\n\treturn { open, setOpen, ignoreClass, ref }\n}\n\nexport default useDismissable\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { usePopper } from '@primer/hooks/usePopper'\nimport { Placement } from '@popperjs/core/index'\nimport { motion, AnimatePresence, MotionStyle } from 'framer-motion'\nimport useDismissable from '@primer/hooks/useDismissable'\n\ninterface CustomMenuProps {\n\tmenu: ReactNode\n\tchildren: (x: { onClick: () => void }) => ReactNode\n\tclassName?: ClassValue\n\tplacement?: Placement\n\tmaxWidth?: number\n}\n\nconst CustomMenu: FC<CustomMenuProps> = ({ placement = 'bottom-end', className, children, menu, maxWidth }) => {\n\tconst [reference, tooltip] = usePopper({\n\t\tplacement,\n\t\tstrategy: 'fixed',\n\t\tmodifiers: [\n\t\t\t{\n\t\t\t\tname: 'offset',\n\t\t\t\toptions: { offset: [0, 0] },\n\t\t\t},\n\t\t],\n\t})\n\n\tconst { open, setOpen, ignoreClass, ref } = useDismissable()\n\n\treturn (\n\t\t<div className={clsx('block text-left', className)}>\n\t\t\t{/*\n\t\t\t\t// @ts-ignore */}\n\t\t\t<div ref={reference} className={ignoreClass}>\n\t\t\t\t{children({ onClick: () => setOpen((x) => !x) })}\n\t\t\t</div>\n\n\t\t\t<div ref={tooltip} className=\"z-20\">\n\t\t\t\t<div ref={ref}>\n\t\t\t\t\t<AnimatePresence>\n\t\t\t\t\t\t{open && (\n\t\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\t\tclassName={clsx(className, 'relative z-60')}\n\t\t\t\t\t\t\t\tstyle={{ originY: 0 } as MotionStyle}\n\t\t\t\t\t\t\t\tvariants={{\n\t\t\t\t\t\t\t\t\thidden: { scale: 0.95, opacity: 0 },\n\t\t\t\t\t\t\t\t\tvisible: { scale: 1, opacity: 1 },\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ttransition={{\n\t\t\t\t\t\t\t\t\ttype: 'tween',\n\t\t\t\t\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\t\t\t\t\tduration: 0.2,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tinitial=\"hidden\"\n\t\t\t\t\t\t\t\tanimate=\"visible\"\n\t\t\t\t\t\t\t\texit=\"hidden\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"mt-2 rounded-md shadow-lg focus:outline-none\"\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tmaxWidth: maxWidth\n\t\t\t\t\t\t\t\t\t\t\t? typeof maxWidth === 'number'\n\t\t\t\t\t\t\t\t\t\t\t\t? maxWidth + 'px'\n\t\t\t\t\t\t\t\t\t\t\t\t: maxWidth\n\t\t\t\t\t\t\t\t\t\t\t: 'auto',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"rounded-md ring-1 ring-black ring-opacity-5 whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t{menu}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</AnimatePresence>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default CustomMenu\n","import { FC, ReactNode, useRef, useState } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { usePopper } from '@primer/hooks/usePopper'\nimport { Placement } from '@popperjs/core/index'\nimport { Menu } from '@headlessui/react'\nimport { AnimatePresence, motion, MotionStyle } from 'framer-motion'\nimport { Link } from '@reach/router'\nimport {\n\tActionType,\n\tisActionMenuActionType,\n\tisButtonActionType,\n\tisSubmitActionType,\n\tisLinkActionType,\n\tisCustomMenuActionType,\n\tisDividerActionType,\n\tisNotNone,\n\tIntentType,\n\tButtonSize,\n\tButtonRoundness as ButtonRoundnessType,\n\tNone,\n} from '@primer/types'\nimport Button, {\n\tintents as ButtonIntents,\n\tsizes as ButtonSizes,\n\troundedness as ButtonRoundness,\n} from '@primer/components/Button'\nimport CustomMenu from '@primer/components/CustomMenu'\n\nconst intents = {\n\tprimary:\n\t\t'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal dark:text-gray-200 dark:hover:bg-gray-700 dark:focus:bg-gray-750 h-10',\n\tsecondary:\n\t\t'rounded-md block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-primary-300 hover:bg-opacity-25 dark:hover:bg-primary-300 dark:hover:bg-opacity-25 focus:outline-none focus:bg-gray-100 font-normal dark:text-gray-200 dark:focus:bg-gray-750 active:bg-gray-200 dark:active:bg-gray-700 h-10',\n\tsave: 'rounded-md block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-green-300 hover:bg-opacity-25 dark:hover:bg-green-300 dark:hover:bg-opacity-25 focus:outline-none focus:bg-green-100 hover:text-green-600 font-normal dark:text-green-200 dark:hover:bg-opacity-50 dark:hover:text-green-100 dark:focus:bg-green-400 active:bg-green-200 dark:active:bg-green-300 h-10',\n\tdanger: 'rounded-md block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-red-300 hover:bg-opacity-25 dark:hover:bg-red-300 dark:hover:bg-opacity-25 focus:outline-none focus:bg-red-100 hover:text-red-600 font-normal dark:text-red-200 dark:hover:bg-opacity-50 dark:hover:text-red-100 dark:focus:bg-red-400 active:bg-red-200 dark:active-bg-red-300 h-10',\n\tsubmit: 'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal h-10',\n\tcancel: 'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal',\n\tmenu: 'block',\n\t'sidebar-menu': '',\n\t'sub-menu':\n\t\t'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal dark:text-gray-200 dark:hover:bg-gray-800 dark:focus:bg-gray-750',\n\tanchor: 'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal',\n\tborderless:\n\t\t'block px-4 py-2 text-sm text-left w-full leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 font-normal',\n\tinvisible: '',\n\tnone: '',\n\tlight: '',\n\t'menu-danger': '',\n}\n\ninterface ActionMenuProps {\n\tactions: ActionType[] | (ActionType[] | None)[]\n\tintent?: IntentType\n\tplacement?: Placement\n\toffset?: number | [number, number]\n\thoverable?: boolean\n\tdisabled?: boolean\n\tsize?: ButtonSize\n\trounded?: ButtonRoundnessType\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nconst ActionMenu: FC<ActionMenuProps> = ({\n\tactions,\n\tintent,\n\tplacement = 'bottom-end',\n\toffset = 10,\n\thoverable = false,\n\tdisabled = false,\n\tsize,\n\trounded = 'rounded',\n\tclassName,\n\tchildren,\n}) => {\n\tconst [reference, tooltip] = usePopper({\n\t\tplacement,\n\t\tstrategy: 'fixed',\n\t\tmodifiers: [\n\t\t\t{\n\t\t\t\tname: 'offset',\n\t\t\t\toptions: { offset: offset instanceof Array ? offset : [0, offset] },\n\t\t\t},\n\t\t],\n\t})\n\n\tconst [isHover, setHover] = useState(false)\n\tconst [hoverTimer, setHoverTimer] = useState<ReturnType<typeof setTimeout> | null>()\n\n\tconst isDeepArray = (x: Array<any>): x is (ActionType[] | None)[] => x.filter(isNotNone)[0] instanceof Array\n\n\tconst actionList: ActionType[] = isDeepArray(actions)\n\t\t? actions.filter(isNotNone).reduce((list: ActionType[], actions: ActionType[], index) => {\n\t\t\t\tif (index === 0) return [...actions]\n\t\t\t\treturn [...list, { divider: true }, ...actions.filter(isNotNone)]\n\t\t  }, [])\n\t\t: actions.filter(isNotNone)\n\n\tconst prevOpen = useRef(false)\n\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx('block text-left w-full', className)}\n\t\t\tonMouseOver={() => {\n\t\t\t\tif (hoverable) {\n\t\t\t\t\tsetHover(true)\n\t\t\t\t\tif (hoverTimer) {\n\t\t\t\t\t\tclearTimeout(hoverTimer)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}}\n\t\t\tonMouseOut={() => {\n\t\t\t\tif (hoverable) {\n\t\t\t\t\tsetHoverTimer(\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tsetHover(false)\n\t\t\t\t\t\t}, 100)\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t<Menu>\n\t\t\t\t{({ open }) => {\n\t\t\t\t\t/// I dunno man, triggering a window resize event fixes this usePopper hook, which I think is jank af\n\t\t\t\t\tif (open !== prevOpen.current) {\n\t\t\t\t\t\tprevOpen.current = open\n\t\t\t\t\t\tif (open) {\n\t\t\t\t\t\t\twindow.dispatchEvent(new Event('resize'))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<span className={clsx(intent && ButtonIntents[intent].span, ButtonRoundness[rounded])}>\n\t\t\t\t\t\t\t\t<Menu.Button\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\tintent && ButtonIntents[intent].button,\n\t\t\t\t\t\t\t\t\t\tsize && ButtonSizes[size],\n\t\t\t\t\t\t\t\t\t\tButtonRoundness[rounded]\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\tref={reference}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t\t\t</Menu.Button>\n\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t<div ref={tooltip} className=\"z-20 whitespace-nowrap\">\n\t\t\t\t\t\t\t\t<AnimatePresence>\n\t\t\t\t\t\t\t\t\t{(open || isHover) && !disabled && (\n\t\t\t\t\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ originY: 0 } as MotionStyle}\n\t\t\t\t\t\t\t\t\t\t\tvariants={{\n\t\t\t\t\t\t\t\t\t\t\t\thidden: { scale: 0.95, opacity: 0 },\n\t\t\t\t\t\t\t\t\t\t\t\tvisible: { scale: 1, opacity: 1 },\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ttransition={{\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'tween',\n\t\t\t\t\t\t\t\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\t\t\t\t\t\t\t\tduration: 0.3,\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tinitial=\"hidden\"\n\t\t\t\t\t\t\t\t\t\t\tanimate=\"visible\"\n\t\t\t\t\t\t\t\t\t\t\texit=\"hidden\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.Items\n\t\t\t\t\t\t\t\t\t\t\t\tstatic\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"max-w-screen origin-top-right bg-white dark:bg-gray-900 rounded-md shadow-lg outline-none\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"p-2 rounded-md ring-1 ring-black ring-opacity-5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{actionList.filter(isNotNone).map((action, i) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisLinkActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item key={i} disabled={action.disabled}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tto={`${process.env.PUBLIC_URL}${action.to}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintents[action.intent || 'secondary'],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ring-2 ring-indigo-500 hover:ring-0':\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstate={action.state}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treplace={action.replace}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : isButtonActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!action.disabled && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={action.disabled}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('menu.item click')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (action.disableDismiss) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taction.onClick(e)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintents[action.intent || 'secondary'],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ring-2 ring-indigo-500 hover:ring-0':\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : isSubmitActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!action.disabled && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item key={i} disabled={action.disabled}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintents[action.intent || 'secondary'],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ring-2 ring-indigo-500 hover:ring-0':\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : isActionMenuActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactions={action.actions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintent={action.intent || 'sub-menu'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement={action.placement}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toffset={action.offset || [-4, -1]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thoverable={action.hoverable}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item disabled={action.disabled}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintents[action.intent || 'secondary'],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ring-2 ring-indigo-500 hover:ring-0':\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ActionMenu>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : isCustomMenuActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CustomMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmenu={action.menu}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement={action.placement}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxWidth={action.maxWidth}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ onClick }) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"block\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintent={action.intent || 'secondary'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</CustomMenu>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : isDividerActionType(action) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"border-t border-gray-100 dark:border-gray-700 my-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Menu.Items>\n\t\t\t\t\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</AnimatePresence>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</Menu>\n\t\t</div>\n\t)\n}\n\ninterface ActionInnerProps {\n\taction: ActionType\n}\n\nconst ActionInner: FC<ActionInnerProps> = ({ action }) => {\n\tif (!isNotNone(action)) return null\n\n\tlet side = action.iconSide || 'left'\n\n\treturn (\n\t\t<div className=\"flex items-center justify-between\">\n\t\t\t<div className=\"flex items-center\">\n\t\t\t\t{side === 'left' && action.icon ? (\n\t\t\t\t\t<span className={clsx(action.title ? '-ml-1 mr-3 opacity-75' : '-ml-1 -mr-1')}>{action.icon}</span>\n\t\t\t\t) : null}\n\t\t\t\t{action.title}\n\t\t\t</div>\n\t\t\t{side === 'right' && action.icon ? <span className=\"-mr-1 ml-2\">{action.icon}</span> : null}\n\t\t</div>\n\t)\n}\n\nexport default ActionMenu\n","import { Children, FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface InlineProps {\n\tspace?: SpaceType\n\tchildren: ReactNode\n\tclassName?: ClassValue\n}\n\ntype SpaceType = 0 | 1 | 2 | 3 | 4 | 6 | 8\n\nconst spaces = {\n\t0: {\n\t\twrapper: '',\n\t\titem: '',\n\t},\n\t1: {\n\t\twrapper: '-ml-1 -mt-1',\n\t\titem: 'pl-1 pt-1',\n\t},\n\t2: {\n\t\twrapper: '-ml-2 -mt-2',\n\t\titem: 'pl-2 pt-2',\n\t},\n\t3: {\n\t\twrapper: '-ml-3 -mt-3',\n\t\titem: 'pl-3 pt-3',\n\t},\n\t4: {\n\t\twrapper: '-ml-4 -mt-4',\n\t\titem: 'pl-4 pt-4',\n\t},\n\t6: {\n\t\twrapper: '-ml-6 -mt-6',\n\t\titem: 'pl-6 pt-6',\n\t},\n\t8: {\n\t\twrapper: '-ml-8 -mt-8',\n\t\titem: 'pl-8 pt-8',\n\t},\n}\n\nconst Inline: FC<InlineProps> = ({ space = 3, children, className }) => {\n\tconst items = Children.toArray(children)\n\n\treturn (\n\t\t<div className={clsx('flex flex-wrap', spaces[space || 0].wrapper, className)}>\n\t\t\t{items.map((item, i) => (\n\t\t\t\t<div key={i} className={clsx('flex items-center', spaces[space || 0].item)}>\n\t\t\t\t\t{item}\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nexport default Inline\n","import { FC } from 'react'\nimport { Link } from '@reach/router'\nimport {\n\tActionType,\n\tisActionMenuActionType,\n\tisButtonActionType,\n\tisSubmitActionType,\n\tisLinkActionType,\n\tisCustomMenuActionType,\n\tisNotNone,\n\tisRenderActionType,\n} from '@primer/types'\nimport ActionMenu from './ActionMenu'\nimport CustomMenu from './CustomMenu'\nimport Inline from './Inline'\nimport Button from './Button'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface ActionsProps {\n\tactions?: ActionType[] | ActionType\n\tclassName?: ClassValue\n}\n\nconst Actions: FC<ActionsProps> = ({ actions = [], className }) => {\n\tconst actionList = (actions instanceof Array ? actions : [actions]).filter(isNotNone)\n\n\treturn (\n\t\t<Inline className={clsx('inline-flex', className)}>\n\t\t\t{actionList.map((action, i) =>\n\t\t\t\tisLinkActionType(action) ? (\n\t\t\t\t\t<Link\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tto={`${process.env.PUBLIC_URL}${action.to}`}\n\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\tstate={action.state}\n\t\t\t\t\t\treplace={action.replace}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button intent={action.intent} size={action.size} rounded={action.rounded}>\n\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Link>\n\t\t\t\t) : isButtonActionType(action) ? (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tintent={action.intent}\n\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\taction.onClick && action.onClick(e)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tdisabled={action.disabled || action.isLoading || false}\n\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\ttype={action.type}\n\t\t\t\t\t\tisLoading={action.isLoading}\n\t\t\t\t\t\tsize={action.size}\n\t\t\t\t\t\trounded={action.rounded}\n\t\t\t\t\t>\n\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t</Button>\n\t\t\t\t) : isSubmitActionType(action) ? (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tintent={action.intent}\n\t\t\t\t\t\tdisabled={action.disabled || action.isLoading || false}\n\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\ttype={action.type}\n\t\t\t\t\t\tisLoading={action.isLoading}\n\t\t\t\t\t\tsize={action.size}\n\t\t\t\t\t\trounded={action.rounded}\n\t\t\t\t\t>\n\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t</Button>\n\t\t\t\t) : isActionMenuActionType(action) ? (\n\t\t\t\t\t<ActionMenu\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tactions={action.actions}\n\t\t\t\t\t\tintent={action.intent || 'secondary'}\n\t\t\t\t\t\tplacement={action.placement}\n\t\t\t\t\t\toffset={action.offset}\n\t\t\t\t\t\thoverable={action.hoverable}\n\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\tdisabled={action.disabled}\n\t\t\t\t\t\tsize={action.size || 'md'}\n\t\t\t\t\t\trounded={action.rounded}\n\t\t\t\t\t>\n\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t</ActionMenu>\n\t\t\t\t) : isCustomMenuActionType(action) ? (\n\t\t\t\t\t<CustomMenu\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tmenu={action.menu}\n\t\t\t\t\t\tplacement={action.placement}\n\t\t\t\t\t\tclassName={action.className}\n\t\t\t\t\t\tmaxWidth={action.maxWidth}\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ onClick }) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tintent={action.intent}\n\t\t\t\t\t\t\t\tdisabled={action.disabled}\n\t\t\t\t\t\t\t\tsize={action.size}\n\t\t\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ActionInner action={action} />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</CustomMenu>\n\t\t\t\t) : isRenderActionType(action) ? (\n\t\t\t\t\t<div key={i}>{action.render}</div>\n\t\t\t\t) : null\n\t\t\t)}\n\t\t</Inline>\n\t)\n}\n\ninterface ActionInnerProps {\n\taction: ActionType\n}\n\nconst ActionInner: FC<ActionInnerProps> = ({ action }) => {\n\tif (!isNotNone(action)) return null\n\n\tif ((isButtonActionType(action) || isSubmitActionType(action)) && action.isLoading) return <>{action.title}</>\n\n\treturn (\n\t\t<>\n\t\t\t{(action.iconSide === 'left' || !action.iconSide) && action.icon ? (\n\t\t\t\t<span className={clsx(action.title ? '-ml-1 mr-2' : '')}>{action.icon}</span>\n\t\t\t) : null}\n\t\t\t{action.title}\n\t\t\t{action.iconSide === 'right' && action.icon ? <span className=\"-mr-1 ml-2\">{action.icon}</span> : null}\n\t\t</>\n\t)\n}\n\nexport default Actions\n","import { FC, useState, useRef, useCallback, useEffect, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface BasicTruncateProps {\n\ttitle: string\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nconst BasicTruncate: FC<BasicTruncateProps> = ({ title, className, children }) => {\n\tconst ref = useRef<HTMLSpanElement>(null)\n\tconst timer = useRef<NodeJS.Timeout | undefined>(undefined)\n\tconst [isOverflowing, setOverflowing] = useState(false)\n\n\tconst check = useCallback(() => {\n\t\tif (ref.current) {\n\t\t\tconst { clientWidth, clientHeight, scrollWidth, scrollHeight } = ref.current\n\t\t\tsetOverflowing(scrollHeight > clientHeight || scrollWidth > clientWidth)\n\t\t}\n\t}, [])\n\n\tuseEffect(() => {\n\t\tconst handler = () => {\n\t\t\tif (timer.current) clearTimeout(timer.current)\n\t\t\ttimer.current = setTimeout(check, 500)\n\t\t}\n\t\twindow.addEventListener('resize', handler)\n\t\treturn () => window.removeEventListener('resize', handler)\n\t}, [check])\n\n\tuseEffect(check, [check])\n\n\treturn (\n\t\t<span\n\t\t\tref={ref}\n\t\t\tclassName={clsx('overflow-ellipsis overflow-hidden', className)}\n\t\t\ttitle={isOverflowing ? title : ''}\n\t\t>\n\t\t\t{children}\n\t\t</span>\n\t)\n}\n\nexport default BasicTruncate\n","import { useEffect, useState, useCallback, useMemo, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport Actions from '@primer/components/Actions'\nimport Truncate from '@primer/components/BasicTruncate'\nimport { ActionType, isNotNone, None } from '@primer/types'\nimport { onlyText } from 'react-children-utilities'\n\nconst colSpan: { [key: number]: string } = {\n\t1: 'col-span-1',\n\t2: 'col-span-2',\n\t3: 'col-span-3',\n\t4: 'col-span-4',\n\t5: 'col-span-5',\n\t6: 'col-span-6',\n\t7: 'col-span-7',\n\t8: 'col-span-8',\n\t9: 'col-span-9',\n\t10: 'col-span-10',\n\t11: 'col-span-11',\n\t12: 'col-span-12',\n}\n\nconst useMedia = (queries: string[]) => {\n\tconst mediaQueryLists = useMemo(() => queries.map((q) => window.matchMedia(q)), [queries])\n\n\tconst getValue = useCallback(() => {\n\t\tconst matches = mediaQueryLists.map((mql) => mql.matches)\n\t\treturn matches\n\t}, [mediaQueryLists])\n\n\tconst [value, setValue] = useState<boolean[]>(getValue)\n\n\tuseEffect(() => {\n\t\tconst handler = () => setValue(getValue)\n\t\tmediaQueryLists.forEach((mql) => mql.addListener(handler))\n\t\treturn () => mediaQueryLists.forEach((mql) => mql.removeListener(handler))\n\t}, [getValue, mediaQueryLists])\n\n\treturn value\n}\n\nconst breakpoints = {\n\tsm: '640px',\n\tmd: '768px',\n\tlg: '1024px',\n\txl: '1280px',\n\txxl: '1536px',\n}\n\ntype Breakpoint = 'sm' | 'md' | 'lg' | 'xl' | 'xxl'\n\ntype OnClickParams = { [x: string]: any }\n\nexport const isVisible =\n\t(visibilities: Array<Visibility | None>) =>\n\t<T,>(x: TableCol<T>) =>\n\t\tvisibilities.reduce<boolean>((pass, vis) => pass || x.visibility === vis, false)\n\ntype Visibility = 'copy-only' | 'screen-only' | 'all'\n\nexport interface TableCol<T> {\n\ttitle: ReactNode\n\tvalue: (x: T, i: number) => ReactNode\n\tcopyValue?: (x: T, i: number) => string\n\ttruncate?: boolean\n\twidth?: string\n\tclassName?: ClassValue\n\tresponsive?: Breakpoint\n\tonClick?: (x: string, y: OnClickParams) => void\n\tvisibility?: Visibility\n}\n\nexport interface TableSchema<T> {\n\tcols: (TableCol<T> | None)[]\n\tactions?: (x: T, i: number) => ActionType[] | None\n}\n\ninterface TableProps<T> {\n\tschema: TableSchema<T>\n\titems: T[]\n\tgetKey?: (x: T, i: number) => number | string\n\tisStriped?: boolean\n\tclassName?: ClassValue\n}\n\nconst Table = <T,>({ schema, items, getKey = (_, i) => i, isStriped = false, className }: TableProps<T>) => {\n\tconst [sm, md, lg, xl, xxl] = useMedia(Object.values(breakpoints).map((x) => `(min-width: ${x})`))\n\tconst mqs = { sm, md, lg, xl, xxl }\n\n\tconst cols = schema.cols\n\t\t.filter(isNotNone)\n\t\t.filter(isVisible([undefined, 'all', 'screen-only']))\n\t\t.filter((x) => {\n\t\t\tif (x.responsive) {\n\t\t\t\treturn mqs[x.responsive]\n\t\t\t}\n\n\t\t\treturn true\n\t\t})\n\n\tconst tmplCols = cols.map((x) => x.width || 'minmax(0, auto)').join(' ')\n\n\tconst actions = schema.actions\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<div\n\t\t\t\tclassName=\"grid border-t border-gray-200 dark:border-gray-600\"\n\t\t\t\tstyle={{\n\t\t\t\t\tgridTemplateColumns: isNotNone(actions) ? tmplCols.concat(' minmax(auto, max-content)') : tmplCols,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{cols.map((col, i) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t'px-5 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap dark:border-gray-600 dark:bg-gray-750 dark:text-gray-300',\n\t\t\t\t\t\t\tcol.className\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{col.title}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\n\t\t\t\t{isNotNone(actions) && (\n\t\t\t\t\t<div className=\"px-5 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap dark:border-gray-600 dark:bg-gray-750 dark:text-gray-300\"></div>\n\t\t\t\t)}\n\n\t\t\t\t{items.map((item, i) => (\n\t\t\t\t\t<div key={getKey(item, i)} className=\"contents group\">\n\t\t\t\t\t\t{cols.map((col, j) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={j}\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'min-h-11 whitespace-nowrap text-sm leading-5 text-gray-500 dark:text-gray-300 group-hover:text-gray-700 dark:group-hover:text-gray-100 flex items-center border-b border-gray-100 dark:border-gray-600 group-hover:bg-primary-50 dark:group-hover:bg-gray-600',\n\t\t\t\t\t\t\t\t\tj === 0 && 'font-medium',\n\t\t\t\t\t\t\t\t\t!col.truncate && 'px-5 py-4',\n\t\t\t\t\t\t\t\t\tisStriped && i % 2 && 'bg-gray-50 dark:bg-gray-750',\n\t\t\t\t\t\t\t\t\tcol.className\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{col.truncate ? (\n\t\t\t\t\t\t\t\t\t<Truncate title={onlyText(col.value(item, i))} className=\"px-6 py-4\">\n\t\t\t\t\t\t\t\t\t\t{col.value(item, i)}\n\t\t\t\t\t\t\t\t\t</Truncate>\n\t\t\t\t\t\t\t\t) : col.value ? (\n\t\t\t\t\t\t\t\t\tcol.value(item, i)\n\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{actions?.length ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'px-5 whitespace-nowrap text-sm leading-5 text-gray-500 dark:text-gray-300 group-hover:text-gray-700 dark:group-hover:text-gray-100 flex items-center justify-center border-b border-gray-100 dark:border-gray-600 group-hover:bg-primary-50 dark:group-hover:bg-gray-600',\n\t\t\t\t\t\t\t\t\tisStriped && i % 2 && 'bg-gray-50 dark:bg-gray-750'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Actions actions={actions(item, i)} className=\"flex-nowrap\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\n\t\t\t\t{items.length === 0 && (\n\t\t\t\t\t<div className=\"contents group\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\tcolSpan[cols.length + (actions?.length ? 1 : 0)],\n\t\t\t\t\t\t\t\t'px-6 py-3',\n\t\t\t\t\t\t\t\t'whitespace-nowrap text-sm leading-5 text-gray-500 dark:text-gray-300 flex items-center justify-center border-b border-gray-100 dark:border-gray-600 select-none'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tNo items\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Table\n","import { ReactNode } from 'react'\nimport { AxiosError } from 'axios'\nimport { warning } from '../alerts'\nimport { WindowLocation } from '@reach/router'\nimport { isNotNone, None } from '@primer/types'\nimport { differenceInDays, format, formatRelative, parseISO, isSameDay } from 'date-fns'\nimport { holidays } from './constants'\nimport { env } from 'config'\nimport * as Sentry from '@sentry/react'\nimport { utcToZonedTime, format as formatTZ } from 'date-fns-tz'\nimport { TableSchema, isVisible } from '@primer/components/Table'\nimport { onlyText } from 'react-children-utilities'\n\nexport const nzDate = (x: Date) => utcToZonedTime(x, 'Pacific/Auckland')\nexport const isNZ = () => formatTZ(new Date(), 'zzzz').indexOf('New Zealand') > -1\n\ninterface ClassFixType {\n\tpattern: RegExp\n\tdefaultValue: string\n}\n\nexport const smartReplaceClasses = (className: string, fixes: ClassFixType[]) => {\n\tlet names = className.split(' ')\n\n\tfor (let i = 0; i < fixes.length; i++) {\n\t\tlet fix = fixes[i]\n\t\tif (!names.find((x) => fix.pattern.test(x))) names.push(fix.defaultValue)\n\t}\n\n\treturn names.join(' ')\n}\n\nexport const handleError = (error: AxiosError) => {\n\tlet message: ReactNode = null\n\n\tif (error?.response?.data.title) {\n\t\tmessage = <p>{error.response.data.title}</p>\n\t}\n\n\tif (error?.response?.data.errors) {\n\t\t// @ts-ignore\n\t\tmessage = Object.values(error.response.data.errors).map((x: string, i: number) => <p key={i}>{x}</p>)\n\t}\n\n\twarning({ title: 'An error occurred', message })\n}\n\nexport const enumToOption = (item: any) => {\n\treturn Object.keys(item)\n\t\t.filter((x) => isNaN(+x))\n\t\t.map((label) => ({ label, value: item[label] }))\n}\n\n// https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string\nexport const humanFileSize = (bytes: number, si = true) => {\n\tvar thresh = si ? 1000 : 1024\n\tif (Math.abs(bytes) < thresh) {\n\t\treturn bytes + ' B'\n\t}\n\tvar units = si\n\t\t? ['kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n\t\t: ['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB']\n\tvar u = -1\n\tdo {\n\t\tbytes /= thresh\n\t\t++u\n\t} while (Math.abs(bytes) >= thresh && u < units.length - 1)\n\treturn bytes.toFixed(1) + ' ' + units[u]\n}\n\nexport const getState = <T,>(location?: WindowLocation) => location?.state as T | null\n\nexport const queryString = (obj: Object) => {\n\treturn Object.entries(obj)\n\t\t.filter(([_, val]) => !!val)\n\t\t.map(([key, val]) => [key, encodeURIComponent(val)].join('='))\n\t\t.join('&')\n}\n\nexport const getDateFromTime = (time: string, rootDate?: Date) =>\n\tnew Date(`${rootDate ? format(rootDate, 'yyyy-MM-dd') : '1970-01-01'} ` + time)\n\nexport const blobUrl = (blob: Blob) => {\n\treturn window.URL.createObjectURL(blob)\n}\n\nexport const series = async <T,>(items: T[], fn: (x: T) => Promise<any>) => {\n\tlet output = []\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\toutput.push(await fn(items[i]))\n\t}\n\n\treturn output\n}\n\nexport function isValidDate(d: Date) {\n\treturn !isNaN(d.valueOf())\n}\n\nexport const last = <T,>(arr: T[]): T => arr[arr.length - 1]\n\nexport const detectIE = () => {\n\tvar ua = window.navigator.userAgent\n\n\tvar msie = ua.indexOf('MSIE ')\n\tif (msie > 0) {\n\t\t// IE 10 or older => return version number\n\t\treturn parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10)\n\t}\n\n\tvar trident = ua.indexOf('Trident/')\n\tif (trident > 0) {\n\t\t// IE 11 => return version number\n\t\tvar rv = ua.indexOf('rv:')\n\t\treturn parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10)\n\t}\n\n\t// other browser\n\treturn false\n}\n\nconst errorIsStatus = (error: AxiosError, status: number) => {\n\treturn error.response && error.response.status === status\n}\n\nexport const getErrorMessage = (error: AxiosError) => {\n\tlet data = error ? (error.response ? error.response.data : null) : null\n\tlet message = []\n\n\tif (errorIsStatus(error, 404)) {\n\t\tmessage.push('Not found')\n\t}\n\n\tif (data) {\n\t\tif (data.title) {\n\t\t\tmessage.push(data.title)\n\t\t}\n\n\t\tif (data.errors instanceof Array) {\n\t\t\tmessage.push(data.errors[0].message.split(', ')[0])\n\t\t} else if (data.errors && typeof data.errors === 'object') {\n\t\t\tObject.values(data.errors).forEach((msg) => {\n\t\t\t\tmessage.push(msg)\n\t\t\t})\n\t\t}\n\t}\n\n\treturn message.join('\\n')\n}\n\nexport const reportError = (request: any, error: AxiosError) => {\n\tSentry.withScope((scope) => {\n\t\tscope.setExtra('request', request)\n\t\tif (error && error.response) {\n\t\t\tscope.setExtra('response', {\n\t\t\t\tdata: error.response.data,\n\t\t\t\tstatus: error.response.status,\n\t\t\t\tstatusText: error.response.statusText,\n\t\t\t\theaders: error.response.headers,\n\t\t\t})\n\t\t} else {\n\t\t\tscope.setExtra('error', error)\n\t\t}\n\n\t\tSentry.captureException(new Error('Request Failure'))\n\t})\n\n\tif (env === 'dev') {\n\t\tconsole.group('Captured Error')\n\t\tconsole.log('request', request)\n\t\tif (error && error.response) {\n\t\t\tconsole.log(\n\t\t\t\t'response',\n\t\t\t\tJSON.stringify(\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: error.response.data,\n\t\t\t\t\t\tstatus: error.response.status,\n\t\t\t\t\t\tstatusText: error.response.statusText,\n\t\t\t\t\t\theaders: error.response.headers,\n\t\t\t\t\t},\n\t\t\t\t\tnull,\n\t\t\t\t\t4\n\t\t\t\t)\n\t\t\t)\n\t\t} else {\n\t\t\tconsole.log('error', error)\n\t\t}\n\t\tconsole.groupEnd()\n\t}\n}\n\n// this thing is insane, type it later\nexport const includer = (data: any, map: any): any => {\n\tif (map instanceof Array) {\n\t\treturn data.reduce((res: any, val: any, i: any) => {\n\t\t\treturn map[i] ? [...res, includer(val, map[i])] : res\n\t\t}, [])\n\t} else if (typeof map === 'object') {\n\t\treturn Object.keys(map).reduce((res, key) => {\n\t\t\treturn map[key] ? { ...res, [key]: includer(data[key], map[key]) } : res\n\t\t}, {})\n\t} else if (typeof map === 'boolean') {\n\t\tif (map) return data\n\t}\n}\n\nexport const parseQueryCode = (str: string): { [x: string]: string } => {\n\treturn str\n\t\t.replace('?', '')\n\t\t.split('&')\n\t\t.reduce((a, x) => {\n\t\t\tlet [key, val] = x.split('=')\n\t\t\treturn { ...a, [key]: val }\n\t\t}, {})\n}\n\nexport const ensureDate = (val: string | Date | None): Date => (val instanceof Date ? val : new Date(val || ''))\n\nexport const split = (str: string) => {\n\treturn str.replace(/\\[/g, '.').replace(/\\]/g, '').split('.')\n}\n\nexport const getGSTfromIncl = (x: number) => (x * 3) / 23\n\nexport const createNumberedFileName = (filename: string) => {\n\tconst reg = /\\(([\\d]+)\\)$/\n\tconst match = filename.match(reg)\n\tif (!match) return `${filename} (2)`\n\treturn filename.replace(reg, `(${+match[1] + 1})`)\n}\n\nexport const fixedFormatRelative = (x: string) => {\n\tlet target = parseISO(x)\n\n\tlet diff = differenceInDays(new Date(), target)\n\n\tif (diff >= 6) {\n\t\treturn format(target, 'dd/MM/yyyy')\n\t} else {\n\t\treturn formatRelative(target, new Date())\n\t}\n}\n\nexport const getReservedDate = (d: Date) => {\n\treturn holidays.find((x) => isSameDay(x.date, d))?.name\n}\n\nexport const copyTabularData = async <T,>(schema: TableSchema<T>, items: T[]) => {\n\tconst rows: string[] = []\n\n\tconst cols = schema.cols.filter(isNotNone).filter(isVisible([undefined, 'all', 'copy-only']))\n\n\trows.push(cols.map((x) => onlyText(x.title)).join('\\t'))\n\n\titems.forEach((item) => {\n\t\trows.push(cols.map((x, i) => onlyText(!!x.copyValue ? x.copyValue(item, i) : x.value(item, i))).join('\\t'))\n\t})\n\n\t// it doesn't like clipboard-write as an option\n\t// @ts-ignore\n\tawait navigator.permissions.query({ name: 'clipboard-write' })\n\n\tnavigator.clipboard.writeText(rows.join('\\n'))\n}\n\nexport const ordinal = (i: number) => {\n\tvar j = i % 10,\n\t\tk = i % 100\n\tif (j === 1 && k !== 11) {\n\t\treturn i + 'st'\n\t}\n\tif (j === 2 && k !== 12) {\n\t\treturn i + 'nd'\n\t}\n\tif (j === 3 && k !== 13) {\n\t\treturn i + 'rd'\n\t}\n\treturn i + 'th'\n}\n\nexport const slugify = (name: string) => name.trim().replace(/\\s/g, '-').toLowerCase()\n","import { FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { smartReplaceClasses } from '@primer/utils/funcs'\n\ninterface IconProps {\n\tclassName?: ClassValue\n}\n\nconst fixClasses = (className = '') =>\n\tsmartReplaceClasses(className, [\n\t\t{ pattern: /^w-\\d+$/, defaultValue: 'w-5' },\n\t\t{ pattern: /^h-\\d+$/, defaultValue: 'h-5' },\n\t])\n\nexport const Spinner: FC<IconProps> = ({ className }) => (\n\t<svg className={fixClasses(clsx(className))} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n\t\t<path\n\t\t\tclassName=\"opacity-75\"\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FilePlus: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\tclassName={fixClasses(clsx(className))}\n\t\tfill=\"none\"\n\t\tstrokeLinecap=\"round\"\n\t\tstrokeLinejoin=\"round\"\n\t\tstrokeWidth=\"1\"\n\t\tstroke=\"currentColor\"\n\t\tviewBox=\"0 0 24 24\"\n\t>\n\t\t<path d=\"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n\t</svg>\n)\n\nexport const History: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\tclassName={fixClasses(clsx(className))}\n\t\tfill=\"currentColor\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 512 512\"\n\t>\n\t\t<g transform=\"scale(0.8)\" style={{ transformOrigin: 'center' }}>\n\t\t\t<path d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\" />\n\t\t</g>\n\t</svg>\n)\n\nexport const Undo: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 512 512\"\n\t>\n\t\t<g transform=\"scale(0.8)\" style={{ transformOrigin: 'center' }}>\n\t\t\t<path\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\td=\"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z\"\n\t\t\t/>\n\t\t</g>\n\t</svg>\n)\n\nexport const FilePdf: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileImage: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M384 121.941V128H256V0h6.059a24 24 0 0 1 16.97 7.029l97.941 97.941a24.002 24.002 0 0 1 7.03 16.971zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zm-135.455 16c26.51 0 48 21.49 48 48s-21.49 48-48 48-48-21.49-48-48 21.491-48 48-48zm208 240h-256l.485-48.485L104.545 328c4.686-4.686 11.799-4.201 16.485.485L160.545 368 264.06 264.485c4.686-4.686 12.284-4.686 16.971 0L320.545 304v112z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileWord: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm57.1 120H305c7.7 0 13.4 7.1 11.7 14.7l-38 168c-1.2 5.5-6.1 9.3-11.7 9.3h-38c-5.5 0-10.3-3.8-11.6-9.1-25.8-103.5-20.8-81.2-25.6-110.5h-.5c-1.1 14.3-2.4 17.4-25.6 110.5-1.3 5.3-6.1 9.1-11.6 9.1H117c-5.6 0-10.5-3.9-11.7-9.4l-37.8-168c-1.7-7.5 4-14.6 11.7-14.6h24.5c5.7 0 10.7 4 11.8 9.7 15.6 78 20.1 109.5 21 122.2 1.6-10.2 7.3-32.7 29.4-122.7 1.3-5.4 6.1-9.1 11.7-9.1h29.1c5.6 0 10.4 3.8 11.7 9.2 24 100.4 28.8 124 29.6 129.4-.2-11.2-2.6-17.8 21.6-129.2 1-5.6 5.9-9.5 11.5-9.5zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileText: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileArchive: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zM128.4 336c-17.9 0-32.4 12.1-32.4 27 0 15 14.6 27 32.5 27s32.4-12.1 32.4-27-14.6-27-32.5-27zM224 136V0h-63.6v32h-32V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM95.9 32h32v32h-32zm32.3 384c-33.2 0-58-30.4-51.4-62.9L96.4 256v-32h32v-32h-32v-32h32v-32h-32V96h32V64h32v32h-32v32h32v32h-32v32h32v32h-32v32h22.1c5.7 0 10.7 4.1 11.8 9.7l17.3 87.7c6.4 32.4-18.4 62.6-51.4 62.6z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileExcel: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\"\n\t\t/>\n\t</svg>\n)\n\nexport const File: FC<IconProps> = ({ className }) => (\n\t<svg\n\t\taria-hidden=\"true\"\n\t\tfocusable=\"false\"\n\t\tclassName={fixClasses(clsx(className))}\n\t\trole=\"img\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 600 600\"\n\t>\n\t\t<path\n\t\t\tfill=\"currentColor\"\n\t\t\td=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\"\n\t\t/>\n\t</svg>\n)\n\nexport const FileIcon: FC<IconProps & { type: string }> = ({ type, className }) =>\n\ttype === '.pdf' ? (\n\t\t<FilePdf className={className} />\n\t) : type === '.xlsx' ? (\n\t\t<FileExcel className={className} />\n\t) : type === '.docx' ? (\n\t\t<FileWord className={className} />\n\t) : type === '.jpg' || type === '.png' || type === '.gif' ? (\n\t\t<FileImage className={className} />\n\t) : type === '.zip' || type === '.7z' || type === '.rar' ? (\n\t\t<FileArchive className={className} />\n\t) : (\n\t\t<File className={className} />\n\t)\n","import { Spinner } from '@primer/components/Icon'\n\nconst Loader = ({ size = '3x', spin = true, className = '', ...props }) => {\n\treturn (\n\t\t<div className={`flex flex-col justify-center items-center p-2 ${className}`} {...props}>\n\t\t\t<Spinner className=\"w-10 h-10 animate-spin\" />\n\t\t</div>\n\t)\n}\nexport default Loader\n","import { useState } from 'react'\n\n// https://usehooks.com/useLocalStorage\n\nfunction useLocalStorage<T = any>(key: string, initialValue: T) {\n\tconst [storedValue, setStoredValue] = useState(() => {\n\t\ttry {\n\t\t\tconst item = window.localStorage.getItem(key)\n\t\t\treturn item ? JSON.parse(item) : initialValue\n\t\t} catch (error) {\n\t\t\treturn initialValue\n\t\t}\n\t})\n\n\tconst setValue = (value: T) => {\n\t\tconst valueToStore = value instanceof Function ? value(storedValue) : value\n\t\tsetStoredValue(valueToStore)\n\t\twindow.localStorage.setItem(key, JSON.stringify(valueToStore))\n\t}\n\n\treturn [storedValue, setValue]\n}\n\nexport default useLocalStorage\n","import { FC, ReactNode, useRef, useState } from 'react'\nimport { motion, AnimatePresence, MotionStyle } from 'framer-motion'\nimport clsx from 'clsx'\n\ninterface TooltipProps {\n\tmessage: ReactNode\n\tenabled?: boolean\n\tintent?: 'light' | 'dark'\n\tchildren: ReactNode\n}\n\nconst Tooltip: FC<TooltipProps> = ({ message, enabled = true, intent = 'light', children }) => {\n\tlet ref = useRef<HTMLDivElement>(null)\n\tconst [hover, setHover] = useState(false)\n\tconst [X, setX] = useState(0)\n\tconst [Y, setY] = useState(0)\n\n\tconst show = () => {\n\t\tif (!ref.current) return null\n\t\tif (!enabled) return null\n\n\t\tsetX(ref.current.offsetLeft + ref.current.offsetWidth)\n\t\tsetY(ref.current.offsetTop)\n\t\tsetHover(true)\n\t}\n\n\tconst hide = () => {\n\t\tsetHover(false)\n\t}\n\n\treturn (\n\t\t<div ref={ref} onMouseOver={show} onMouseOut={hide}>\n\t\t\t<div>{children}</div>\n\n\t\t\t<div\n\t\t\t\tclassName=\"flex items-center absolute z-10 ml-6 w-80 pointer-events-none\"\n\t\t\t\tstyle={{\n\t\t\t\t\tleft: `${X}px`,\n\t\t\t\t\ttop: `${Y}px`,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<AnimatePresence>\n\t\t\t\t\t{hover && (\n\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\tstyle={{ originX: 0 } as MotionStyle}\n\t\t\t\t\t\t\tvariants={{\n\t\t\t\t\t\t\t\thidden: { opacity: 0, x: -30 },\n\t\t\t\t\t\t\t\tvisible: { opacity: 1, x: 0 },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttransition={{\n\t\t\t\t\t\t\t\ttype: 'tween',\n\t\t\t\t\t\t\t\tease: 'easeOut',\n\t\t\t\t\t\t\t\tduration: 0.1,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tinitial=\"hidden\"\n\t\t\t\t\t\t\tanimate=\"visible\"\n\t\t\t\t\t\t\texit=\"hidden\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx('rounded px-3 py-2 text-sm font-medium shadow-lg', {\n\t\t\t\t\t\t\t\t\t'bg-white text-gray-900 dark:bg-primary-900 dark:text-white': intent === 'light',\n\t\t\t\t\t\t\t\t\t'bg-primary-900 text-white dark:bg-primary-200 dark:text-primary-900 antialiased':\n\t\t\t\t\t\t\t\t\t\tintent === 'dark',\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{message}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t)}\n\t\t\t\t</AnimatePresence>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Tooltip\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { Link, LinkGetProps, useLocation } from '@reach/router'\nimport useLocalStorage from '@primer/hooks/useLocalStorage'\nimport { RouteConfig, isLinkRouteConfig, isAnchorRouteConfig, isNotNone } from '@primer/types'\nimport { ExternalLinkIcon } from '@heroicons/react/outline'\nimport Tooltip from '@primer/components/Tooltip'\n\ntype IntentValue = 'primary' | 'secondary' | 'white'\n\nconst intents = {\n\tprimary: {\n\t\twrapper: 'bg-gray-800 dark:bg-gray-900 antialiased',\n\t\tlink: {\n\t\t\tactive: 'text-white bg-gradient-to-r from-primary-600 to-primary-500 text-white dark:bg-gray-700 focus:bg-gray-900 dark:focus:bg-gray-800',\n\t\t\tinactive:\n\t\t\t\t'text-gray-200 hover:text-white hover:bg-gray-700 focus:text-white focus:bg-gray-700 dark:hover:bg-gray-800',\n\t\t},\n\t},\n\tsecondary: {\n\t\twrapper: 'bg-white dark:bg-gray-700 antialiased shadow',\n\t\tlink: {\n\t\t\tactive: 'text-gray-900 dark:text-gray-100 bg-gray-50 dark:bg-gray-800 focus:bg-gray-200 dark:focus:bg-gray-800',\n\t\t\tinactive:\n\t\t\t\t'text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-gray-200 dark:hover:bg-gray-900 hover:bg-gray-100 focus:text-gray-900 focus:bg-gray-100',\n\t\t},\n\t},\n\twhite: {\n\t\twrapper: 'bg-white antialiased shadow',\n\t\tlink: {\n\t\t\tactive: 'text-gray-900 bg-gray-50 focus:bg-gray-200',\n\t\t\tinactive: 'text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:text-gray-900 focus:bg-gray-100',\n\t\t},\n\t},\n}\n\nconst getProps =\n\t(route: RouteConfig, min: boolean, intent: IntentValue) =>\n\t({ isCurrent, isPartiallyCurrent }: LinkGetProps) => {\n\t\treturn (route.exact ? isCurrent : isPartiallyCurrent)\n\t\t\t? {\n\t\t\t\t\tclassName: clsx(\n\t\t\t\t\t\t'group flex items-center py-2 px-2.5 text-sm font-medium leading-5 rounded focus:outline-none transition ease-in-out duration-150',\n\t\t\t\t\t\tmin && 'justify-center',\n\t\t\t\t\t\tintents[intent].link.active\n\t\t\t\t\t),\n\t\t\t  }\n\t\t\t: {\n\t\t\t\t\tclassName: clsx(\n\t\t\t\t\t\t'group flex items-center py-2 px-2.5 text-sm font-medium leading-5 rounded focus:outline-none transition ease-in-out duration-150',\n\t\t\t\t\t\tmin && 'justify-center',\n\t\t\t\t\t\tintents[intent].link.inactive\n\t\t\t\t\t),\n\t\t\t  }\n\t}\n\nconst MenuLink = ({\n\troute,\n\tmin,\n\tintent,\n\tchildren,\n}: {\n\troute: RouteConfig\n\tmin: boolean\n\tintent: IntentValue\n\tchildren: ReactNode\n}) => {\n\treturn isAnchorRouteConfig(route) ? (\n\t\t<a\n\t\t\thref={route.url}\n\t\t\tclassName={clsx(\n\t\t\t\t'group flex items-center justify-center py-2 px-2.5 text-sm leading-5 rounded focus:outline-none transition ease-in-out duration-150',\n\t\t\t\tintents[intent].link.inactive,\n\t\t\t\tmin && 'justify-center'\n\t\t\t)}\n\t\t\ttarget=\"_blank\"\n\t\t\trel=\"noopener noreferrer\"\n\t\t>\n\t\t\t<div className=\"flex items-center justify-center\">{children}</div>\n\t\t\t{!min && (\n\t\t\t\t<div className=\"flex-1 flex justify-end\">\n\t\t\t\t\t<ExternalLinkIcon className=\"opacity-25 w-4 h-4\" />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</a>\n\t) : isLinkRouteConfig(route) ? (\n\t\t<Link to={`${process.env.PUBLIC_URL}${route.to}`} getProps={getProps(route, min, intent)}>\n\t\t\t{children}\n\t\t</Link>\n\t) : null\n}\n\ninterface SidebarProps {\n\theader?: (min: boolean) => ReactNode\n\tfooter?: (min: boolean) => ReactNode\n\tlinks: RouteConfig[]\n\tintent: IntentValue\n\tname: string\n\tclassName?: ClassValue\n}\n\nconst Sidebar: FC<SidebarProps> = ({ header, footer, links, intent, name, className }) => {\n\tconst [min, setMin] = useLocalStorage(`sidebar-${name}-min`, false)\n\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx(\n\t\t\t\t'flex flex-col h-screen relative',\n\t\t\t\tmin ? 'w-16' : 'w-64',\n\t\t\t\tintents[intent].wrapper,\n\t\t\t\tclassName\n\t\t\t)}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={clsx('absolute right-0 top-0 h-full -mr-2 w-4 z-40 group', {\n\t\t\t\t\t'cursor-right': min,\n\t\t\t\t\t'cursor-left': !min,\n\t\t\t\t})}\n\t\t\t\tonClick={() => setMin((x: boolean) => !x)}\n\t\t\t>\n\t\t\t\t<div className=\"group-hover:opacity-100 opacity-0 transition-opacity ease-in-out duration-200 w-1 h-full ml-1.5 bg-primary-600\" />\n\t\t\t</div>\n\n\t\t\t<div className=\"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto overflow-x-visible\">\n\t\t\t\t{header && header(min)}\n\n\t\t\t\t<nav className=\"mt-5 flex-1 px-3 space-y-1\">\n\t\t\t\t\t{links.filter(isNotNone).map((link, i) => (\n\t\t\t\t\t\t<NavLink key={i} link={link} intent={intent} min={min} />\n\t\t\t\t\t))}\n\t\t\t\t</nav>\n\t\t\t</div>\n\n\t\t\t{footer && footer(min)}\n\t\t</div>\n\t)\n}\n\ninterface NavLinkProps {\n\tlink: RouteConfig\n\tmin: boolean\n\tintent: IntentValue\n}\n\nconst NavLink: FC<NavLinkProps> = ({ link, min, intent }) => {\n\tconst loc = useLocation()\n\n\tconst matches = isLinkRouteConfig(link) ? loc.pathname.indexOf(link.to) === 0 : false\n\n\treturn (\n\t\t<div>\n\t\t\t{link && (\n\t\t\t\t<Tooltip message={link.tooltip || link.title} enabled={min}>\n\t\t\t\t\t<MenuLink route={link} min={min} intent={intent}>\n\t\t\t\t\t\t<div className={clsx('opacity-75 pointer-events-none', min ? 'mr-0' : 'mr-3')}>{link.icon}</div>\n\t\t\t\t\t\t{!min && link.title}\n\t\t\t\t\t</MenuLink>\n\t\t\t\t</Tooltip>\n\t\t\t)}\n\t\t\t{matches && link.children && link.children.length > 0 && (\n\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t<div className=\"p-1 rounded-md space-y-1 border-2 border-gray-700\">\n\t\t\t\t\t\t{link.children\n\t\t\t\t\t\t\t.filter((x) => x)\n\t\t\t\t\t\t\t.map((link, i) => (\n\t\t\t\t\t\t\t\t<NavLink key={i} link={link} intent={intent} min={min} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport default Sidebar\n","export default __webpack_public_path__ + \"static/media/logo-text.7e31daaa.svg\";","import { useEffect, useState } from 'react'\n\ntype MediaChange = (this: MediaQueryList, ev: MediaQueryListEvent) => any\n\nconst changeDarkMode = (x: boolean) => document.querySelector('html')?.classList[x ? 'add' : 'remove']('dark')\n\nconst useDarkMode = (): [boolean | null, (x: boolean | null) => void] => {\n\t// const [value, setDarkMode] = useStore((store) => [store.darkMode, store.setDarkMode])\n\tconst [value, setDarkMode] = useState<boolean | null>(false)\n\tconst matchesMedia = window.matchMedia('(prefers-color-scheme: dark)')\n\n\tuseEffect(() => {\n\t\tif (value !== null) {\n\t\t\tchangeDarkMode(value)\n\t\t} else {\n\t\t\tconst func: MediaChange = (e) => changeDarkMode(e.matches)\n\t\t\tchangeDarkMode(matchesMedia.matches)\n\n\t\t\tif (matchesMedia.hasOwnProperty('addEventListener')) {\n\t\t\t\tmatchesMedia.addEventListener('change', func)\n\t\t\t\treturn () => matchesMedia.removeEventListener('change', func)\n\t\t\t}\n\t\t}\n\t}, [value, matchesMedia])\n\n\treturn [value, setDarkMode]\n}\n\nexport default useDarkMode\n","import { FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { ChevronDownIcon, CheckIcon, ChevronLeftIcon, LogoutIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport useDarkMode from '@primer/hooks/useDarkMode'\n// import { useLocation } from '@reach/router'\n\ninterface TopbarProps {\n\tintent?: 'light' | 'dark'\n\tclassName?: ClassValue\n}\n\nconst Topbar: FC<TopbarProps> = ({ intent = 'light', className }) => {\n\tconst profile = {}\n\n\tconst logout = async () => {\n\t\t// store.getState().logout()\n\t}\n\n\tconst [darkMode, setDarkMode] = useDarkMode()\n\n\t// const location = useLocation()\n\t// const state = location?.state as { term?: string } | null\n\t// const [search, setSearch] = useState(state?.term || '')\n\t// const timer = useRef<NodeJS.Timeout | undefined>()\n\n\t// useEffect(() => {\n\t// \tsetSearch(state?.term || '')\n\t// }, [state?.term])\n\n\treturn (\n\t\t<div className={clsx('max-w-7xl mx-auto py-3 px-4 sm:px-6 lg:px-8 flex items-center justify-end', className)}>\n\t\t\t{profile && (\n\t\t\t\t<div className=\"flex items-center space-x-2\">\n\t\t\t\t\t<Actions\n\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: (\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-4\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t'text-sm font-medium',\n\t\t\t\t\t\t\t\t\t\t\t\tintent === 'dark' && 'text-gray-200 antialiased'\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tYour Name\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\ticon: (\n\t\t\t\t\t\t\t\t\t<ChevronDownIcon\n\t\t\t\t\t\t\t\t\t\tclassName={clsx('w-5 h-5 opacity-75', intent === 'dark' && 'text-white')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\ticonSide: 'right',\n\t\t\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\t\t\tplacement: 'bottom-end',\n\t\t\t\t\t\t\t\tsize: 'xs',\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Colour Scheme',\n\t\t\t\t\t\t\t\t\t\t\ticon: <ChevronLeftIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\tplacement: 'left-start',\n\t\t\t\t\t\t\t\t\t\t\thoverable: true,\n\t\t\t\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Dark Mode',\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'w-4 h-4',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdarkMode === true ? 'opacity-100' : 'opacity-0'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => setDarkMode(true),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Light Mode',\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'w-4 h-4',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdarkMode === false ? 'opacity-100' : 'opacity-0'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => setDarkMode(false),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'System Preference',\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'w-4 h-4',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdarkMode === null ? 'opacity-100' : 'opacity-0'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => setDarkMode(null),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t// {\n\t\t\t\t\t\t\t\t\t\t// \ttitle: 'Manage Devices',\n\t\t\t\t\t\t\t\t\t\t// \ticon: <DeviceMobileIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\t\t\t// \ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t// \tto: '/devices',\n\t\t\t\t\t\t\t\t\t\t// },\n\t\t\t\t\t\t\t\t\t],\n\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Logout',\n\t\t\t\t\t\t\t\t\t\t\ticon: <LogoutIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\tonClick: logout,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport default Topbar\n","import { FC, useState } from 'react'\nimport clsx from 'clsx'\nimport { Link } from '@reach/router'\nimport logo from 'assets/img/logo-text.svg'\nimport { RouteConfig, isLinkRouteConfig, isAnchorRouteConfig, isNotNone } from '@primer/types'\nimport AutoHeight from '@primer/components/AutoHeight'\nimport Topbar from '@primer/components/Topbar'\n\ninterface MobileMenuProps {\n\tlinks: RouteConfig[]\n\twithTopbar?: boolean\n}\n\nconst MobileMenu: FC<MobileMenuProps> = ({ links, withTopbar = false }) => {\n\tconst [open, setOpen] = useState(false)\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"md:hidden bg-gray-800 dark:bg-gray-900 flex justify-between p-4\">\n\t\t\t\t<Link to=\"/dashboard\">\n\t\t\t\t\t<img src={logo} alt=\"ICRA\" className=\"h-10\" />\n\t\t\t\t</Link>\n\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:bg-gray-700 focus:text-white\"\n\t\t\t\t\tonClick={() => setOpen((x) => !x)}\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\tclassName={clsx('h-6 w-6', { block: !open, hidden: open })}\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\t\td=\"M4 6h16M4 12h16M4 18h16\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\n\t\t\t\t\t<svg\n\t\t\t\t\t\tclassName={clsx('h-6 w-6', { block: open, hidden: !open })}\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div className={clsx('md:hidden bg-gray-800 dark:bg-gray-900 antialiased')}>\n\t\t\t\t<AutoHeight show={open}>\n\t\t\t\t\t<div className=\"px-2 pt-2 pb-3 sm:px-3\">\n\t\t\t\t\t\t{links.filter(isNotNone).map((link, i) =>\n\t\t\t\t\t\t\tisLinkRouteConfig(link) ? (\n\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tto={link.to}\n\t\t\t\t\t\t\t\t\tgetProps={({ isCurrent }) => ({\n\t\t\t\t\t\t\t\t\t\tclassName: clsx({\n\t\t\t\t\t\t\t\t\t\t\t'flex items-center px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700':\n\t\t\t\t\t\t\t\t\t\t\t\t!isCurrent,\n\t\t\t\t\t\t\t\t\t\t\t'flex items-center px-3 py-2 rounded-md text-base font-medium text-white bg-gray-900 focus:outline-none focus:text-white focus:bg-gray-700':\n\t\t\t\t\t\t\t\t\t\t\t\tisCurrent,\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\tonClick={() => setOpen(false)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"mr-3\">{link.icon}</div>\n\t\t\t\t\t\t\t\t\t{link.title}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t) : isAnchorRouteConfig(link) ? (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\thref={link.url}\n\t\t\t\t\t\t\t\t\tclassName=\"flex items-center px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"mr-3\">{link.icon}</div>\n\t\t\t\t\t\t\t\t\t{link.title}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{withTopbar && <Topbar intent=\"dark\" />}\n\t\t\t\t\t</div>\n\t\t\t\t</AutoHeight>\n\t\t\t</div>\n\t\t</>\n\t)\n}\n\nexport default MobileMenu\n","import { FC, Component } from 'react'\nimport { Location, WindowLocation } from '@reach/router'\n\ninterface OnRouteChangeProps {\n\taction: () => void\n}\n\nconst OnRouteChange: FC<OnRouteChangeProps> = ({ action }) => (\n\t<Location>\n\t\t{({ location }: { location: WindowLocation }) => <OnRouteChangeWorker location={location} action={action} />}\n\t</Location>\n)\n\ninterface OnRouteChangeWorkerProps {\n\tlocation: WindowLocation\n\taction: () => void\n}\n\nclass OnRouteChangeWorker extends Component<OnRouteChangeWorkerProps, {}> {\n\tcomponentDidUpdate(prevProps: OnRouteChangeWorkerProps) {\n\t\tif (this.props.location.pathname !== prevProps.location.pathname) {\n\t\t\tthis.props.action()\n\t\t}\n\t}\n\n\trender() {\n\t\treturn null\n\t}\n}\n\nexport default OnRouteChange\n","interface Version {\n\tnumber: string\n\tdate: string\n\tnew: string[]\n\tchange: string[]\n\tbug: string[]\n}\n\nconst versions: Version[] = [\n\t{\n\t\tnumber: '0.0.0',\n\t\tdate: '2021-07-29',\n\t\tnew: ['Everything is new'],\n\t\tchange: [],\n\t\tbug: []\n\t},\n\t\n]\n\nexport default versions\n","import clsx, { ClassValue } from 'clsx'\nimport { FC } from 'react'\n\ninterface LogoProps {\n\tclassName?: ClassValue\n}\n\nexport const LogoWithText: FC<LogoProps> = ({ className = '' }) => (\n\t<svg className={clsx(className)} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 170 32\">\n\t\t<path\n\t\t\td=\"M15.258 26.865C15.2725 27.4021 15.1797 27.9367 14.9852 28.4376C14.7906 28.9384 14.4982 29.3955 14.125 29.782C13.7521 30.1668 13.3058 30.4728 12.8124 30.682C12.3191 30.8913 11.7889 30.9994 11.253 31C10.7171 31.0002 10.1865 30.8924 9.69311 30.6832C9.19969 30.4739 8.75345 30.1674 8.38102 29.782C8.00712 29.396 7.71425 28.939 7.51967 28.438C7.32508 27.9371 7.23272 27.4022 7.24802 26.865C7.25702 26.167 7.44802 25.483 7.80502 24.884C8.16102 24.284 8.66802 23.79 9.27502 23.451C9.25102 23.56 9.36502 23.396 9.27502 23.451L11.135 21.799C12.6094 20.2298 13.4329 18.1592 13.439 16.006C13.439 13.08 11.728 10.105 9.26902 8.549C9.36302 8.604 9.23302 8.455 9.26902 8.549C8.66171 8.20902 8.15496 7.71469 7.80002 7.116C7.44385 6.5163 7.25175 5.83344 7.24302 5.136C7.22837 4.59872 7.32104 4.06391 7.51558 3.56287C7.71012 3.06183 8.00264 2.60462 8.37602 2.218C8.74882 1.83334 9.19499 1.52735 9.68812 1.31815C10.1813 1.10894 10.7113 1.00076 11.247 1C11.783 0.999714 12.3135 1.10742 12.807 1.31668C13.3004 1.52595 13.7467 1.83249 14.119 2.218C14.4931 2.60395 14.786 3.06089 14.9806 3.56188C15.1752 4.06288 15.2675 4.59777 15.252 5.135C15.2624 7.30708 16.102 9.3932 17.599 10.967L18.416 11.767C18.742 12.052 19.084 12.318 19.44 12.565C20.061 12.895 20.582 13.391 20.944 13.996C21.215 14.4489 21.3913 14.9521 21.4622 15.4751C21.5331 15.9982 21.4972 16.5301 21.3566 17.0389C21.216 17.5476 20.9737 18.0225 20.6442 18.4349C20.3148 18.8473 19.9051 19.1885 19.44 19.438C19.473 19.371 19.377 19.474 19.44 19.438C18.1839 20.2321 17.1447 21.3258 16.416 22.621C15.6855 23.9184 15.2877 25.3764 15.258 26.865V26.865ZM19.741 5.123C19.741 5.919 19.976 6.698 20.417 7.36C20.8565 8.02107 21.4822 8.53685 22.215 8.842C22.9471 9.14685 23.7535 9.22661 24.5311 9.07112C25.3088 8.91563 26.0224 8.53193 26.581 7.969C27.1413 7.40452 27.5226 6.68728 27.6772 5.9071C27.8318 5.12692 27.7528 4.31848 27.45 3.583C27.1473 2.84836 26.6337 2.2199 25.974 1.777C25.2039 1.26028 24.2779 1.02768 23.355 1.11909C22.4321 1.2105 21.5698 1.62024 20.916 2.278C20.1641 3.034 19.7417 4.05673 19.741 5.123V5.123ZM23.748 22.84C22.956 22.84 22.181 23.076 21.522 23.518C20.8624 23.9609 20.3488 24.5894 20.046 25.324C19.7431 26.0596 19.6639 26.8683 19.8185 27.6486C19.9731 28.429 20.3545 29.1464 20.915 29.711C21.4736 30.2739 22.1873 30.6576 22.9649 30.8131C23.7426 30.9686 24.5489 30.8888 25.281 30.584C26.0145 30.2785 26.6406 29.762 27.08 29.1C27.5948 28.3249 27.8262 27.3959 27.7351 26.47C27.644 25.544 27.236 24.6779 26.58 24.018C26.2089 23.6446 25.7676 23.3482 25.2816 23.1457C24.7957 22.9432 24.2745 22.8386 23.748 22.838V22.84ZM34 15.994C34 15.198 33.765 14.42 33.325 13.758C32.8857 13.0966 32.26 12.5804 31.527 12.275C30.7948 11.9699 29.9882 11.8901 29.2104 12.0456C28.4325 12.2011 27.7187 12.5849 27.16 13.148C26.5995 13.7126 26.2181 14.43 26.0635 15.2104C25.9089 15.9907 25.9881 16.7994 26.291 17.535C26.5937 18.2696 27.1073 18.8981 27.767 19.341C28.4252 19.783 29.2002 20.019 29.993 20.019C30.5195 20.0182 31.0406 19.9136 31.5266 19.7111C32.0125 19.5086 32.4538 19.2123 32.825 18.839C33.577 18.0826 33.9994 17.0596 34 15.993V15.994Z\"\n\t\t\tfill=\"currentColor\"\n\t\t/>\n\t\t<path\n\t\t\td=\"M5.00699 11.969C4.21399 11.969 3.43999 12.205 2.78099 12.647C2.12121 13.0902 1.60759 13.719 1.30499 14.454C1.00226 15.1895 0.923231 15.9979 1.07781 16.7781C1.23239 17.5583 1.6137 18.2755 2.17399 18.84C2.73339 19.4017 3.44702 19.7845 4.22434 19.9399C5.00166 20.0953 5.80763 20.0164 6.53999 19.713C7.2729 19.4075 7.89866 18.8914 8.338 18.23C8.85242 17.4552 9.08361 16.5265 8.99251 15.601C8.90141 14.6754 8.49361 13.8097 7.83799 13.15C7.4669 12.7767 7.02585 12.4803 6.54007 12.2776C6.0543 12.075 5.53334 11.9701 5.00699 11.969V11.969Z\"\n\t\t\tfill=\"currentColor\"\n\t\t/>\n\t\t<path\n\t\t\td=\"M51.14 23L48.658 18.495H47.961V23H45.054V11.066H49.933C50.8737 11.066 51.6727 11.2303 52.33 11.559C52.9987 11.8877 53.4973 12.341 53.826 12.919C54.1547 13.4857 54.319 14.1203 54.319 14.823C54.319 15.6163 54.0923 16.3247 53.639 16.948C53.197 17.5713 52.5397 18.0133 51.667 18.274L54.421 23H51.14ZM47.961 16.438H49.763C50.2957 16.438 50.6923 16.3077 50.953 16.047C51.225 15.7863 51.361 15.418 51.361 14.942C51.361 14.4887 51.225 14.1317 50.953 13.871C50.6923 13.6103 50.2957 13.48 49.763 13.48H47.961V16.438ZM65.0858 18.104C65.0858 18.376 65.0688 18.6593 65.0348 18.954H58.4558C58.5012 19.5433 58.6882 19.9967 59.0168 20.314C59.3568 20.62 59.7705 20.773 60.2578 20.773C60.9832 20.773 61.4875 20.467 61.7708 19.855H64.8648C64.7062 20.4783 64.4172 21.0393 63.9978 21.538C63.5898 22.0367 63.0742 22.4277 62.4508 22.711C61.8275 22.9943 61.1305 23.136 60.3598 23.136C59.4305 23.136 58.6032 22.9377 57.8778 22.541C57.1525 22.1443 56.5858 21.5777 56.1778 20.841C55.7698 20.1043 55.5658 19.243 55.5658 18.257C55.5658 17.271 55.7642 16.4097 56.1608 15.673C56.5688 14.9363 57.1355 14.3697 57.8608 13.973C58.5862 13.5763 59.4192 13.378 60.3598 13.378C61.2778 13.378 62.0938 13.5707 62.8078 13.956C63.5218 14.3413 64.0772 14.891 64.4738 15.605C64.8818 16.319 65.0858 17.152 65.0858 18.104ZM62.1108 17.339C62.1108 16.8403 61.9408 16.4437 61.6008 16.149C61.2608 15.8543 60.8358 15.707 60.3258 15.707C59.8385 15.707 59.4248 15.8487 59.0848 16.132C58.7562 16.4153 58.5522 16.8177 58.4728 17.339H62.1108ZM70.4784 23.136C69.6511 23.136 68.9144 22.9943 68.2684 22.711C67.6224 22.4277 67.1124 22.0423 66.7384 21.555C66.3644 21.0563 66.1548 20.501 66.1094 19.889H68.9824C69.0164 20.2177 69.1694 20.484 69.4414 20.688C69.7134 20.892 70.0478 20.994 70.4444 20.994C70.8071 20.994 71.0848 20.926 71.2774 20.79C71.4814 20.6427 71.5834 20.4557 71.5834 20.229C71.5834 19.957 71.4418 19.7587 71.1584 19.634C70.8751 19.498 70.4161 19.3507 69.7814 19.192C69.1014 19.0333 68.5348 18.869 68.0814 18.699C67.6281 18.5177 67.2371 18.24 66.9084 17.866C66.5798 17.4807 66.4154 16.965 66.4154 16.319C66.4154 15.775 66.5628 15.282 66.8574 14.84C67.1634 14.3867 67.6054 14.0297 68.1834 13.769C68.7728 13.5083 69.4698 13.378 70.2744 13.378C71.4644 13.378 72.3994 13.6727 73.0794 14.262C73.7708 14.8513 74.1674 15.6333 74.2694 16.608H71.5834C71.5381 16.2793 71.3908 16.0187 71.1414 15.826C70.9034 15.6333 70.5861 15.537 70.1894 15.537C69.8494 15.537 69.5888 15.605 69.4074 15.741C69.2261 15.8657 69.1354 16.0413 69.1354 16.268C69.1354 16.54 69.2771 16.744 69.5604 16.88C69.8551 17.016 70.3084 17.152 70.9204 17.288C71.6231 17.4693 72.1954 17.6507 72.6374 17.832C73.0794 18.002 73.4648 18.2853 73.7934 18.682C74.1334 19.0673 74.3091 19.5887 74.3204 20.246C74.3204 20.8013 74.1618 21.3 73.8444 21.742C73.5384 22.1727 73.0908 22.5127 72.5014 22.762C71.9234 23.0113 71.2491 23.136 70.4784 23.136ZM80.4169 23.136C79.4876 23.136 78.6489 22.9377 77.9009 22.541C77.1643 22.1443 76.5806 21.5777 76.1499 20.841C75.7306 20.1043 75.5209 19.243 75.5209 18.257C75.5209 17.2823 75.7363 16.4267 76.1669 15.69C76.5976 14.942 77.1869 14.3697 77.9349 13.973C78.6829 13.5763 79.5216 13.378 80.4509 13.378C81.3803 13.378 82.2189 13.5763 82.9669 13.973C83.7149 14.3697 84.3043 14.942 84.7349 15.69C85.1656 16.4267 85.3809 17.2823 85.3809 18.257C85.3809 19.2317 85.1599 20.093 84.7179 20.841C84.2873 21.5777 83.6923 22.1443 82.9329 22.541C82.1849 22.9377 81.3463 23.136 80.4169 23.136ZM80.4169 20.62C80.9723 20.62 81.4426 20.416 81.8279 20.008C82.2246 19.6 82.4229 19.0163 82.4229 18.257C82.4229 17.4977 82.2303 16.914 81.8449 16.506C81.4709 16.098 81.0063 15.894 80.4509 15.894C79.8843 15.894 79.4139 16.098 79.0399 16.506C78.6659 16.9027 78.4789 17.4863 78.4789 18.257C78.4789 19.0163 78.6603 19.6 79.0229 20.008C79.3969 20.416 79.8616 20.62 80.4169 20.62ZM89.8301 10.42V23H86.9231V10.42H89.8301ZM101.304 13.514V23H98.3968V21.708C98.1021 22.1273 97.6998 22.4673 97.1898 22.728C96.6911 22.9773 96.1358 23.102 95.5238 23.102C94.7985 23.102 94.1581 22.9433 93.6028 22.626C93.0475 22.2973 92.6168 21.827 92.3108 21.215C92.0048 20.603 91.8518 19.8833 91.8518 19.056V13.514H94.7418V18.665C94.7418 19.2997 94.9061 19.7927 95.2348 20.144C95.5635 20.4953 96.0055 20.671 96.5608 20.671C97.1275 20.671 97.5751 20.4953 97.9038 20.144C98.2325 19.7927 98.3968 19.2997 98.3968 18.665V13.514H101.304ZM108.679 20.535V23H107.2C106.146 23 105.324 22.745 104.735 22.235C104.146 21.7137 103.851 20.8693 103.851 19.702V15.928H102.695V13.514H103.851V11.202H106.758V13.514H108.662V15.928H106.758V19.736C106.758 20.0193 106.826 20.2233 106.962 20.348C107.098 20.4727 107.325 20.535 107.642 20.535H108.679ZM111.76 12.528C111.25 12.528 110.831 12.3807 110.502 12.086C110.185 11.78 110.026 11.406 110.026 10.964C110.026 10.5107 110.185 10.1367 110.502 9.842C110.831 9.536 111.25 9.383 111.76 9.383C112.259 9.383 112.667 9.536 112.984 9.842C113.313 10.1367 113.477 10.5107 113.477 10.964C113.477 11.406 113.313 11.78 112.984 12.086C112.667 12.3807 112.259 12.528 111.76 12.528ZM113.205 13.514V23H110.298V13.514H113.205ZM119.63 23.136C118.7 23.136 117.862 22.9377 117.114 22.541C116.377 22.1443 115.793 21.5777 115.363 20.841C114.943 20.1043 114.734 19.243 114.734 18.257C114.734 17.2823 114.949 16.4267 115.38 15.69C115.81 14.942 116.4 14.3697 117.148 13.973C117.896 13.5763 118.734 13.378 119.664 13.378C120.593 13.378 121.432 13.5763 122.18 13.973C122.928 14.3697 123.517 14.942 123.948 15.69C124.378 16.4267 124.594 17.2823 124.594 18.257C124.594 19.2317 124.373 20.093 123.931 20.841C123.5 21.5777 122.905 22.1443 122.146 22.541C121.398 22.9377 120.559 23.136 119.63 23.136ZM119.63 20.62C120.185 20.62 120.655 20.416 121.041 20.008C121.437 19.6 121.636 19.0163 121.636 18.257C121.636 17.4977 121.443 16.914 121.058 16.506C120.684 16.098 120.219 15.894 119.664 15.894C119.097 15.894 118.627 16.098 118.253 16.506C117.879 16.9027 117.692 17.4863 117.692 18.257C117.692 19.0163 117.873 19.6 118.236 20.008C118.61 20.416 119.074 20.62 119.63 20.62ZM131.916 13.412C133.027 13.412 133.911 13.7747 134.568 14.5C135.237 15.214 135.571 16.2 135.571 17.458V23H132.681V17.849C132.681 17.2143 132.517 16.7213 132.188 16.37C131.859 16.0187 131.417 15.843 130.862 15.843C130.307 15.843 129.865 16.0187 129.536 16.37C129.207 16.7213 129.043 17.2143 129.043 17.849V23H126.136V13.514H129.043V14.772C129.338 14.3527 129.734 14.024 130.233 13.786C130.732 13.5367 131.293 13.412 131.916 13.412ZM137.013 18.24C137.013 17.2653 137.194 16.4097 137.557 15.673C137.931 14.9363 138.435 14.3697 139.07 13.973C139.705 13.5763 140.413 13.378 141.195 13.378C141.864 13.378 142.447 13.514 142.946 13.786C143.456 14.058 143.847 14.415 144.119 14.857V13.514H147.026V23H144.119V21.657C143.836 22.099 143.439 22.456 142.929 22.728C142.43 23 141.847 23.136 141.178 23.136C140.407 23.136 139.705 22.9377 139.07 22.541C138.435 22.133 137.931 21.5607 137.557 20.824C137.194 20.076 137.013 19.2147 137.013 18.24ZM144.119 18.257C144.119 17.5317 143.915 16.9593 143.507 16.54C143.11 16.1207 142.623 15.911 142.045 15.911C141.467 15.911 140.974 16.1207 140.566 16.54C140.169 16.948 139.971 17.5147 139.971 18.24C139.971 18.9653 140.169 19.5433 140.566 19.974C140.974 20.3933 141.467 20.603 142.045 20.603C142.623 20.603 143.11 20.3933 143.507 19.974C143.915 19.5547 144.119 18.9823 144.119 18.257ZM152.036 15.095C152.376 14.5737 152.801 14.1657 153.311 13.871C153.821 13.565 154.388 13.412 155.011 13.412V16.489H154.212C153.487 16.489 152.943 16.6477 152.58 16.965C152.218 17.271 152.036 17.815 152.036 18.597V23H149.129V13.514H152.036V15.095ZM166.091 13.514L160.141 27.505H157.013L159.189 22.677L155.33 13.514H158.577L160.77 19.447L162.946 13.514H166.091Z\"\n\t\t\tfill=\"white\"\n\t\t/>\n\t</svg>\n)\n\nexport const Logo: FC<LogoProps> = ({ className = '' }) => (\n\t<svg className={clsx(className)} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 35 32\">\n\t\t<path\n\t\t\td=\"M15.258 26.865C15.2725 27.4021 15.1797 27.9367 14.9852 28.4376C14.7906 28.9384 14.4982 29.3955 14.125 29.782C13.7521 30.1668 13.3058 30.4728 12.8124 30.682C12.3191 30.8913 11.7889 30.9994 11.253 31C10.7171 31.0002 10.1865 30.8924 9.69311 30.6832C9.19969 30.4739 8.75345 30.1674 8.38102 29.782C8.00712 29.396 7.71425 28.939 7.51967 28.438C7.32508 27.9371 7.23272 27.4022 7.24802 26.865C7.25702 26.167 7.44802 25.483 7.80502 24.884C8.16102 24.284 8.66802 23.79 9.27502 23.451C9.25102 23.56 9.36502 23.396 9.27502 23.451L11.135 21.799C12.6094 20.2298 13.4329 18.1592 13.439 16.006C13.439 13.08 11.728 10.105 9.26902 8.549C9.36302 8.604 9.23302 8.455 9.26902 8.549C8.66171 8.20902 8.15496 7.71469 7.80002 7.116C7.44385 6.5163 7.25175 5.83344 7.24302 5.136C7.22837 4.59872 7.32104 4.06391 7.51558 3.56287C7.71012 3.06183 8.00264 2.60462 8.37602 2.218C8.74882 1.83334 9.19499 1.52735 9.68812 1.31815C10.1813 1.10894 10.7113 1.00076 11.247 1C11.783 0.999714 12.3135 1.10742 12.807 1.31668C13.3004 1.52595 13.7467 1.83249 14.119 2.218C14.4931 2.60395 14.786 3.06089 14.9806 3.56188C15.1752 4.06288 15.2675 4.59777 15.252 5.135C15.2624 7.30708 16.102 9.3932 17.599 10.967L18.416 11.767C18.742 12.052 19.084 12.318 19.44 12.565C20.061 12.895 20.582 13.391 20.944 13.996C21.215 14.4489 21.3913 14.9521 21.4622 15.4751C21.5331 15.9982 21.4972 16.5301 21.3566 17.0389C21.216 17.5476 20.9737 18.0225 20.6442 18.4349C20.3148 18.8473 19.9051 19.1885 19.44 19.438C19.473 19.371 19.377 19.474 19.44 19.438C18.1839 20.2321 17.1447 21.3258 16.416 22.621C15.6855 23.9184 15.2877 25.3764 15.258 26.865V26.865ZM19.741 5.123C19.741 5.919 19.976 6.698 20.417 7.36C20.8565 8.02107 21.4822 8.53685 22.215 8.842C22.9471 9.14685 23.7535 9.22661 24.5311 9.07112C25.3088 8.91563 26.0224 8.53193 26.581 7.969C27.1413 7.40452 27.5226 6.68728 27.6772 5.9071C27.8318 5.12692 27.7528 4.31848 27.45 3.583C27.1473 2.84836 26.6337 2.2199 25.974 1.777C25.2039 1.26028 24.2779 1.02768 23.355 1.11909C22.4321 1.2105 21.5698 1.62024 20.916 2.278C20.1641 3.034 19.7417 4.05673 19.741 5.123V5.123ZM23.748 22.84C22.956 22.84 22.181 23.076 21.522 23.518C20.8624 23.9609 20.3488 24.5894 20.046 25.324C19.7431 26.0596 19.6639 26.8683 19.8185 27.6486C19.9731 28.429 20.3545 29.1464 20.915 29.711C21.4736 30.2739 22.1873 30.6576 22.9649 30.8131C23.7426 30.9686 24.5489 30.8888 25.281 30.584C26.0145 30.2785 26.6406 29.762 27.08 29.1C27.5948 28.3249 27.8262 27.3959 27.7351 26.47C27.644 25.544 27.236 24.6779 26.58 24.018C26.2089 23.6446 25.7676 23.3482 25.2816 23.1457C24.7957 22.9432 24.2745 22.8386 23.748 22.838V22.84ZM34 15.994C34 15.198 33.765 14.42 33.325 13.758C32.8857 13.0966 32.26 12.5804 31.527 12.275C30.7948 11.9699 29.9882 11.8901 29.2104 12.0456C28.4325 12.2011 27.7187 12.5849 27.16 13.148C26.5995 13.7126 26.2181 14.43 26.0635 15.2104C25.9089 15.9907 25.9881 16.7994 26.291 17.535C26.5937 18.2696 27.1073 18.8981 27.767 19.341C28.4252 19.783 29.2002 20.019 29.993 20.019C30.5195 20.0182 31.0406 19.9136 31.5266 19.7111C32.0125 19.5086 32.4538 19.2123 32.825 18.839C33.577 18.0826 33.9994 17.0596 34 15.993V15.994Z\"\n\t\t\tfill=\"currentColor\"\n\t\t/>\n\t\t<path\n\t\t\td=\"M5.00699 11.969C4.21399 11.969 3.43999 12.205 2.78099 12.647C2.12121 13.0902 1.60759 13.719 1.30499 14.454C1.00226 15.1895 0.923231 15.9979 1.07781 16.7781C1.23239 17.5583 1.6137 18.2755 2.17399 18.84C2.73339 19.4017 3.44702 19.7845 4.22434 19.9399C5.00166 20.0953 5.80763 20.0164 6.53999 19.713C7.2729 19.4075 7.89866 18.8914 8.338 18.23C8.85242 17.4552 9.08361 16.5265 8.99251 15.601C8.90141 14.6754 8.49361 13.8097 7.83799 13.15C7.4669 12.7767 7.02585 12.4803 6.54007 12.2776C6.0543 12.075 5.53334 11.9701 5.00699 11.969V11.969Z\"\n\t\t\tfill=\"currentColor\"\n\t\t/>\n\t</svg>\n)\n","import { FC, Suspense, useMemo, useRef } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { RouteComponentProps, Link } from '@reach/router'\nimport Loader from '@primer/components/Loader'\nimport Sidebar from '@primer/components/Sidebar'\nimport MobileMenu from '@primer/components/MobileMenu'\nimport { CogIcon, QuestionMarkCircleIcon, ViewGridIcon } from '@heroicons/react/outline'\nimport Topbar from '@primer/components/Topbar'\nimport OnRouteChange from '@primer/components/OnRouteChange'\nimport versions from '@primer/utils/versions'\nimport semver from 'semver'\nimport { site } from 'config'\nimport db from 'db'\nimport { Logo as SmallLogo, LogoWithText } from 'components/Logo'\n\nconst Logo: FC<{ min: boolean; className: ClassValue }> = ({ min, className }) =>\n\tmin ? <SmallLogo className={className} /> : <LogoWithText className={className} />\n\nconst PageSidebar: FC<RouteComponentProps> = ({ children }) => {\n\tconst releases = versions.sort((a, b) => (semver.gt(a.number, b.number) ? -1 : 1))\n\n\tconst ref = useRef<HTMLDivElement>(null)\n\n\tconst entities = db.entities.all()\n\n\tconst links = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ttitle: 'Home',\n\t\t\t\tto: '/home',\n\t\t\t\ticon: <ViewGridIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: true,\n\t\t\t},\n\t\t\t...entities.map((entity) => ({\n\t\t\t\ttitle: entity.plural || entity.name,\n\t\t\t\tto: `/${entity.key}`,\n\t\t\t\ticon: <QuestionMarkCircleIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: true,\n\t\t\t})),\n\t\t\t{\n\t\t\t\ttitle: 'Settings',\n\t\t\t\tto: '/settings',\n\t\t\t\ticon: <CogIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: false,\n\t\t\t},\n\t\t],\n\t\t[entities]\n\t)\n\n\treturn (\n\t\t<div className=\"h-screen flex flex-col md:flex-row md:overflow-hidden bg-gray-200 dark:bg-gray-800\">\n\t\t\t<MobileMenu links={links} />\n\t\t\t<Sidebar\n\t\t\t\tname=\"main\"\n\t\t\t\tintent=\"primary\"\n\t\t\t\tlinks={links}\n\t\t\t\tclassName=\"hidden md:flex\"\n\t\t\t\theader={(min) => (\n\t\t\t\t\t<div className=\"px-2 my-5\">\n\t\t\t\t\t\t<Link to={`${process.env.PUBLIC_URL}/dashboard`}>\n\t\t\t\t\t\t\t<Logo min={min} className=\"h-11 text-primary-500\" />\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\tfooter={(min) => (\n\t\t\t\t\t<div className={clsx('flex justify-between items-center', min ? 'flex-col space-y-2' : 'p-4')}>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t'text-gray-400 text-sm font-medium cursor-default',\n\t\t\t\t\t\t\t\tmin ? 'text-center' : ''\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{!min ? `Version: ${releases[0].number}` : `v${releases[0].number}`}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{site === 'livetest' ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'py-0.5 -my-0.5 font-medium text-sm leading-6 text-red-300 bg-red-400 dark:bg-red-500 bg-opacity-25 dark:bg-opacity-25',\n\t\t\t\t\t\t\t\t\tmin ? 'w-full text-center' : 'px-2.5 rounded-full'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tLiveTest\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : site === 'demo' ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'py-0.5 -my-0.5 font-medium text-sm leading-6 text-green-300 bg-green-400 dark:bg-green-500 bg-opacity-25 dark:bg-opacity-25',\n\t\t\t\t\t\t\t\t\tmin ? 'w-full text-center' : 'px-2.5 rounded-full'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tDemo\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : site === 'staging' ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'py-0.5 -my-0.5 font-medium text-sm leading-6 text-green-300 bg-green-400 dark:bg-green-500 bg-opacity-25 dark:bg-opacity-25',\n\t\t\t\t\t\t\t\t\tmin ? 'w-full text-center' : 'px-2.5 rounded-full'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tStaging\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : site === 'dev' ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t'py-0.5 -my-0.5 font-medium text-sm leading-6 text-indigo-300 bg-indigo-400 dark:bg-indigo-500 bg-opacity-25 dark:bg-opacity-25',\n\t\t\t\t\t\t\t\t\tmin ? 'w-full text-center' : 'px-2.5 rounded-full'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tDev\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t/>\n\n\t\t\t<div className=\"flex flex-col flex-1 md:w-0 md:overflow-hidden\">\n\t\t\t\t<main className=\"flex-1 relative z-0 md:overflow-y-auto focus:outline-none\" ref={ref}>\n\t\t\t\t\t<div className=\"max-w-7xl mx-auto\">\n\t\t\t\t\t\t<div className=\"border-b border-gray-300 dark:border-gray-700\">\n\t\t\t\t\t\t\t<Topbar />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<Suspense\n\t\t\t\t\t\tfallback={\n\t\t\t\t\t\t\t<div className=\"flex justify-center items-center h-screen\">\n\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"relative z-10\">{children}</div>\n\t\t\t\t\t</Suspense>\n\t\t\t\t</main>\n\t\t\t</div>\n\n\t\t\t<OnRouteChange\n\t\t\t\taction={() => {\n\t\t\t\t\tif (ref?.current?.scrollTo) ref.current.scrollTo(0, 0)\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t)\n}\n\nexport default PageSidebar\n","import { FC, Suspense, useMemo, useRef } from 'react'\nimport { RouteComponentProps, Link } from '@reach/router'\nimport logo from 'assets/img/logo-text.svg'\nimport Loader from '@primer/components/Loader'\nimport Topbar from '@primer/components/Topbar'\nimport OnRouteChange from '@primer/components/OnRouteChange'\nimport MobileMenu from '@primer/components/MobileMenu'\nimport { isNotNone } from '@primer/types'\nimport { CogIcon, QuestionMarkCircleIcon, ViewGridIcon } from '@heroicons/react/outline'\nimport db from 'db'\n\nconst PageTopbar: FC<RouteComponentProps> = ({ children }) => {\n\tconst ref = useRef<HTMLDivElement>(null)\n\n\tconst entities = db.entities.all()\n\n\tconst links = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ttitle: 'Home',\n\t\t\t\tto: '/home',\n\t\t\t\ticon: <ViewGridIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: true,\n\t\t\t},\n\t\t\t...entities.map((entity) => ({\n\t\t\t\ttitle: entity.plural || entity.name,\n\t\t\t\tto: `/${entity.key}`,\n\t\t\t\ticon: <QuestionMarkCircleIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: true,\n\t\t\t})),\n\t\t\t{\n\t\t\t\ttitle: 'Settings',\n\t\t\t\tto: '/settings',\n\t\t\t\ticon: <CogIcon className=\"w-5 h-5\" />,\n\t\t\t\texact: false,\n\t\t\t},\n\t\t],\n\t\t[entities]\n\t)\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"min-h-screen bg-gray-200 dark:bg-gray-800\">\n\t\t\t\t<MobileMenu links={links.filter(isNotNone)} withTopbar />\n\n\t\t\t\t<div className=\"bg-gray-800 dark:bg-gray-900 hidden md:block\">\n\t\t\t\t\t<nav className=\"bg-gray-800 dark:bg-gray-900\">\n\t\t\t\t\t\t<div className=\"max-w-7xl mx-auto sm:px-6 lg:px-8\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between h-16 px-4 sm:px-0\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t\t<Link to={`${process.env.PUBLIC_URL}/dashboard`}>\n\t\t\t\t\t\t\t\t\t\t\t<img src={logo} alt=\"ICRA\" className=\"h-10\" />\n\t\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"hidden md:block\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"ml-10 flex items-baseline space-x-4\">\n\t\t\t\t\t\t\t\t\t\t\t{links.filter(isNotNone).map((x, i) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\tto={`${process.env.PUBLIC_URL}${x.to}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{x.title}\n\t\t\t\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"hidden md:block\">\n\t\t\t\t\t\t\t\t\t<Topbar intent=\"dark\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</nav>\n\t\t\t\t</div>\n\n\t\t\t\t<main ref={ref} className=\"relative z-0\">\n\t\t\t\t\t<Suspense\n\t\t\t\t\t\tfallback={\n\t\t\t\t\t\t\t<div className=\"flex justify-center items-center h-screen\">\n\t\t\t\t\t\t\t\t<Loader />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"relative z-20\">{children}</div>\n\t\t\t\t\t</Suspense>\n\t\t\t\t</main>\n\t\t\t</div>\n\n\t\t\t<OnRouteChange\n\t\t\t\taction={() => {\n\t\t\t\t\twindow.scrollTo(0, 0)\n\t\t\t\t\tref?.current?.scrollTo(0, 0)\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t)\n}\n\nexport default PageTopbar\n","import { FC, forwardRef, MouseEventHandler, ReactNode, RefObject } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface CardProps {\n\tclassName?: ClassValue\n\theader?: ReactNode\n\tfooter?: ReactNode\n\tchildren?: ReactNode\n\tonClick?: MouseEventHandler<HTMLDivElement>\n\tonMouseOver?: MouseEventHandler<HTMLDivElement>\n\tonMouseOut?: MouseEventHandler<HTMLDivElement>\n\twrapperRef?: RefObject<HTMLDivElement>\n}\n\nconst Card: FC<CardProps> = ({ className, header, footer, children, onClick, onMouseOver, onMouseOut, wrapperRef }) => (\n\t<CardWrapper\n\t\tclassName={clsx(className)}\n\t\tonClick={onClick}\n\t\tonMouseOver={onMouseOver}\n\t\tonMouseOut={onMouseOut}\n\t\tref={wrapperRef}\n\t>\n\t\t{header}\n\t\t{children && <CardContent>{children}</CardContent>}\n\t\t{footer && <CardFooter>{footer}</CardFooter>}\n\t</CardWrapper>\n)\n\nexport const CardWrapper = forwardRef<HTMLDivElement, Omit<CardProps, 'header' | 'footer'>>(\n\t({ className, children, onClick, onMouseOver, onMouseOut }, ref) => (\n\t\t<div\n\t\t\tref={ref}\n\t\t\tclassName={clsx('bg-white dark:bg-gray-700 shadow rounded-none sm:rounded-md', className)}\n\t\t\tonClick={onClick}\n\t\t\tonMouseOver={onMouseOver}\n\t\t\tonMouseOut={onMouseOut}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t)\n)\n\nexport const CardContent: FC<{ children: ReactNode; className?: ClassValue }> = ({ className, children }) => (\n\t<div className={clsx('px-4 py-5 sm:p-6', className)} data-card>\n\t\t{children}\n\t</div>\n)\n\nexport const CardFooter: FC<{ children: ReactNode; className?: ClassValue }> = ({ className, children }) => (\n\t<div className={clsx('bg-gray-50 dark:bg-gray-750 sm:rounded-b-md px-4 py-4 sm:px-6', className)} data-card>\n\t\t{children}\n\t</div>\n)\n\nexport default Card\n","import { ReactNode } from 'react'\nimport { FormikConfig, Form as FormikForm, FormikProps, FormikHelpers, FormikProvider, useFormik } from 'formik'\n\ntype FormikRenderProp<T> = (props: FormikProps<T>) => ReactNode\n\nexport function isFormikRenderProp<T>(prop: any): prop is FormikRenderProp<T> {\n\treturn typeof prop === 'function'\n}\n\ninterface FormProps<T> {\n\tchildren: ReactNode | FormikRenderProp<T>\n\tcontext: FormikProps<T>\n\tclassName?: string\n}\n\nexport function Form<T>({ children, className, context }: FormProps<T>) {\n\treturn (\n\t\t<FormikProvider value={context}>\n\t\t\t<FormikForm className={className}>\n\t\t\t\t{isFormikRenderProp<T>(children) ? children(context) : children}\n\t\t\t</FormikForm>\n\t\t</FormikProvider>\n\t)\n}\n\nexport default Form\n\nexport const useForm = <T,>({ onSubmit, ...props }: FormikConfig<T>) => {\n\t// https://github.com/formium/formik/issues/739\n\tconst handleSubmit = async (formData: T, helpers: FormikHelpers<T>) => {\n\t\tawait onSubmit(formData, helpers)\n\t\thelpers.setSubmitting(false)\n\t}\n\n\tconst context = useFormik({\n\t\tonSubmit: handleSubmit,\n\t\t...props,\n\t})\n\n\treturn context\n}\n","import { FormikContextType, getIn } from 'formik'\nimport { FieldPath, FieldPathValue, FieldValues } from '@primer/types/form'\n\nexport interface FormValidations {\n\trequired?: string\n\tmin?: {\n\t\tvalue: number\n\t\tmessage: string\n\t}\n\tmax?: {\n\t\tvalue: number\n\t\tmessage: string\n\t}\n}\n\nexport const validate =\n\t(validations?: FormValidations) =>\n\t(value: any): string | undefined => {\n\t\tif (validations?.required && !value) {\n\t\t\treturn validations.required\n\t\t}\n\n\t\tif (validations?.min && +value < +validations.min.value) {\n\t\t\treturn validations.min.message\n\t\t}\n\n\t\tif (validations?.max && +value > +validations.max.value) {\n\t\t\treturn validations.max.message\n\t\t}\n\n\t\treturn undefined\n\t}\n\nexport function watch<\n\tTFieldValues extends FieldValues = FieldValues,\n\tTFieldName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>(name: TFieldName, context: FormikContextType<TFieldValues>): FieldPathValue<TFieldValues, TFieldName> {\n\treturn getIn(context?.values, name)\n}\n","import { ChangeEvent, ElementType, FC, ReactNode, useState } from 'react'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\nimport useAutoFocus from '@primer/hooks/useAutoFocus'\nimport { FormValidations, validate } from './utils'\nimport { v4 as uuidv4 } from 'uuid'\nimport { ExclamationCircleIcon } from '@heroicons/react/solid'\n\ntype FormInputIntent = 'default' | 'overlap' | 'inset'\n\ninterface FormInputProps {\n\tas?: ElementType | string\n\tname: string\n\tlabel?: ReactNode\n\ttype?: string\n\tintent?: FormInputIntent\n\tclassName?: ClassValue\n\tautoFocus?: boolean\n\thideOptional?: boolean\n\tvalidations?: FormValidations\n\tplaceholder?: string\n\tdisabled?: boolean\n\tstep?: number\n\tdescription?: string\n\tinputProps?: {\n\t\tmin?: number\n\t\tmax?: number\n\t\tstep?: number\n\t\tclassName?: string\n\t}\n}\n\nconst FormInput: FC<FormInputProps> = ({\n\tas = 'input',\n\tname,\n\tlabel,\n\ttype = 'text',\n\tintent = 'default',\n\tclassName,\n\tautoFocus = false,\n\thideOptional = false,\n\tvalidations = {},\n\tplaceholder,\n\tdisabled = false,\n\tdescription,\n\tinputProps = {},\n}) => {\n\tconst isRequired = validations?.required\n\n\tconst ref = useAutoFocus<HTMLInputElement>(autoFocus)\n\n\tconst Comp = as\n\n\tconst [{ value }, { error, touched }, { setValue, setTouched }] = useField({\n\t\tname,\n\t\ttype,\n\t\tvalidate: validate(validations),\n\t})\n\n\tconst formik = useFormikContext()\n\n\tconst [token] = useState(uuidv4())\n\n\tconst { className: extraClassName, ...extraProps } = inputProps\n\n\treturn intent === 'default' ? (\n\t\t<div className={clsx(className)}>\n\t\t\t{label && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 cursor-default\"\n\t\t\t\t\tonClick={() => ref.current?.focus()}\n\t\t\t\t>\n\t\t\t\t\t{label}{' '}\n\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<div className=\"text-[0px] leading-none select-none\">{token}</div>\n\n\t\t\t<div className={clsx('relative rounded-md', label && 'mt-1')}>\n\t\t\t\t<Comp\n\t\t\t\t\tref={ref}\n\t\t\t\t\ttype={type}\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>) => setValue(e.target.value)}\n\t\t\t\t\tonBlur={() => {\n\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t}}\n\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t'form-input block w-full sm:text-sm sm:leading-5',\n\t\t\t\t\t\textraClassName,\n\t\t\t\t\t\terror &&\n\t\t\t\t\t\t\ttouched &&\n\t\t\t\t\t\t\t'pr-10 border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500'\n\t\t\t\t\t)}\n\t\t\t\t\t{...(Comp === 'input' ? extraProps : {})}\n\t\t\t\t/>\n\t\t\t\t{error && touched && (\n\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\n\t\t\t\t\t\t<ExclamationCircleIcon className=\"h-5 w-5 text-red-500\" aria-hidden=\"true\" />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t{description && <p className=\"mt-2 text-xs text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t) : intent === 'overlap' ? (\n\t\t<div className={clsx(className)}>\n\t\t\t<div\n\t\t\t\tclassName={clsx(\n\t\t\t\t\t'relative border rounded-md px-3 py-2 focus-within:ring-1 transition-all duration-200',\n\t\t\t\t\terror && touched\n\t\t\t\t\t\t? 'focus-within:ring-red-500 focus-within:border-red-500 border-red-300'\n\t\t\t\t\t\t: 'focus-within:ring-primary-500 focus-within:border-primary-500 border-gray-300'\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t{label && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"absolute -top-2 left-2 -mt-px inline-block px-1 bg-white text-xs font-medium text-gray-900\"\n\t\t\t\t\t\tonClick={() => ref.current?.focus()}\n\t\t\t\t\t>\n\t\t\t\t\t\t{label}{' '}\n\t\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div className=\"text-[0px] leading-none select-none\">{token}</div>\n\n\t\t\t\t<div className={clsx('relative rounded-md', label && 'mt-1')}>\n\t\t\t\t\t<Comp\n\t\t\t\t\t\tref={ref}\n\t\t\t\t\t\ttype={type}\n\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>) => setValue(e.target.value)}\n\t\t\t\t\t\tonBlur={() => {\n\t\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t'block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 sm:text-sm',\n\t\t\t\t\t\t\textraClassName,\n\t\t\t\t\t\t\terror &&\n\t\t\t\t\t\t\t\ttouched &&\n\t\t\t\t\t\t\t\t'pr-10 border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{...(Comp === 'input' ? extraProps : {})}\n\t\t\t\t\t/>\n\t\t\t\t\t{error && touched && (\n\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-0 pb-1 flex items-center pointer-events-none\">\n\t\t\t\t\t\t\t<ExclamationCircleIcon className=\"h-5 w-5 text-red-500\" aria-hidden=\"true\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{description && <p className=\"mt-2 text-xs text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t) : intent === 'inset' ? (\n\t\t<div className={clsx(className)}>\n\t\t\t<div\n\t\t\t\tclassName={clsx(\n\t\t\t\t\t'border rounded-md px-3 py-2 focus-within:ring-1 transition-all duration-200',\n\t\t\t\t\terror && touched\n\t\t\t\t\t\t? 'focus-within:ring-red-500 focus-within:border-red-500 border-red-300'\n\t\t\t\t\t\t: 'focus-within:ring-primary-500 focus-within:border-primary-500 border-gray-300'\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<div className=\"block text-xs font-medium text-gray-900\" onClick={() => ref.current?.focus()}>\n\t\t\t\t\t{label}{' '}\n\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t<Comp\n\t\t\t\t\t\tref={ref}\n\t\t\t\t\t\ttype={type}\n\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>) => setValue(e.target.value)}\n\t\t\t\t\t\tonBlur={() => {\n\t\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t'block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 sm:text-sm',\n\t\t\t\t\t\t\textraClassName,\n\t\t\t\t\t\t\terror &&\n\t\t\t\t\t\t\t\ttouched &&\n\t\t\t\t\t\t\t\t'pr-10 border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{...(Comp === 'input' ? extraProps : {})}\n\t\t\t\t\t/>\n\t\t\t\t\t{error && touched && (\n\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-0 pb-1 flex items-center pointer-events-none\">\n\t\t\t\t\t\t\t<ExclamationCircleIcon className=\"h-5 w-5 text-red-500\" aria-hidden=\"true\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{description && <p className=\"mt-2 text-xs text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t) : null\n}\n\nexport default FormInput\n","import { ReactNode, FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\nexport const tabIntents = {\n\tdefault: {\n\t\tcontainer: 'border-b border-gray-200',\n\t\ttab: (isActive: boolean) => [\n\t\t\tisActive\n\t\t\t\t? 'border-indigo-500 text-indigo-600'\n\t\t\t\t: 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300',\n\t\t\t'whitespace-nowrap py-4 px-3 border-b-2 font-medium text-sm',\n\t\t],\n\t},\n\tcard: {\n\t\tcontainer: 'ml-2',\n\t\ttab: (isActive: boolean) => [\n\t\t\t'whitespace-nowrap px-4 py-3 mr-2 font-medium text-sm rounded-t-md shadow',\n\t\t\tisActive ? 'bg-white' : 'bg-white bg-opacity-50',\n\t\t],\n\t},\n}\n\ninterface TabsProps {\n\ttabs: { label: ReactNode; value: string }[]\n\tvalue: string\n\tonChange: (x: string) => void\n\tclassName?: ClassValue\n\tintent?: keyof typeof tabIntents\n}\n\nconst Tabs: FC<TabsProps> = ({ tabs, value, onChange, className, intent = 'default' }) => {\n\treturn (\n\t\t<div className={clsx('pt-2 px-2 -mt-2 -mx-2 overflow-hidden', className)}>\n\t\t\t<div className=\"sm:hidden\">\n\t\t\t\t<label htmlFor=\"tabs\" className=\"sr-only\">\n\t\t\t\t\tSelect a tab\n\t\t\t\t</label>\n\t\t\t\t<select\n\t\t\t\t\tid=\"tabs\"\n\t\t\t\t\tname=\"tabs\"\n\t\t\t\t\tclassName=\"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={(e) => onChange(e.target.value)}\n\t\t\t\t>\n\t\t\t\t\t{tabs.map((tab) => (\n\t\t\t\t\t\t<option key={tab.value}>{tab.label}</option>\n\t\t\t\t\t))}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div className=\"hidden sm:block\">\n\t\t\t\t<div className={tabIntents[intent].container}>\n\t\t\t\t\t<nav className=\"-mb-px flex\" aria-label=\"Tabs\">\n\t\t\t\t\t\t{tabs.map((tab) => (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tkey={tab.value}\n\t\t\t\t\t\t\t\tclassName={clsx(tabIntents[intent].tab(tab.value === value))}\n\t\t\t\t\t\t\t\taria-current={tab.value === value ? 'page' : undefined}\n\t\t\t\t\t\t\t\tonClick={() => onChange(tab.value)}\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{tab.label}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</nav>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Tabs\n","import { FC, ReactNode, useState } from 'react'\nimport Select from 'react-select'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\nimport { XIcon } from '@heroicons/react/outline'\nimport { v4 as uuidv4 } from 'uuid'\nimport { FormValidations, validate } from './utils'\n\ntype FormSelectIntent = 'default' | 'overlap'\n\nexport interface Option {\n\tlabel: string\n\tvalue: any\n}\n\ninterface FormSelectProps {\n\tname: string\n\tlabel?: ReactNode\n\toptions: Option[]\n\tintent?: FormSelectIntent\n\tclearable?: boolean\n\tdisabled?: boolean\n\tdescription?: string\n\tplaceholder?: string\n\tvalidations?: FormValidations\n\thideOptional?: boolean\n\tclassName?: ClassValue\n\tautoFocus?: boolean\n\tonChange?: (value: any) => void\n}\n\nconst FormSelect: FC<FormSelectProps> = ({\n\tname,\n\tlabel,\n\toptions,\n\tintent = 'default',\n\tclearable,\n\tdisabled = false,\n\tdescription,\n\tplaceholder,\n\tvalidations = {},\n\thideOptional = false,\n\tclassName,\n\tautoFocus,\n\tonChange: onChangeProp,\n}) => {\n\tconst isRequired = validations?.required\n\n\tconst [{ value, onBlur }, { error, touched }, { setValue, setTouched }] = useField({\n\t\tname,\n\t\tvalidate: validate(validations),\n\t})\n\n\tconst formik = useFormikContext()\n\n\tconst [token] = useState(uuidv4())\n\n\tconst select = (\n\t\t<Select\n\t\t\toptions={options}\n\t\t\tvalue={\n\t\t\t\toptions.find((x) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tx.value === value ||\n\t\t\t\t\t\t(value !== null && x.value === +value) ||\n\t\t\t\t\t\t(x.value?.id !== undefined && x.value?.id === value?.id)\n\t\t\t\t\t)\n\t\t\t\t}) || null\n\t\t\t}\n\t\t\tonChange={(option: any) => {\n\t\t\t\tsetTouched(true)\n\t\t\t\tsetValue(option ? option.value : null)\n\t\t\t\tif (onChangeProp) onChangeProp(option ? option.value : null)\n\t\t\t}}\n\t\t\tonBlur={(e) => {\n\t\t\t\tsetTouched(true)\n\t\t\t\tonBlur(e)\n\t\t\t}}\n\t\t\tinputProps={{ autoComplete: 'none', autoCorrect: 'off', spellCheck: 'off' }}\n\t\t\tclassName={clsx(\n\t\t\t\t'react-select-container font-normal',\n\t\t\t\tlabel && intent === 'default' && 'mt-1',\n\t\t\t\terror && touched && 'react-select-container-error'\n\t\t\t)}\n\t\t\tclassNamePrefix=\"react-select\"\n\t\t\tplaceholder={placeholder}\n\t\t\tisClearable={clearable}\n\t\t\tisDisabled={disabled || formik.isSubmitting}\n\t\t\tautoFocus={autoFocus}\n\t\t\tmenuPlacement=\"auto\"\n\t\t\tcomponents={{\n\t\t\t\tClearIndicator: ({ hasValue, innerProps: { ref, ...restInnerProps } }) => {\n\t\t\t\t\treturn hasValue ? (\n\t\t\t\t\t\t<span ref={ref} {...restInnerProps}>\n\t\t\t\t\t\t\t<XIcon className=\"mr-8 w-5 h-5 cursor-pointer text-gray-400 hover:text-red-500\" />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t) : null\n\t\t\t\t},\n\t\t\t\tDropdownIndicator: ({ innerProps: { ref } }) => null,\n\t\t\t}}\n\t\t/>\n\t)\n\n\treturn intent === 'default' ? (\n\t\t<div className={clsx(className)}>\n\t\t\t<label className=\"block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200\">\n\t\t\t\t{label && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t{label}{' '}\n\t\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)}\n\n\t\t\t\t<div className=\"text-[0px] leading-none select-none\">{token}</div>\n\n\t\t\t\t{select}\n\t\t\t</label>\n\n\t\t\t{description && !error && !touched && <p className=\"mt-2 text-sm text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t) : intent === 'overlap' ? (\n\t\t<div className={clsx(className)}>\n\t\t\t<label className=\"relative block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200\">\n\t\t\t\t{label && (\n\t\t\t\t\t<div className=\"absolute -top-2 left-2 -mt-px inline-block px-1 bg-white text-xs font-medium text-gray-900 z-[1]\">\n\t\t\t\t\t\t{label}{' '}\n\t\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t<div className=\"text-[0px] leading-none select-none\">{token}</div>\n\n\t\t\t\t{select}\n\t\t\t</label>\n\n\t\t\t{description && !error && !touched && <p className=\"mt-2 text-sm text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t) : null\n}\n\nexport default FormSelect\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { actionPermissionResource, ActionPermissionResource, EntityResource, entityResource, RoleModel } from '.'\n\nexport interface ActionModel extends Model {\n\tentityId: FK\n\tkey: string\n\tname: string\n\tchanges?: ActionChangeModel[]\n}\n\nexport interface ActionChangeModel extends Model {\n\tactionId: FK\n\tfieldId: FK\n\tuserDefined: boolean\n}\n\nexport interface ActionResource extends ActionModel {\n\treadonly entity: EntityResource | null\n\treadonly permissions: ActionPermissionResource[]\n\treadonly permission: (roleId: Identifier<RoleModel>) => ActionPermissionResource | null\n}\n\nexport const actionResource = (id: Identifier<ActionModel>): ActionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.actions.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t\tget permissions() {\n\t\t\treturn db.actionPermissions\n\t\t\t\t.all((x) => x.actionId === data?.id)\n\t\t\t\t.map(actionPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tpermission: (roleId) => {\n\t\t\tlet role = typeof roleId === 'string' || typeof roleId === 'function' ? db.roles.find(roleId) : roleId\n\t\t\treturn actionPermissionResource((x) => x.actionId === data?.id && x.roleId === role?.id)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { RoleResource, ActionResource, roleResource, actionResource } from '.'\n\nexport interface ActionPermissionModel extends Model {\n\troleId: FK\n\tactionId: FK\n\tperform: boolean\n}\n\nexport interface ActionPermissionResource extends ActionPermissionModel {\n\treadonly role: RoleResource | null\n\treadonly action: ActionResource | null\n}\n\nexport const actionPermissionResource = (id: Identifier<ActionPermissionModel>): ActionPermissionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.actionPermissions.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget role() {\n\t\t\treturn roleResource((x) => x.id === data?.roleId)\n\t\t},\n\t\tget action() {\n\t\t\treturn actionResource((x) => x.id === data?.actionId)\n\t\t},\n\t}\n}\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Identifier, Model } from 'types/db'\nimport {\n\tFieldResource,\n\tActionResource,\n\tRelationResource,\n\tUnitResource,\n\tfieldResource,\n\tactionResource,\n\trelationResource,\n\tunitResource,\n\tEntityPermissionResource,\n\tRoleModel,\n\tentityPermissionResource,\n\tPlanResource,\n\tplanResource,\n} from '.'\n\nexport interface EntityModel extends Model {\n\tkey: string\n\tname: string\n\tplural?: string\n}\n\nexport interface EntityResource extends EntityModel {\n\treadonly fields: FieldResource[]\n\treadonly actions: ActionResource[]\n\treadonly relations: RelationResource[]\n\treadonly units: UnitResource[]\n\treadonly permissions: EntityPermissionResource[]\n\treadonly permission: (roleId: Identifier<RoleModel>) => EntityPermissionResource | null\n\treadonly plan: (key: string) => PlanResource | null\n\treadonly plans: PlanResource[]\n}\n\nexport const entityResource = (id: Identifier<EntityModel>): EntityResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.entities.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget fields() {\n\t\t\treturn db.fields\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(fieldResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tget actions() {\n\t\t\treturn db.actions\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(actionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tget relations() {\n\t\t\treturn db.relations\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(relationResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tget units() {\n\t\t\treturn db.fields\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(unitResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tget permissions() {\n\t\t\treturn db.entityPermissions\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(entityPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tpermission: (roleId) => {\n\t\t\tlet role = typeof roleId === 'string' || typeof roleId === 'function' ? db.roles.find(roleId) : roleId\n\t\t\treturn entityPermissionResource((x) => x.entityId === data?.id && x.roleId === role?.id)\n\t\t},\n\t\tplan: (key) => {\n\t\t\treturn planResource((x) => x.key === key && x.entityId === data?.id)\n\t\t},\n\t\tget plans() {\n\t\t\treturn db.plans\n\t\t\t\t.all((x) => x.entityId === data?.id)\n\t\t\t\t.map(planResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { RoleResource, EntityResource, roleResource, entityResource } from '.'\n\nexport interface EntityPermissionModel extends Model {\n\troleId: FK\n\tentityId: FK\n\tview: boolean\n\tmodify: boolean\n\tremove: boolean\n}\n\nexport interface EntityPermissionResource extends EntityPermissionModel {\n\treadonly role: RoleResource | null\n\treadonly entity: EntityResource | null\n}\n\nexport const entityPermissionResource = (id: Identifier<EntityPermissionModel>): EntityPermissionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.entityPermissions.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget role() {\n\t\t\treturn roleResource((x) => x.id === data?.roleId)\n\t\t},\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t}\n}\n","import { ValueModel } from 'db/types'\nimport { Identity } from 'types'\nimport { v4 } from 'uuid'\n\nexport const sortValuesByLatest = (a: ValueModel, b: ValueModel) => {\n\tif (a.created && b.created) return new Date(b.created).valueOf() - new Date(a.created).valueOf()\n\treturn 0\n}\n\nexport const uuid = v4\n\nexport const replaceMarkers = (\n\tpattern: string,\n\tdata: Record<string, string | undefined>,\n\tdelimiter: string | Identity<string> = '$'\n) => {\n\treturn Object.entries(data)\n\t\t.reduce((output, [key, val]) => {\n\t\t\treturn output.replace(typeof delimiter === 'string' ? `${delimiter}${key}` : delimiter(key), val || '')\n\t\t}, pattern)\n\t\t.replace(/\\s{2,}/g, ' ')\n}\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { sortValuesByLatest } from 'utils/funcs'\nimport {\n\tEntityResource,\n\tUnitModel,\n\tValueResource,\n\tFieldPermissionResource,\n\tRoleModel,\n\tentityResource,\n\tvalueResource,\n\tfieldPermissionResource,\n} from '.'\n\nexport type FieldType = 'string' | 'number' | 'date' | 'boolean' | 'option'\n\nexport interface FieldModel extends Model {\n\tentityId: FK\n\tkey: string\n\tname: string\n\tplural?: string\n\ttemplate?: string\n\ttype: FieldType\n\toptions: Array<string>\n\tdateFormat?: string\n\tdefaultValue?: string\n}\n\nexport interface FieldResource extends FieldModel {\n\treadonly entity: EntityResource | null\n\treadonly value: (unitId: Identifier<UnitModel>) => ValueResource | null\n\treadonly values: (unitId: Identifier<UnitModel>) => ValueResource[]\n\treadonly permissions: FieldPermissionResource[]\n\treadonly permission: (roleId: Identifier<RoleModel>) => FieldPermissionResource | null\n}\n\nexport const fieldResource = (id: Identifier<FieldModel>): FieldResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.fields.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t\tvalue: (unitId) => {\n\t\t\tlet unit = typeof unitId === 'string' || typeof unitId === 'function' ? db.units.find(unitId) : unitId\n\t\t\treturn valueResource(\n\t\t\t\tdb.values.all((x) => x.unitId === unit?.id && x.fieldId === data?.id).sort(sortValuesByLatest)[0]\n\t\t\t)\n\t\t},\n\t\tvalues: (unitId) => {\n\t\t\tlet unit = typeof unitId === 'string' || typeof unitId === 'function' ? db.units.find(unitId) : unitId\n\t\t\treturn db.values\n\t\t\t\t.all((x) => x.unitId === unit?.id && x.fieldId === data?.id)\n\t\t\t\t.sort(sortValuesByLatest)\n\t\t\t\t.map(valueResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tget permissions() {\n\t\t\treturn db.fieldPermissions\n\t\t\t\t.all((x) => x.fieldId === data?.id)\n\t\t\t\t.map(fieldPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tpermission: (roleId) => {\n\t\t\tlet role = typeof roleId === 'string' || typeof roleId === 'function' ? db.roles.find(roleId) : roleId\n\t\t\treturn fieldPermissionResource((x) => x.fieldId === data?.id && x.roleId === role?.id)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { RoleResource, FieldResource, roleResource, fieldResource } from '.'\n\nexport interface FieldPermissionModel extends Model {\n\troleId: FK\n\tfieldId: FK\n\tview: boolean\n\tmodify: boolean\n}\n\nexport interface FieldPermissionResource extends FieldPermissionModel {\n\treadonly role: RoleResource | null\n\treadonly field: FieldResource | null\n}\n\nexport const fieldPermissionResource = (id: Identifier<FieldPermissionModel>): FieldPermissionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.fieldPermissions.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget role() {\n\t\t\treturn roleResource((x) => x.id === data?.roleId)\n\t\t},\n\t\tget field() {\n\t\t\treturn fieldResource((x) => x.id === data?.fieldId)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { EntityResource, entityResource } from '.'\n\nexport type RelationType = 'one-to-one' | 'one-to-many' | 'many-to-many'\n\nexport interface RelationModel extends Model {\n\tkey: string\n\tname: string\n\tentityId: FK\n\trelatedId: FK\n\ttype: RelationType\n}\n\nexport interface RelationResource extends RelationModel {\n\treadonly entity: EntityResource | null\n\treadonly related: EntityResource | null\n}\n\nexport const relationResource = (id: Identifier<RelationModel>): RelationResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.relations.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t\tget related() {\n\t\t\treturn entityResource((x) => x.id === data?.relatedId)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { RoleResource, RelationResource, roleResource, relationResource } from '.'\n\nexport interface RelationPermissionModel extends Model {\n\troleId: FK\n\trelationId: FK\n\tview: boolean\n\tmodify: boolean\n\tremove: boolean\n}\n\nexport interface RelationPermissionResource extends RelationPermissionModel {\n\treadonly role: RoleResource | null\n\treadonly relation: RelationResource | null\n}\n\nexport const relationPermissionResource = (\n\tid: Identifier<RelationPermissionModel>\n): RelationPermissionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.relationPermissions.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget role() {\n\t\t\treturn roleResource((x) => x.id === data?.roleId)\n\t\t},\n\t\tget relation() {\n\t\t\treturn relationResource((x) => x.id === data?.relationId)\n\t\t},\n\t}\n}\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Identifier, Model } from 'types/db'\nimport {\n\tFieldModel,\n\tEntityModel,\n\tfieldPermissionResource,\n\tFieldPermissionResource,\n\tActionModel,\n\tActionPermissionResource,\n\tactionPermissionResource,\n\tRelationModel,\n\tRelationPermissionResource,\n\trelationPermissionResource,\n} from '.'\n\nexport interface RoleModel extends Model {\n\tname: string\n}\n\nexport interface RoleResource extends RoleModel {\n\treadonly fieldPermission: (x: Identifier<FieldModel>) => FieldPermissionResource | null\n\treadonly fieldPermissions: (x: Identifier<EntityModel>) => FieldPermissionResource[]\n\treadonly actionPermission: (x: Identifier<ActionModel>) => ActionPermissionResource | null\n\treadonly actionPermissions: (x: Identifier<EntityModel>) => ActionPermissionResource[]\n\treadonly relationPermission: (x: Identifier<RelationModel>) => RelationPermissionResource | null\n\treadonly relationPermissions: (x: Identifier<EntityModel>) => RelationPermissionResource[]\n}\n\nexport const roleResource = (id: Identifier<RoleModel>): RoleResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.roles.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tfieldPermission: (fieldId) => {\n\t\t\tlet field = typeof fieldId === 'string' || typeof fieldId === 'function' ? db.fields.find(fieldId) : fieldId\n\t\t\treturn fieldPermissionResource((y) => y.fieldId === field?.id && y.roleId === data?.id)\n\t\t},\n\t\tfieldPermissions: (entityId) => {\n\t\t\tlet entity =\n\t\t\t\ttypeof entityId === 'string' || typeof entityId === 'function' ? db.entities.find(entityId) : entityId\n\t\t\tlet fields = db.fields.all((x) => x.entityId === entity?.id)\n\t\t\treturn fields\n\t\t\t\t.map((x) => db.fieldPermissions.find((y) => y.fieldId === x.id && y.roleId === data?.id))\n\t\t\t\t.filter(isNotNone)\n\t\t\t\t.map(fieldPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\n\t\tactionPermission: (actionId) => {\n\t\t\tlet action =\n\t\t\t\ttypeof actionId === 'string' || typeof actionId === 'function' ? db.actions.find(actionId) : actionId\n\t\t\treturn actionPermissionResource((y) => y.actionId === action?.id && y.roleId === data?.id)\n\t\t},\n\t\tactionPermissions: (entityId) => {\n\t\t\tlet entity =\n\t\t\t\ttypeof entityId === 'string' || typeof entityId === 'function' ? db.entities.find(entityId) : entityId\n\t\t\tlet actions = db.actions.all((x) => x.entityId === entity?.id)\n\t\t\treturn actions\n\t\t\t\t.map((x) => db.actionPermissions.find((y) => y.actionId === x.id && y.roleId === data?.id))\n\t\t\t\t.filter(isNotNone)\n\t\t\t\t.map(actionPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\n\t\trelationPermission: (relationId) => {\n\t\t\tlet relation =\n\t\t\t\ttypeof relationId === 'string' || typeof relationId === 'function'\n\t\t\t\t\t? db.relations.find(relationId)\n\t\t\t\t\t: relationId\n\t\t\treturn relationPermissionResource((y) => y.relationId === relation?.id && y.roleId === data?.id)\n\t\t},\n\t\trelationPermissions: (entityId) => {\n\t\t\tlet entity =\n\t\t\t\ttypeof entityId === 'string' || typeof entityId === 'function' ? db.entities.find(entityId) : entityId\n\t\t\tlet relations = db.relations.all((x) => x.entityId === entity?.id)\n\t\t\treturn relations\n\t\t\t\t.map((x) => db.relationPermissions.find((y) => y.relationId === x.id && y.roleId === data?.id))\n\t\t\t\t.filter(isNotNone)\n\t\t\t\t.map(relationPermissionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t}\n}\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { sortValuesByLatest } from 'utils/funcs'\nimport { EntityResource, ValueResource, entityResource, valueResource, FieldModel } from '.'\n\nexport interface UnitModel extends Model {\n\tentityId: FK\n}\n\nexport interface UnitResource extends UnitModel {\n\treadonly resolvedValues: Record<string, string | undefined>\n\treadonly entity: EntityResource | null\n\treadonly values: ValueResource[]\n\treadonly value: (id: Identifier<FieldModel>) => ValueResource | null\n}\n\nexport const unitResource = (id: Identifier<UnitModel>): UnitResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.units.find(id) : id\n\n\tif (!data) return null\n\n\tlet fields = entityResource((x) => x.id === data?.entityId)?.fields\n\n\treturn {\n\t\t...data,\n\t\tresolvedValues:\n\t\t\tfields?.reduce((values, field) => {\n\t\t\t\tlet foundValue = db.values\n\t\t\t\t\t.all((y) => y.unitId === data?.id && y.fieldId === field?.id)\n\t\t\t\t\t.sort(sortValuesByLatest)\n\t\t\t\t\t.map(valueResource)[0]\n\n\t\t\t\treturn {\n\t\t\t\t\t...values,\n\t\t\t\t\t[field.key]: foundValue?.value,\n\t\t\t\t}\n\t\t\t}, {}) || {},\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t\tget values() {\n\t\t\tlet entity = db.entities.find((x) => x.id === data?.entityId)\n\t\t\tlet fields = db.fields.all((x) => x.entityId === entity?.id)\n\t\t\treturn fields\n\t\t\t\t.map((x) => db.values.all((y) => y.fieldId === x.id).sort(sortValuesByLatest)[0])\n\t\t\t\t.map(valueResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t\tvalue: (id) => {\n\t\t\tlet field = typeof id === 'string' || typeof id === 'function' ? db.fields.find(id) : id\n\n\t\t\treturn db.values\n\t\t\t\t.all((y) => y.unitId === data?.id && y.fieldId === field?.id)\n\t\t\t\t.sort(sortValuesByLatest)\n\t\t\t\t.map(valueResource)[0]\n\t\t},\n\t}\n}\n","import { format } from 'date-fns'\nimport db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { sortValuesByLatest } from 'utils/funcs'\nimport { FieldResource, UnitResource, fieldResource, unitResource } from '.'\n\nexport interface ValueModel extends Model {\n\tunitId: FK\n\tfieldId: FK\n\tvalue: string\n\tcreated: string\n}\n\nexport interface ValueResource extends ValueModel {\n\treadonly field: FieldResource | null\n\treadonly unit: UnitResource | null\n\treadonly history: ValueModel[]\n\treadonly formatted: string | null\n}\n\nexport const valueResource = (id: Identifier<ValueModel>): ValueResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.values.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget field() {\n\t\t\treturn fieldResource((x) => x.id === data?.fieldId)\n\t\t},\n\t\tget unit() {\n\t\t\treturn unitResource((x) => x.id === data?.unitId)\n\t\t},\n\t\tget history() {\n\t\t\treturn db.values\n\t\t\t\t.all((x) => x.fieldId === data?.fieldId && x.unitId === data?.unitId)\n\t\t\t\t.sort(sortValuesByLatest)\n\t\t},\n\t\tget formatted() {\n\t\t\tlet field = fieldResource((x) => x.id === data?.fieldId)\n\t\t\tif (!field) return null\n\n\t\t\ttry {\n\t\t\t\tlet output =\n\t\t\t\t\tfield.type === 'date'\n\t\t\t\t\t\t? format(new Date(data?.value || ''), field?.dateFormat || 'dd/MM/yyyy')\n\t\t\t\t\t\t: data?.value || null\n\n\t\t\t\treturn output\n\t\t\t} catch (error) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, FK, Identifier } from 'types/db'\nimport { EntityResource, entityResource } from '.'\n\nexport interface PlanModel extends Model {\n\tentityId: FK\n\tkey: string\n\tname: string\n\tstructure: string\n}\n\nexport interface PlanResource extends PlanModel {\n\treadonly data: PlanModel | null\n\treadonly entity: EntityResource | null\n}\n\nexport const planResource = (id: Identifier<PlanModel>): PlanResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.plans.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tdata,\n\t\tget entity() {\n\t\t\treturn entityResource((x) => x.id === data?.entityId)\n\t\t},\n\t}\n}\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Model, Identifier, FK } from 'types/db'\nimport { workflowStepConnectionResource, WorkflowStepConnectionResource } from './'\n\nexport interface WorkflowStepModel extends Model {\n\tworkflowId: FK\n\ttargetWorkflow?: FK\n\tname: string\n\tdescription: string\n\tisTransition?: boolean\n\tisStart?: boolean\n\tposX?: number\n\tposY?: number\n}\n\nexport interface WorkflowStepResource extends WorkflowStepModel {\n\treadonly connections: WorkflowStepConnectionResource[]\n}\n\nexport const workflowStepResource = (id: Identifier<WorkflowStepModel>): WorkflowStepResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.workflowSteps.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget connections() {\n\t\t\treturn db.workflowStepConnections\n\t\t\t\t.all((x) => x.sourceId === data?.id)\n\t\t\t\t.map(workflowStepConnectionResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t}\n}\n","import db from 'db'\nimport { Model, Identifier } from 'types/db'\nimport { workflowStepResource, WorkflowStepResource } from '.'\n\nexport interface WorkflowStepConnectionModel extends Model {\n\tsourceId: string\n\ttargetId: string\n\ttrigger: string\n\tfield: string\n\tfieldValue: string\n}\n\nexport interface WorkflowStepConnectionResource extends WorkflowStepConnectionModel {\n\treadonly target: WorkflowStepResource | null\n}\n\nexport const workflowStepConnectionResource = (\n\tid: Identifier<WorkflowStepConnectionModel>\n): WorkflowStepConnectionResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.workflowStepConnections.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget target() {\n\t\t\treturn workflowStepResource(data?.targetId || '')\n\t\t},\n\t}\n}\n","import { FC, useState } from 'react'\nimport { RouteComponentProps } from '@reach/router'\nimport logo from 'assets/img/logo-text.svg'\nimport { CardContent, CardFooter, CardWrapper } from '@primer/components/Card'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport Actions from '@primer/components/Actions'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport { LoginIcon } from '@heroicons/react/outline'\nimport Tabs from '@primer/components/Tabs'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport { UnitModel, unitResource } from 'db/types'\nimport db from 'db'\n\nconst tabs = [\n\t{ label: 'Preset', value: 'preset' },\n\t{ label: 'Credentials', value: 'credentials' },\n]\n\nconst userEntity = db.entities.find((x) => x.key === 'user')\n\nconst userOptions = db.units\n\t.all((x) => x.entityId === userEntity?.id)\n\t.map((x) => {\n\t\tlet unit = unitResource(x)\n\t\tlet firstNameField = unit?.entity?.fields.find((x) => x.key === 'first-name')\n\t\tlet lastNameField = unit?.entity?.fields.find((x) => x.key === 'last-name')\n\t\tlet firstName = unit?.value(firstNameField?.id || '')?.value\n\t\tlet lastName = unit?.value(lastNameField?.id || '')?.value\n\n\t\t// console.log('firstName', unit?.value(firstNameField?.id || ''), unit?.values)\n\n\t\treturn {\n\t\t\tlabel: firstName + ' ' + lastName,\n\t\t\tvalue: x,\n\t\t}\n\t})\n\ninterface FormSchema {\n\tusername: string\n\tpassword: string\n\tuser: UnitModel | null\n}\n\nconst Login: FC<RouteComponentProps> = () => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\tusername: '',\n\t\t\tpassword: '',\n\t\t\tuser: null,\n\t\t},\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('formData', formData)\n\t\t},\n\t})\n\n\tconst [tab, setTab] = useState(tabs[0].value)\n\n\treturn (\n\t\t<div className=\"bg-gray-900 min-h-screen flex items-center justify-center\">\n\t\t\t<div className=\"max-w-2xl w-full space-y-6\">\n\t\t\t\t<img src={logo} className=\"h-16\" alt=\"logo\" />\n\t\t\t\t<Form context={formContext}>\n\t\t\t\t\t<CardWrapper>\n\t\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<Tabs tabs={tabs} value={tab} onChange={setTab} />\n\n\t\t\t\t\t\t\t\t{tab === 'preset' && (\n\t\t\t\t\t\t\t\t\t<Stack className=\"p-2 -m-2\">\n\t\t\t\t\t\t\t\t\t\t<FormSelect name=\"user\" label=\"User\" options={userOptions} />\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{tab === 'credentials' && (\n\t\t\t\t\t\t\t\t\t<Stack className=\"p-2 -m-2\">\n\t\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\t\t\t\t\t\tlabel=\"Email Address\"\n\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Email Address is required' }}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Password is required' }}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</CardContent>\n\t\t\t\t\t\t<CardFooter>\n\t\t\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Login',\n\t\t\t\t\t\t\t\t\t\t\ticon: <LoginIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CardFooter>\n\t\t\t\t\t</CardWrapper>\n\t\t\t\t</Form>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Login\n","import { FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface ButtonSpacerProps {\n\tclassName?: ClassValue\n}\n\nconst ButtonSpacer: FC<ButtonSpacerProps> = ({ className }) => (\n\t<div className={clsx('px-4 py-2 text-sm opacity-0 leading-5 pointer-events-none', className)}>&nbsp;</div>\n)\n\nexport default ButtonSpacer\n","import { FC, ReactNode, useEffect } from 'react'\nimport Actions from '@primer/components/Actions'\nimport ButtonSpacer from '@primer/components/ButtonSpacer'\nimport { ActionType, isNotNone, None } from '@primer/types'\nimport clsx, { ClassValue } from 'clsx'\nimport db from 'db'\n\ninterface PageInfo {\n\ttitle: ReactNode\n\ticon?: ReactNode\n}\n\ntype PageInfoType = PageInfo | None\n\ninterface PageHeadingProps {\n\ttitle?: ReactNode\n\tpageTitle?: string\n\tactions?: ActionType[]\n\tinfoList?: PageInfoType[]\n\tclassName?: ClassValue\n}\n\nconst PageHeading: FC<PageHeadingProps> = ({ title = '', pageTitle, actions = [], infoList, className }) => {\n\tuseEffect(() => {\n\t\tconst value = pageTitle || title\n\t\tdocument.title = `${value} - ${db.siteSettings.get('title')}`\n\t}, [title, pageTitle])\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<div className=\"pt-3 lg:pt-6 antialiased\">\n\t\t\t\t<div className=\"max-w-7xl mx-auto px-4 mb-8 sm:px-6 lg:px-8\">\n\t\t\t\t\t<div className=\"md:flex md:items-start md:justify-between flex-wrap\">\n\t\t\t\t\t\t<div className=\"mr-4 my-3 flex-1 mb-6 md:mb-0\">\n\t\t\t\t\t\t\t<h2 className=\"flex items-center text-2xl leading-8 font-bold text-gray-900 dark:text-white sm:text-3xl sm:leading-9 whitespace-nowrap\">\n\t\t\t\t\t\t\t\t{title}\n\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t{infoList && (\n\t\t\t\t\t\t\t\t<div className=\"mt-1 flex flex-col sm:mt-0 sm:flex-row sm:flex-wrap\">\n\t\t\t\t\t\t\t\t\t{infoList.filter(isNotNone).map((info, i) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-2 flex items-center text-sm leading-5 text-gray-600 dark:text-gray-300 sm:mr-6\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{info.icon && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 mr-1.5 text-gray-500 dark:text-gray-200\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{info.icon}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{info.title}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{actions.filter(isNotNone).length > 0 ? (\n\t\t\t\t\t\t\t<div className=\"my-3 flex\">\n\t\t\t\t\t\t\t\t<Actions actions={actions} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className=\"my-3 hidden md:block\">\n\t\t\t\t\t\t\t\t<ButtonSpacer />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default PageHeading\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { smartReplaceClasses } from '@primer/utils/funcs'\n\nconst fixClasses = (className = '') =>\n\tsmartReplaceClasses(className, [{ pattern: /^max-w-\\dxl$/, defaultValue: 'max-w-7xl' }])\n\ninterface PageContentProps {\n\tclassName?: ClassValue\n\twidth?: number\n\tchildren: ReactNode\n}\n\nconst PageContent: FC<PageContentProps> = ({ className, children }) => {\n\treturn <div className={fixClasses(clsx('w-full mx-auto pb-8 sm:px-6 lg:px-8', className))}>{children}</div>\n}\n\nexport default PageContent\n","import { ActionModel, EntityModel, FieldModel, RoleModel } from 'db/types'\nimport { v4 as id } from 'uuid'\nimport db, { clear, persist } from './index'\n\nexport const seed = () => {\n\tclear()\n\tpersist()\n\n\tdb.siteSettings.set('title', 'Resolutionary')\n\tdb.siteSettings.set('layout', 'sidebar')\n\n\t// ENTITY TYPES\n\n\tconst userEntity: EntityModel = {\n\t\tid: id(),\n\t\tkey: 'user',\n\t\tname: 'User',\n\t\tplural: 'Users',\n\t}\n\n\tconst caseEntity: EntityModel = {\n\t\tid: id(),\n\t\tkey: 'case',\n\t\tname: 'Case',\n\t\tplural: 'Cases',\n\t}\n\n\tconst eventEntity: EntityModel = {\n\t\tid: id(),\n\t\tkey: 'event',\n\t\tname: 'Event',\n\t\tplural: 'Events',\n\t}\n\n\tdb.entities.save(userEntity)\n\tdb.entities.save(caseEntity)\n\tdb.entities.save(eventEntity)\n\n\t// META TYPES\n\n\t// CASE\n\n\tconst caseFields: FieldModel[] = [\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'case-number',\n\t\t\tname: 'Case Number',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'type',\n\t\t\tname: 'Type',\n\t\t\ttype: 'option',\n\t\t\toptions: ['Review', 'Mediation', 'Hybrid'],\n\t\t\tdefaultValue: 'Review',\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'claim-number',\n\t\t\tname: 'Claim Number',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'complexity',\n\t\t\tname: 'Complexity',\n\t\t\ttype: 'option',\n\t\t\toptions: ['Standard', 'Complex'],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'closed-date',\n\t\t\tname: 'Closed Date',\n\t\t\ttype: 'date',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'status',\n\t\t\tname: 'Status',\n\t\t\ttype: 'option',\n\t\t\toptions: ['Pending', 'Open', 'Closed'],\n\t\t},\n\t]\n\n\tcaseFields.forEach(db.fields.save)\n\n\t// EVENTS\n\n\tconst eventFields: FieldModel[] = [\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: eventEntity.id,\n\t\t\tkey: 'start-date',\n\t\t\tname: 'Start Date',\n\t\t\ttype: 'date',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: eventEntity.id,\n\t\t\tkey: 'end-date',\n\t\t\tname: 'End Date',\n\t\t\ttype: 'date',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: eventEntity.id,\n\t\t\tkey: 'type',\n\t\t\tname: 'Type',\n\t\t\ttype: 'option',\n\t\t\toptions: ['Review', 'Mediation', 'CMC'],\n\t\t\tdefaultValue: 'CMC',\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: eventEntity.id,\n\t\t\tkey: 'decision-date',\n\t\t\tname: 'Decision Date',\n\t\t\ttype: 'date',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: eventEntity.id,\n\t\t\tkey: 'postponed',\n\t\t\tname: 'Postponed',\n\t\t\ttype: 'boolean',\n\t\t\toptions: [],\n\t\t},\n\t]\n\n\teventFields.forEach(db.fields.save)\n\n\t// USERS\n\n\tconst userFields: FieldModel[] = [\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: userEntity.id,\n\t\t\tkey: 'first-name',\n\t\t\tname: 'First Name',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: userEntity.id,\n\t\t\tkey: 'last-name',\n\t\t\tname: 'Last Name',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: userEntity.id,\n\t\t\tkey: 'email',\n\t\t\tname: 'Email',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: userEntity.id,\n\t\t\tkey: 'phone',\n\t\t\tname: 'Phone',\n\t\t\ttype: 'string',\n\t\t\toptions: [],\n\t\t},\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: userEntity.id,\n\t\t\tkey: 'active',\n\t\t\tname: 'Active',\n\t\t\ttype: 'boolean',\n\t\t\toptions: [],\n\t\t\tdefaultValue: 'true',\n\t\t},\n\t]\n\n\tuserFields.forEach(db.fields.save)\n\n\t// ACTIONS\n\n\t// CASE\n\n\tconst caseActions: ActionModel[] = [\n\t\t{\n\t\t\tid: id(),\n\t\t\tentityId: caseEntity.id,\n\t\t\tkey: 'close-case',\n\t\t\tname: 'Close Case',\n\t\t\tchanges: [],\n\t\t},\n\t]\n\n\tcaseActions.forEach(db.actions.save)\n\n\t// EVENTS\n\n\tconst eventActions: ActionModel[] = []\n\n\teventActions.forEach(db.actions.save)\n\n\t// CONNECTIONS\n\n\tdb.relations.save({\n\t\tid: id(),\n\t\tkey: 'events',\n\t\tname: 'Events',\n\t\tentityId: caseEntity.id,\n\t\trelatedId: eventEntity.id,\n\t\ttype: 'one-to-many',\n\t})\n\n\tdb.relations.save({\n\t\tid: id(),\n\t\tkey: 'attendees',\n\t\tname: 'Attendees',\n\t\tentityId: eventEntity.id,\n\t\trelatedId: userEntity.id,\n\t\ttype: 'one-to-many',\n\t})\n\n\tdb.relations.save({\n\t\tid: id(),\n\t\tkey: 'applicant',\n\t\tname: 'Applicant',\n\t\tentityId: userEntity.id,\n\t\trelatedId: caseEntity.id,\n\t\ttype: 'one-to-many',\n\t})\n\n\t// NOTIFICATIONS\n\n\tdb.notifications.save({\n\t\tid: id(),\n\t\tname: 'Event Reminder 2 days',\n\t\tfocus: eventEntity.id,\n\t\tenabled: true,\n\t\ttriggerType: 'date',\n\t\ttriggerRepeat: 2,\n\t\ttriggerEvery: '',\n\t\ttriggerYearIn: '',\n\t\ttriggerMonthOn: '',\n\t\ttriggerWeekOn: '',\n\t\ttriggerDayAt: '',\n\t\ttriggerAction: '',\n\t\tobeyTriggerTiming: true,\n\t\ttriggerTimingType: 'before',\n\t\ttriggerTiming: 'day',\n\t\ttriggerDate: db.fields.find((x) => x.entityId === eventEntity.id && x.key === 'start-date')?.id || '',\n\t\truleGroups: [\n\t\t\t{\n\t\t\t\trules: [\n\t\t\t\t\t{\n\t\t\t\t\t\tentity: eventEntity.id,\n\t\t\t\t\t\tfield: db.fields.find((x) => x.entityId === eventEntity.id && x.key === 'postponed')?.id || '',\n\t\t\t\t\t\toperator: 'false',\n\t\t\t\t\t\tvalue: '',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t\tsubject: 'Upcoming Conference',\n\t\tcontent:\n\t\t\t'<h1>Hello {{recipient-first-name}}</h1><p><br></p><p>You have a {{event-type}} coming up on {{event-start-date}}</p>',\n\t})\n\n\tdb.templates.save({\n\t\tid: id(),\n\t\tname: 'Event Reminder 2 days',\n\t\tcontent:\n\t\t\t'<h1>Hello {{recipient-first-name}}</h1><p><br></p><p>You have a {{event-type}} coming up on {{event-start-date}}</p>',\n\t})\n\n\tconst adminRole = db.roles.save({\n\t\tid: id(),\n\t\tname: 'Administrator',\n\t})\n\n\tconst caseManagerRole = db.roles.save({\n\t\tid: id(),\n\t\tname: 'Case Manager',\n\t})\n\n\tconst reviewerRole = db.roles.save({\n\t\tid: id(),\n\t\tname: 'Reviewer',\n\t})\n\n\tconst applicantRole = db.roles.save({\n\t\tid: id(),\n\t\tname: 'Applicant',\n\t})\n\n\t;([adminRole, caseManagerRole, reviewerRole] as RoleModel[]).forEach((role) => {\n\t\tdb.entities.all().forEach((entity) => {\n\t\t\tdb.entityPermissions.save({\n\t\t\t\tid: id(),\n\t\t\t\tentityId: entity.id,\n\t\t\t\troleId: role.id,\n\t\t\t\tview: true,\n\t\t\t\tmodify: true,\n\t\t\t\tremove: true,\n\t\t\t})\n\n\t\t\tdb.fields\n\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t.forEach((entityField) => {\n\t\t\t\t\tdb.fieldPermissions.save({\n\t\t\t\t\t\tid: id(),\n\t\t\t\t\t\tfieldId: entityField.id,\n\t\t\t\t\t\troleId: role.id,\n\t\t\t\t\t\tview: true,\n\t\t\t\t\t\tmodify: true,\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\tdb.actions\n\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t.forEach((entityAction) => {\n\t\t\t\t\tdb.actionPermissions.save({\n\t\t\t\t\t\tid: id(),\n\t\t\t\t\t\tactionId: entityAction.id,\n\t\t\t\t\t\troleId: role.id,\n\t\t\t\t\t\tperform: true,\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\tdb.relations\n\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t.forEach((relation) => {\n\t\t\t\t\tdb.relationPermissions.save({\n\t\t\t\t\t\tid: id(),\n\t\t\t\t\t\trelationId: relation.id,\n\t\t\t\t\t\troleId: role.id,\n\t\t\t\t\t\tview: true,\n\t\t\t\t\t\tmodify: true,\n\t\t\t\t\t\tremove: true,\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t})\n\t})\n\n\tdb.entities.all().forEach((entityType) => {\n\t\tdb.entityPermissions.save({\n\t\t\tid: id(),\n\t\t\tentityId: entityType.id,\n\t\t\troleId: applicantRole.id,\n\t\t\tview: true,\n\t\t\tmodify: false,\n\t\t\tremove: false,\n\t\t})\n\n\t\tdb.fields\n\t\t\t.all((x) => x.entityId === entityType.id)\n\t\t\t.forEach((entityField) => {\n\t\t\t\tdb.fieldPermissions.save({\n\t\t\t\t\tid: id(),\n\t\t\t\t\tfieldId: entityField.id,\n\t\t\t\t\troleId: applicantRole.id,\n\t\t\t\t\tview: true,\n\t\t\t\t\tmodify: false,\n\t\t\t\t})\n\t\t\t})\n\n\t\tdb.actions\n\t\t\t.all((x) => x.entityId === entityType.id)\n\t\t\t.forEach((entityAction) => {\n\t\t\t\tdb.actionPermissions.save({\n\t\t\t\t\tid: id(),\n\t\t\t\t\tactionId: entityAction.id,\n\t\t\t\t\troleId: applicantRole.id,\n\t\t\t\t\tperform: false,\n\t\t\t\t})\n\t\t\t})\n\n\t\tdb.relations\n\t\t\t.all((x) => x.entityId === entityType.id)\n\t\t\t.forEach((relation) => {\n\t\t\t\tdb.relationPermissions.save({\n\t\t\t\t\tid: id(),\n\t\t\t\t\trelationId: relation.id,\n\t\t\t\t\troleId: applicantRole.id,\n\t\t\t\t\tview: true,\n\t\t\t\t\tmodify: false,\n\t\t\t\t\tremove: false,\n\t\t\t\t})\n\t\t\t})\n\t})\n\n\t// BOB\n\n\tlet bob = db.units.save({\n\t\tentityId: userEntity.id,\n\t})\n\n\t;[\n\t\t{ key: 'first-name', value: 'Bob' },\n\t\t{ key: 'last-name', value: 'Bobson' },\n\t\t{ key: 'email', value: 'bob@example.com' },\n\t\t{ key: 'phone', value: '1234' },\n\t\t{ key: 'active', value: 'true' },\n\t].forEach(({ key, value }) => {\n\t\tdb.values.save({\n\t\t\tunitId: bob.id,\n\t\t\tfieldId: db.fields.find((x) => x.entityId === userEntity.id && x.key === key)?.id || '-',\n\t\t\tvalue,\n\t\t\tcreated: String(new Date().valueOf()),\n\t\t})\n\t})\n\n\t// Plans\n\n\t// db.plans.save({\n\t// \tid: id(),\n\t// \tentityId: userEntity.id,\n\t// \tkey: 'view',\n\t// \tname: 'View User',\n\t// \tstructure: `{\n\t// \t\t\t\"items\":[\n\t// \t\t\t\t{\"id\":\"1bb92a22-baac-4ac2-a053-cefe929ed8de\",\"type\":\"Card\",\"items\":[\n\t// \t\t\t\t\t{\"id\":\"2b928e3e-8d01-405a-b586-cd8a4a2cb984\",\"type\":\"Columns\",\"items\":\n\t// \t\t\t\t\t\t[\n\t// \t\t\t\t\t\t\t[\n\t// \t\t\t\t\t\t\t\t{\"id\":\"09970251-b772-4ac4-aad2-bd8b6fac69bc\",\"type\":\"Field\",\"fieldId\":\"${\n\t// \t\t\t\t\t\t\t\t\tuserFields.find((x) => x.key === 'first-name')?.id\n\t// \t\t\t\t\t\t\t\t}\"},\n\t// \t\t\t\t\t\t\t\t{\"id\":\"f29d6681-2920-420d-86c8-af5eac3aec03\",\"type\":\"Field\",\"fieldId\":\"${\n\t// \t\t\t\t\t\t\t\t\tuserFields.find((x) => x.key === 'email')?.id\n\t// \t\t\t\t\t\t\t\t}\"},\n\t// \t\t\t\t\t\t\t\t{\"id\":\"c21369ba-2733-46d4-a655-e054e18bb434\",\"type\":\"Field\",\"fieldId\":\"${\n\t// \t\t\t\t\t\t\t\t\tuserFields.find((x) => x.key === 'active')?.id\n\t// \t\t\t\t\t\t\t\t}\"}\n\t// \t\t\t\t\t\t\t],\n\t// \t\t\t\t\t\t\t[\n\t// \t\t\t\t\t\t\t\t{\"id\":\"7a5002b4-146a-4a8e-b7e5-1305bf2bc86f\",\"type\":\"Field\",\"fieldId\":\"${\n\t// \t\t\t\t\t\t\t\t\tuserFields.find((x) => x.key === 'last-name')?.id\n\t// \t\t\t\t\t\t\t\t}\"},\n\t// \t\t\t\t\t\t\t\t{\"id\":\"76cb9ca3-0b38-4036-bb6e-21726d904e69\",\"type\":\"Field\",\"fieldId\":\"${\n\t// \t\t\t\t\t\t\t\t\tuserFields.find((x) => x.key === 'phone')?.id\n\t// \t\t\t\t\t\t\t\t}\"}\n\t// \t\t\t\t\t\t\t]\n\t// \t\t\t\t\t\t],\n\t// \t\t\t\t\t\t\"format\":\"1:1\"\n\t// \t\t\t\t\t}\n\t// \t\t\t\t],\n\t// \t\t\t\t\"title\":\"Details\"\n\t// \t\t\t}]\n\t// \t\t}`,\n\t// })\n}\n\nif (!localStorage.getItem('data')) {\n\tseed()\n}\n","import { FC } from 'react'\nimport Card from '@primer/components/Card'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport { RouteComponentProps } from '@reach/router'\nimport Actions from '@primer/components/Actions'\nimport { clear } from 'db'\nimport { seed } from 'db/seed'\nimport Stack from '@primer/components/Stack'\n\nconst Home: FC<RouteComponentProps> = () => {\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Home\" />\n\n\t\t\t<PageContent>\n\t\t\t\t<Card>\n\t\t\t\t\t<Stack>\n\t\t\t\t\t\t<div className=\"rounded-md bg-red-400 text-red-800 dark:bg-red-500 dark:text-red-300 bg-opacity-25 dark:bg-opacity-25 p-4\">\n\t\t\t\t\t\t\t<span className=\"font-medium\">Note:</span> Modules haven't been properly figured out yet, so\n\t\t\t\t\t\t\tthat stuff is only a visual mockup\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"rounded-md bg-primary-400 text-primary-800 dark:bg-primary-500 dark:text-primary-300 bg-opacity-25 dark:bg-opacity-25 p-4 space-y-3\">\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\tFeel free to play around with the forms, create stuff, edit stuff, delete stuff. You can\n\t\t\t\t\t\t\t\tcome back to this page to reset the data.\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>Any changes you make are contained within your browser, so nothing is real.</p>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Clear Database',\n\t\t\t\t\t\t\t\t\tonClick: () => clear(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Reset Database',\n\t\t\t\t\t\t\t\t\tonClick: () => seed(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Stack>\n\t\t\t\t</Card>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default Home\n","export default __webpack_public_path__ + \"static/media/undraw_not_found_60pq.faf05e44.svg\";","import { FC } from 'react'\nimport { RouteComponentProps } from '@reach/router'\nimport illustration from 'assets/img/undraw_not_found_60pq.svg'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\n\nconst NotFound: FC<RouteComponentProps> = () => {\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Not Found\" />\n\n\t\t\t<PageContent>\n\t\t\t\t<div className=\"p-4\">\n\t\t\t\t\t<img src={illustration} alt=\"not found\" width=\"500\" className=\"mx-auto\" />\n\t\t\t\t</div>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default NotFound\n","import { FC, useState } from 'react'\nimport { CardWrapper } from '@primer/components/Card'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport { Link, RouteComponentProps } from '@reach/router'\nimport db from 'db'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { entityResource, UnitModel } from 'db/types'\nimport { AdjustmentsIcon, CheckIcon, DotsHorizontalIcon, PencilIcon, TrashIcon } from '@heroicons/react/outline'\nimport { confirm } from '@primer/alerts'\nimport Actions from '@primer/components/Actions'\n\nconst Units: FC<RouteComponentProps<{ entityId: string }>> = ({ entityId = '' }) => {\n\tconst entity = entityResource(entityId)\n\n\tconst fields = entity?.fields\n\n\tconst [visibleFields, setVisibleFields] = useState(fields)\n\n\tconst schema: TableSchema<UnitModel> = {\n\t\tcols:\n\t\t\tfields\n\t\t\t\t?.filter((x) => visibleFields?.includes(x))\n\t\t\t\t.map((field, i) => ({\n\t\t\t\t\ttitle: field.name,\n\t\t\t\t\tvalue: (x) => {\n\t\t\t\t\t\tlet val = field.value(x.id)?.formatted\n\t\t\t\t\t\treturn i === 0 ? (\n\t\t\t\t\t\t\t<Link to={x.id} className=\"anchor\">\n\t\t\t\t\t\t\t\t{val || '-'}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tval || '-'\n\t\t\t\t\t\t)\n\t\t\t\t\t},\n\t\t\t\t})) || [],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: `Edit ${entity?.name}`,\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/${entity?.key}/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: `Delete ${entity?.name}`,\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.units.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\ttitle={entity?.plural || entity?.name || '-'}\n\t\t\t\tactions={[\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: `Create ${entity?.name}`,\n\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\tto: `/${entity?.key}/create`,\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<CardWrapper className=\"overflow-hidden\">\n\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t<div className=\"absolute top-0 right-0 h-[42px] flex items-center mr-1\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\ticon: <AdjustmentsIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\t\tintent: 'menu',\n\t\t\t\t\t\t\t\t\tactions:\n\t\t\t\t\t\t\t\t\t\tfields?.map((x) => ({\n\t\t\t\t\t\t\t\t\t\t\ttitle: x.name,\n\t\t\t\t\t\t\t\t\t\t\ticon: visibleFields?.includes(x) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<CheckIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\ticonSide: 'left',\n\t\t\t\t\t\t\t\t\t\t\tdisableDismiss: true,\n\t\t\t\t\t\t\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\t\t\t\t\t\t\tsetVisibleFields((f) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\tvisibleFields?.includes(x)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? f?.filter((y) => y !== x) || []\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: [...(f || []), x]\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t})) || [],\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\tschema={schema}\n\t\t\t\t\t\t\titems={db.units.all((x) => x.entityId === entity?.id)}\n\t\t\t\t\t\t\tclassName=\"-my-px\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</CardWrapper>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default Units\n","import { EntityResource } from 'db/types'\nimport { createContext } from 'react'\nimport { WidgetType } from '../Widgets/types'\n\nexport type Path = (string | number)[]\n\nexport interface PageBuilderContextType {\n\tentity: EntityResource | undefined | null\n\titemList: { items: Widget[] }\n\taddItem: (path: Path, item: Widget) => void\n\tremoveItem: (path: Path) => void\n\tupdateItem: (path: Path, newValue: Widget) => void\n}\n\nexport const PageBuilderContext = createContext<PageBuilderContextType>({\n\tentity: undefined,\n\titemList: { items: [] },\n\taddItem: () => {},\n\tremoveItem: () => {},\n\tupdateItem: () => {},\n})\n\nexport const PageBuilderProvider = PageBuilderContext.Provider\n\nexport interface PageRendererContextType {\n\tunitId: string\n\titemList: { items: Widget[] }\n}\n\nexport const PageRendererContext = createContext<PageRendererContextType>({\n\tunitId: '',\n\titemList: { items: [] },\n})\n\nexport const PageRendererProvider = PageRendererContext.Provider\n\nexport interface Widget {\n\tid: string\n\ttype: WidgetType\n\tdata: unknown\n}\nexport const isWidget = (x: any): x is Widget => typeof x.id === 'string'\n\nexport interface Tool<T = Widget> {\n\tname: string\n\ttype: string\n\tdescription: string\n\tcreate: () => T\n}\nexport const isTool = (x: any): x is Tool => typeof x.create === 'function'\n","export type Path = (string | number)[]\n\nexport interface Widget {\n\tid: string\n\ttype: string\n\tdata: unknown\n}\nexport const isWidget = (x: any): x is Widget => typeof x.id === 'string'\n\nexport interface Tool<T = Widget> {\n\tname: string\n\ttype: string\n\tdescription: string\n\tcreate: () => T\n}\nexport const isTool = (x: any): x is Tool => typeof x.create === 'function'\n\nexport const CardType = 'Card'\nexport const WellType = 'Well'\nexport const PageTitleType = 'PageTitle'\nexport const ColumnsType = 'Columns'\nexport const FieldType = 'Field'\nexport const DividerType = 'Divider'\nexport const SectionType = 'Section'\n\nexport type WidgetType =\n\t| typeof CardType\n\t| typeof WellType\n\t| typeof PageTitleType\n\t| typeof ColumnsType\n\t| typeof FieldType\n\t| typeof DividerType\n\t| typeof SectionType\n","import { FC, Component, ElementType, Suspense } from 'react'\nimport DefaultLoader from '@primer/components/Loader'\nimport * as Sentry from '@sentry/react'\nimport { isNotNone } from '@primer/types'\n\ninterface ErrorBoundaryProps {\n\trender: ElementType\n}\n\ninterface ErrorBoundaryState {\n\terror?: Error\n}\n\nexport class ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n\tstatic getDerivedStateFromError(error: Error) {\n\t\treturn { error }\n\t}\n\n\tcomponentDidCatch(error: Error) {\n\t\t// You can also log the error to an error reporting service\n\t\t// logErrorToMyService(error, info)\n\t\tSentry.captureException(error)\n\t\tconsole.dir(error)\n\t}\n\n\trender() {\n\t\tif (isNotNone(this.state?.error)) {\n\t\t\treturn <this.props.render error={this.state.error} />\n\t\t}\n\n\t\treturn this.props.children\n\t}\n}\n\ninterface DefaultErrorProps {\n\terror: Error\n}\n\nexport const defaultError: FC<DefaultErrorProps> = ({ error }) => (\n\t<div className=\"alert alert-danger\" role=\"alert\">\n\t\t<h4 className=\"alert-heading\">Something went wrong</h4>\n\t\t<hr />\n\t\t{error.message && <p className=\"m-0\">{error.message}</p>}\n\t</div>\n)\n\nconst withSuspense =\n\t(Component: ElementType, { loader = <DefaultLoader />, error = defaultError } = {}) =>\n\t(props: any) => {\n\t\treturn (\n\t\t\t<ErrorBoundary render={error}>\n\t\t\t\t<Suspense fallback={loader}>\n\t\t\t\t\t<Component {...props} />\n\t\t\t\t</Suspense>\n\t\t\t</ErrorBoundary>\n\t\t)\n\t}\n\nconst Suspender = withSuspense(({ render }) => render)\n\nexport default Suspender\n","import { FC, ReactNode } from 'react'\nimport { slideout } from '@primer/alerts'\nimport Suspender from '@primer/components/Suspender'\nimport Actions from '@primer/components/Actions'\nimport { ActionType, SlideoutResolveFn } from '@primer/types'\nimport { SizeValue } from '@primer/alerts/Slideout'\nimport { XIcon } from '@heroicons/react/outline'\nimport clsx, { ClassValue } from 'clsx'\n\ntype CloseFn = () => void\n\ninterface OpenSlideoutProps<T> {\n\trender: (close: SlideoutResolveFn<boolean | T>) => ReactNode\n\tsize?: SizeValue\n\tmode?: 'dark' | ''\n}\n\nasync function openSlideout<T>({ render, size = 'md', mode = '' }: OpenSlideoutProps<T>) {\n\treturn await slideout<T>({\n\t\tsize,\n\t\tmode,\n\t\tchildren: (close) => <SlideoutInner render={render} close={close} />,\n\t})\n}\n\ninterface SlideoutInnerProps {\n\trender: (x: CloseFn) => ReactNode\n\tclose: CloseFn\n}\n\nconst SlideoutInner: FC<SlideoutInnerProps> = ({ render, close }) => {\n\treturn (\n\t\t<div className=\"h-full w-full relative\">\n\t\t\t<div className=\"absolute top-0 left-0 -mx-12 mt-2\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticon: <XIcon className=\"w-5 h-5 -mx-2 text-white\" />,\n\t\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"h-full divide-y divide-gray-200 dark:divide-gray-600 flex flex-col bg-white dark:bg-gray-700 shadow-xl\">\n\t\t\t\t<div className=\"flex-1 h-0 flex flex-col\">\n\t\t\t\t\t<Suspender render={render(close)} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\ninterface SlideoutHeaderProps {\n\ttitle: ReactNode\n\tsubtitle?: ReactNode\n\tactions?: ActionType[]\n}\n\nexport const SlideoutHeader: FC<SlideoutHeaderProps> = ({ title, subtitle, actions }) => {\n\treturn (\n\t\t<div className=\"py-6 px-4 bg-primary-500 dark:bg-primary-600 sm:px-6 flex-shrink-0\">\n\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t<div className=\"text-lg font-medium text-white antialiased\">{title}</div>\n\t\t\t\t<div className=\"ml-3 h-7 flex items-center\">{actions && <Actions actions={actions} />}</div>\n\t\t\t</div>\n\t\t\t{subtitle && (\n\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t<div className=\"text-sm text-white opacity-75 antialiased\">{subtitle}</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\ninterface SlideoutContentProps {\n\tclassName?: ClassValue\n}\n\nexport const SlideoutContent: FC<SlideoutContentProps> = ({ className, children }) => {\n\treturn <div className={clsx('flex-1 flex flex-col justify-between overflow-y-auto', className)}>{children}</div>\n}\n\nexport default openSlideout\n","import clsx, { ClassValue } from 'clsx'\nimport { FC } from 'react'\n\ninterface TableFrameProps {\n\tclassName?: ClassValue\n}\n\nconst TableFrame: FC<TableFrameProps> = ({ children, className }) => {\n\treturn (\n\t\t<div className={clsx('border border-gray-200 dark:border-gray-600 rounded-md overflow-hidden', className)}>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\nexport default TableFrame\n","import { FC } from 'react'\n\ninterface FormLabelProps {\n\tonClick?: () => void\n\tisOptional?: boolean\n}\n\nconst FormLabel: FC<FormLabelProps> = ({ children, isOptional, onClick }) => {\n\treturn (\n\t\t<div\n\t\t\tclassName=\"block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 cursor-default\"\n\t\t\tonClick={onClick}\n\t\t>\n\t\t\t{children && (\n\t\t\t\t<>\n\t\t\t\t\t{children}{' '}\n\t\t\t\t\t{isOptional && (\n\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport default FormLabel\n","import { FC } from 'react'\nimport { TrashIcon, CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { CardWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport TableFrame from '@primer/components/TableFrame'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\nimport FormLabel from '@primer/components/Form/FormLabel'\n\ninterface OpenEditProps {\n\titem: CardWidget\n\tpath: Path\n\tremoveItem: (path: Path) => void\n\tupdateItem: (path: Path, newValue: CardWidget) => void\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = CardWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, removeItem, updateItem, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tupdateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput name=\"data.title\" label=\"Title\" className=\"flex-1\" autoFocus />\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tremoveItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { FC } from 'react'\nimport Actions from './Actions'\nimport { ActionType } from '@primer/types'\nimport clsx, { ClassValue } from 'clsx'\nimport ButtonSpacer from './ButtonSpacer'\n\ninterface CardHeaderProps {\n\ttitle: string\n\tsubtitle?: string\n\tactions?: ActionType[]\n\tclassName?: ClassValue\n}\n\nconst CardHeader: FC<CardHeaderProps> = ({ title, subtitle, actions, className }) => {\n\treturn (\n\t\t<div className=\"px-4 py-5 sm:px-6 border-b border-gray-200 dark:border-gray-600\">\n\t\t\t<div\n\t\t\t\tclassName={clsx(\n\t\t\t\t\t'flex flex-col sm:flex-row justify-between items-start sm:items-center flex-wrap sm:flex-nowrap space-y-4 sm:space-y-0',\n\t\t\t\t\tclassName\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<div>\n\t\t\t\t\t<h3 className=\"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100\">{title}</h3>\n\t\t\t\t\t{subtitle && <p className=\"mt-1 text-sm leading-5 text-gray-500 dark:text-gray-400\">{subtitle}</p>}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"flex-shrink-0 my-0 sm:-my-2\">\n\t\t\t\t\t{actions && actions.length > 0 ? (\n\t\t\t\t\t\t<Actions actions={actions} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"hidden sm:block\">\n\t\t\t\t\t\t\t<ButtonSpacer />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default CardHeader\n","export type Box = { top: number; right: number; bottom: number; left: number }\nexport type Point = { x: number; y: number }\n\nexport const inside = (point: Point, box: Box) => {\n\treturn point.x > box.left && point.x < box.right && point.y > box.top && point.y < box.bottom\n}\n\nexport const distance_aux = (p: number, lower: number, upper: number) => {\n\tif (p < lower) return lower - p\n\tif (p > upper) return p - upper\n\treturn 0\n}\n\nexport const distance = (point: Point, box: Box) => {\n\tlet dx = distance_aux(point.x, box.left, box.right)\n\tlet dy = distance_aux(point.y, box.top, box.bottom)\n\tif (inside(point, box)) return Math.min(dx, dy)\n\t// or 0 in case of distance from the area\n\telse return Math.sqrt(dx * dx + dy * dy)\n}\n","import { useState, useEffect, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { useDrop } from 'react-dnd'\nimport { distance as calcDistance } from './utils'\n\ninterface DropperProps<T> {\n\taccept: string | string[]\n\tonDrop: (x: T) => void\n\tdistance?: number\n\tclassName?: ClassValue | ((x: { isOver: boolean; isClose: boolean; canDrop: boolean }) => ClassValue)\n\tchildren: ReactNode | ((x: { isOver: boolean; isClose: boolean; canDrop: boolean }) => ReactNode)\n}\n\nfunction Dropper<T>({ accept, onDrop, distance = 20, className, children }: DropperProps<T>) {\n\tconst [{ isOver, canDrop }, dropRef] = useDrop({\n\t\taccept,\n\t\tdrop: onDrop,\n\t\tcollect: (monitor) => ({\n\t\t\tisOver: !!monitor.isOver(),\n\t\t\tcanDrop: !!monitor.canDrop(),\n\t\t}),\n\t})\n\n\tconst [x, setX] = useState(0)\n\tconst [y, setY] = useState(0)\n\n\tuseEffect(() => {\n\t\tconst handleMove = (e: MouseEvent) => {\n\t\t\tsetX(e.pageX)\n\t\t\tsetY(e.pageY)\n\t\t}\n\t\twindow.addEventListener('mousemove', handleMove)\n\t\treturn () => {\n\t\t\twindow.removeEventListener('mousemove', handleMove)\n\t\t}\n\t}, [])\n\n\tuseEffect(() => {\n\t\tconst handleMove = (e: MouseEvent) => {\n\t\t\te = e || window.event\n\t\t\tsetX(e.pageX)\n\t\t\tsetY(e.pageY)\n\t\t}\n\t\twindow.addEventListener('dragover', handleMove)\n\t\treturn () => {\n\t\t\twindow.removeEventListener('dragover', handleMove)\n\t\t}\n\t}, [])\n\n\tlet [isClose, setClose] = useState(false)\n\n\treturn (\n\t\t<div\n\t\t\tref={dropRef}\n\t\t\tclassName={clsx(\n\t\t\t\t'relative',\n\t\t\t\ttypeof className === 'function' ? className({ isOver, isClose, canDrop }) : className\n\t\t\t)}\n\t\t>\n\t\t\t<div\n\t\t\t\tref={(element: HTMLDivElement | null) => {\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\tlet d = calcDistance({ x, y }, element.getBoundingClientRect())\n\t\t\t\t\t\tlet withinDistance = d < distance\n\t\t\t\t\t\tif (withinDistance !== isClose) {\n\t\t\t\t\t\t\tsetClose(withinDistance)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tclassName=\"w-full h-full\"\n\t\t\t>\n\t\t\t\t{typeof children === 'function' ? children({ isOver, isClose, canDrop }) : children}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Dropper\n","import { FC, useContext } from 'react'\nimport clsx from 'clsx'\nimport Dropper from 'components/Builder/Dropper'\nimport { PageBuilderContext, Path } from '../utils'\nimport { isTool, Tool, Widget } from '../utils'\n\ntype ItemAndPath = { item: Widget; path: Path }\n\nlet isItemAndPath = (x: any): x is ItemAndPath => !!x.path\n\ninterface DropTargetProps {\n\tpath: Path\n\taccept: string | string[]\n\tisFirst?: boolean\n\tisLast?: boolean\n}\n\nconst DropTarget: FC<DropTargetProps> = ({ path, accept, isFirst = false, isLast = false }) => {\n\tconst { addItem, removeItem } = useContext(PageBuilderContext)\n\n\treturn (\n\t\t<Dropper\n\t\t\taccept={accept}\n\t\t\tonDrop={(item: Tool | Widget | ItemAndPath) => {\n\t\t\t\tif (isItemAndPath(item)) {\n\t\t\t\t\tlet { item: existingItem, path: oldPath } = item\n\t\t\t\t\taddItem(path, existingItem)\n\t\t\t\t\tremoveItem(oldPath)\n\t\t\t\t} else if (isTool(item)) {\n\t\t\t\t\taddItem(path, item.create())\n\t\t\t\t} else {\n\t\t\t\t\taddItem(path, item)\n\t\t\t\t}\n\t\t\t}}\n\t\t\tdistance={20}\n\t\t>\n\t\t\t{({ canDrop, isOver, isClose }) =>\n\t\t\t\t(canDrop && isClose) || isLast ? (\n\t\t\t\t\t<div className={clsx('p-1')}>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t'px-6 h-10 flex items-center justify-center rounded-lg border-2 border-dashed',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t'my-0 h-full': isFirst && isLast,\n\t\t\t\t\t\t\t\t\t'mb-6': isFirst && !isLast,\n\t\t\t\t\t\t\t\t\t'mt-6': isLast && !isFirst,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t'border-indigo-400 bg-indigo-50': isOver,\n\t\t\t\t\t\t\t\t\t'border-gray-900 border-opacity-10 bg-white bg-opacity-50': !isOver,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className={clsx(!isFirst && !isLast && 'h-4')} />\n\t\t\t\t)\n\t\t\t}\n\t\t</Dropper>\n\t)\n}\n\nexport default DropTarget\n","import { MouseEventHandler, useCallback, useState } from 'react'\n\nconst useHoverable = (): [\n\tboolean,\n\t{\n\t\tonMouseOver: MouseEventHandler<HTMLDivElement>\n\t\tonMouseOut: MouseEventHandler<HTMLDivElement>\n\t}\n] => {\n\tconst [isHovered, setHovered] = useState(false)\n\n\tconst onMouseOver = useCallback((e) => {\n\t\te.stopPropagation()\n\t\tsetHovered(true)\n\t}, [])\n\n\tconst onMouseOut = useCallback((e) => {\n\t\te.stopPropagation()\n\t\tsetHovered(false)\n\t}, [])\n\n\treturn [isHovered, { onMouseOver, onMouseOut }]\n}\n\nexport default useHoverable\n","import { FC, Fragment, useContext } from 'react'\nimport { CardContent, CardWrapper } from '@primer/components/Card'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { CardWidget } from '.'\nimport CardHeader from '@primer/components/CardHeader'\nimport DropTarget from 'pages/PageBuilder/components/DropTarget'\nimport { BuildComp } from '../index'\nimport { ColumnsType, FieldType, WellType, SectionType } from '../types'\nimport clsx from 'clsx'\nimport openEdit from './Edit'\nimport useHoverable from 'hooks/useHoverable'\n\nconst Accepts: string[] = [WellType, ColumnsType, FieldType, SectionType]\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst { itemList, removeItem, updateItem } = useContext(PageBuilderContext)\n\tlet item: CardWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<CardWrapper\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, removeItem, updateItem })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx('cursor-pointer transition-all duration-100', isHovered && 'ring-4 ring-primary-500')}\n\t\t>\n\t\t\t{item.data.title && <CardHeader title={item.data.title} />}\n\t\t\t<CardContent>\n\t\t\t\t{item.data.items.map((x, i) => (\n\t\t\t\t\t<Fragment key={x.id}>\n\t\t\t\t\t\t<DropTarget path={[...path, 'data', 'items', i]} isFirst={i === 0} accept={Accepts} />\n\t\t\t\t\t\t<BuildComp path={[...path, 'data', 'items', i]} />\n\t\t\t\t\t</Fragment>\n\t\t\t\t))}\n\t\t\t\t<DropTarget\n\t\t\t\t\tpath={[...path, 'data', 'items', item.data.items.length]}\n\t\t\t\t\tisFirst={item.data.items.length === 0}\n\t\t\t\t\tisLast\n\t\t\t\t\taccept={Accepts}\n\t\t\t\t/>\n\t\t\t</CardContent>\n\t\t</CardWrapper>\n\t)\n}\n\nexport default Build\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { CardType } from '../types'\nimport openEdit from './Edit'\n\nimport Build from './Build'\nimport View from './View'\n\nexport interface CardWidget extends Widget {\n\ttype: typeof CardType\n\tdata: {\n\t\ttitle?: string\n\t\titems: Widget[]\n\t}\n}\n\nexport const isCardWidget = (x: any): x is CardWidget => x.type === CardType\n\nexport const CardTool: Tool<CardWidget> = {\n\tname: 'Card',\n\ttype: CardType,\n\tdescription: 'A box used for containing content',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: CardType,\n\t\tdata: {\n\t\t\ttitle: '',\n\t\t\titems: [],\n\t\t},\n\t}),\n}\n\nexport const CardBuild = Build\nexport const CardView = View\nexport const openEditCard = openEdit\n","import { CardWrapper } from '@primer/components/Card'\nimport CardHeader from '@primer/components/CardHeader'\nimport Stack from '@primer/components/Stack'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { FC, useContext } from 'react'\nimport { CardWidget } from '.'\nimport { ViewComp } from '..'\nimport { Path } from '../types'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList } = useContext(PageRendererContext)\n\tlet item: CardWidget = view(lensPath(path), itemList)\n\n\tconsole.log(item)\n\n\treturn (\n\t\t<CardWrapper>\n\t\t\t{item.data.title && <CardHeader title={item.data.title} />}\n\t\t\t<div className=\"py-6\">\n\t\t\t\t<Stack>\n\t\t\t\t\t{item.data.items.map((_, i) => (\n\t\t\t\t\t\t<ViewComp key={i} path={[...path, 'data', 'items', i]} />\n\t\t\t\t\t))}\n\t\t\t\t</Stack>\n\t\t\t</div>\n\t\t</CardWrapper>\n\t)\n}\n\nexport default View\n","import clsx, { ClassValue } from 'clsx'\nimport { FC, MouseEventHandler } from 'react'\n\ninterface WellProps {\n\tclassName?: ClassValue\n\tonClick?: MouseEventHandler<HTMLDivElement>\n\tonMouseOver?: MouseEventHandler<HTMLDivElement>\n\tonMouseOut?: MouseEventHandler<HTMLDivElement>\n}\n\nconst Well: FC<WellProps> = ({ children, className, onClick, onMouseOver, onMouseOut }) => {\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx(\n\t\t\t\t'p-4 bg-gray-100 dark:bg-gray-750 border border-gray-200 dark:border-gray-600 rounded',\n\t\t\t\tclassName\n\t\t\t)}\n\t\t\tonClick={onClick}\n\t\t\tonMouseOver={onMouseOver}\n\t\t\tonMouseOut={onMouseOut}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\nexport default Well\n","import { FC } from 'react'\nimport { TrashIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { WellWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport TableFrame from '@primer/components/TableFrame'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\n\ninterface OpenEditProps {\n\titem: WellWidget\n\tpath: Path\n\tremoveItem: (path: Path) => void\n\tupdateItem: (path: Path, newValue: WellWidget) => void\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = WellWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, removeItem, updateItem, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tupdateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<div className=\"py-6\">\n\t\t\t\t\t<Stack>\n\t\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</div>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tremoveItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t// {\n\t\t\t\t\t\t// \ttitle: 'Save',\n\t\t\t\t\t\t// \ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t// \tintent: 'save',\n\t\t\t\t\t\t// \ttype: 'submit',\n\t\t\t\t\t\t// },\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { FC, Fragment, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { WellWidget } from '.'\nimport DropTarget from 'pages/PageBuilder/components/DropTarget'\nimport { BuildComp } from '../index'\nimport Well from '@primer/components/Well'\nimport { ColumnsType, FieldType } from '../types'\nimport openEdit from './Edit'\nimport clsx from 'clsx'\nimport useHoverable from 'hooks/useHoverable'\n\nconst Accepts: string[] = [ColumnsType, FieldType]\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst { itemList, removeItem, updateItem } = useContext(PageBuilderContext)\n\tlet item: WellWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<Well\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, removeItem, updateItem })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx('cursor-pointer transition-all duration-10', isHovered && 'ring-4 ring-primary-500')}\n\t\t>\n\t\t\t{item.data.items.map((x, i) => (\n\t\t\t\t<Fragment key={x.id}>\n\t\t\t\t\t<DropTarget path={[...path, 'data', 'items', i]} isFirst={i === 0} accept={Accepts} />\n\t\t\t\t\t<BuildComp path={[...path, 'data', 'items', i]} />\n\t\t\t\t</Fragment>\n\t\t\t))}\n\t\t\t<DropTarget\n\t\t\t\tpath={[...path, 'data', 'items', item.data.items.length]}\n\t\t\t\tisFirst={item.data.items.length === 0}\n\t\t\t\tisLast\n\t\t\t\taccept={Accepts}\n\t\t\t/>\n\t\t</Well>\n\t)\n}\n\nexport default Build\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { WellType } from '../types'\nimport Build from './Build'\nimport View from './View'\nimport openEdit from './Edit'\n\nexport interface WellWidget extends Widget {\n\ttype: typeof WellType\n\tdata: {\n\t\titems: Widget[]\n\t}\n}\n\nexport const isWellWidget = (x: any): x is WellWidget => x.type === WellType\n\nexport const WellTool: Tool<WellWidget> = {\n\tname: 'Well',\n\ttype: WellType,\n\tdescription: 'A box used for sectioning content',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: WellType,\n\t\tdata: {\n\t\t\titems: [],\n\t\t},\n\t}),\n}\n\nexport const WellBuild = Build\nexport const WellView = View\nexport const openEditWell = openEdit\n","import { FC, useContext } from 'react'\nimport Well from '@primer/components/Well'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { WellWidget } from '.'\nimport { ViewComp } from '..'\nimport { Path } from '../types'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList } = useContext(PageRendererContext)\n\tlet item: WellWidget = view(lensPath(path), itemList)\n\n\treturn (\n\t\t<Well>\n\t\t\t{item.data.items.map((_, i) => (\n\t\t\t\t<ViewComp path={[...path, 'data', 'items', i]} />\n\t\t\t))}\n\t\t</Well>\n\t)\n}\n\nexport default View\n","import { FC } from 'react'\nimport { TrashIcon, CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { PageTitleWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport TableFrame from '@primer/components/TableFrame'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\n\ninterface OpenEditProps {\n\titem: PageTitleWidget\n\tpath: Path\n\tremoveItem: (path: Path) => void\n\tupdateItem: (path: Path, newValue: PageTitleWidget) => void\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = PageTitleWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, removeItem, updateItem, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tupdateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\tname=\"data.title\"\n\t\t\t\t\t\t\t\tlabel=\"Title\"\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Title is required' }}\n\t\t\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tremoveItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { PageTitleType } from '../types'\nimport Build from './Build'\nimport View from './View'\nimport openEdit from './Edit'\n\nexport interface PageTitleWidget extends Widget {\n\ttype: typeof PageTitleType\n\tdata: {\n\t\ttitle: string\n\t}\n}\n\nexport const isPageTitleWidget = (x: any): x is PageTitleWidget => x.type === PageTitleType\n\nexport const PageTitleTool: Tool<PageTitleWidget> = {\n\tname: 'Page Title',\n\ttype: PageTitleType,\n\tdescription: 'A large title for putting between cards',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: PageTitleType,\n\t\tdata: {\n\t\t\ttitle: 'Page title...',\n\t\t},\n\t}),\n}\n\nexport const PageTitleBuild = Build\nexport const PageTitleView = View\nexport const openEditPageTitle = openEdit\n","import { FC, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { PageTitleWidget } from '.'\nimport clsx from 'clsx'\nimport openEdit from './Edit'\nimport useHoverable from 'hooks/useHoverable'\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst { itemList, removeItem, updateItem } = useContext(PageBuilderContext)\n\tlet item: PageTitleWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<div\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, removeItem, updateItem })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx(\n\t\t\t\t'p-2 text-2xl leading-8 font-bold text-gray-900 dark:text-white sm:text-3xl sm:leading-9 whitespace-nowrap antialiased rounded-md cursor-pointer transition-all duration-100',\n\t\t\t\tisHovered && 'ring-4 ring-primary-500'\n\t\t\t)}\n\t\t>\n\t\t\t{item.data.title}\n\t\t</div>\n\t)\n}\n\nexport default Build\n","import { FC, useContext } from 'react'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { PageTitleWidget } from '.'\nimport { Path } from '../types'\nimport { replaceMarkers } from 'utils/funcs'\nimport { unitResource } from 'db/types'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList, unitId } = useContext(PageRendererContext)\n\tlet item: PageTitleWidget = view(lensPath(path), itemList)\n\n\tif (!item) return null\n\n\tlet unit = unitResource(unitId)\n\n\tconst markers = unit?.resolvedValues || {}\n\n\treturn (\n\t\t<div className=\"text-2xl leading-8 font-bold text-gray-900 dark:text-white sm:text-3xl sm:leading-9 whitespace-nowrap antialiased\">\n\t\t\t{replaceMarkers(item.data.title, markers, (str) => `{{${str}}}`)}\n\t\t</div>\n\t)\n}\n\nexport default View\n","import { FC } from 'react'\n\ninterface IconProps {\n\tclassName?: string\n}\n\nexport const CardIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t</svg>\n)\n\nexport const ColumnsIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"14\" y=\"3\" width=\"7\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t\t<rect x=\"3\" y=\"3\" width=\"7\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t</svg>\n)\n\nexport const DividerIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<path d=\"M3 12H21\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n\t</svg>\n)\n\nexport const FieldIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"3\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t\t<circle cx=\"6\" cy=\"14\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"9\" cy=\"14\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"12\" cy=\"14\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"15\" cy=\"14\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"18\" cy=\"14\" r=\"1\" fill=\"currentColor\" />\n\t</svg>\n)\n\nexport const PageTitleIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<path d=\"M12 4L12 16\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n\t\t<path d=\"M6 4H18\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n\t\t<path d=\"M3 19H21\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n\t</svg>\n)\n\nexport const Columns11Icon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"14\" y=\"3\" width=\"7\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t\t<rect x=\"3\" y=\"3\" width=\"7\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t</svg>\n)\n\nexport const Columns12Icon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"11\" y=\"3\" width=\"10\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t\t<rect x=\"3\" y=\"3\" width=\"4\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t</svg>\n)\n\nexport const Columns21Icon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<rect x=\"3\" y=\"3\" width=\"10\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t\t<rect x=\"17\" y=\"3\" width=\"4\" height=\"18\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"2\" />\n\t</svg>\n)\n\nexport const HandleIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<circle cx=\"9\" cy=\"17\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"14\" cy=\"17\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"9\" cy=\"12\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"14\" cy=\"12\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"9\" cy=\"7\" r=\"1\" fill=\"currentColor\" />\n\t\t<circle cx=\"14\" cy=\"7\" r=\"1\" fill=\"currentColor\" />\n\t</svg>\n)\n\nexport const WorkflowIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<path\n\t\t\td=\"M21 12H3M17 8L21 12L17 8ZM21 12L17 16L21 12Z\"\n\t\t\tstroke=\"currentColor\"\n\t\t\tstrokeWidth=\"2\"\n\t\t\tstrokeLinecap=\"round\"\n\t\t\tstrokeLinejoin=\"round\"\n\t\t/>\n\t\t<circle cx=\"5\" cy=\"12\" r=\"3\" fill=\"currentColor\" />\n\t</svg>\n)\n\nexport const SplitIcon: FC<IconProps> = ({ className = '' }) => (\n\t<svg className={className} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n\t\t<path\n\t\t\td=\"M12 7V11C12 11.5304 12.2107 12.0391 12.5858 12.4142C12.9609 12.7893 13.4696 13 14 13H16H17C17.5304 13 18.0391 13.2107 18.4142 13.5858C18.7893 13.9609 19 14.4696 19 15V21.5M19 21.5L16 18.5M19 21.5L22 18.5\"\n\t\t\tstroke=\"currentColor\"\n\t\t\tstrokeWidth=\"2\"\n\t\t\tstrokeLinecap=\"round\"\n\t\t\tstrokeLinejoin=\"round\"\n\t\t/>\n\t\t<path\n\t\t\td=\"M5 21.5V15C5 14.4696 5.21071 13.9609 5.58579 13.5858C5.96086 13.2107 6.46957 13 7 13H8H10C10.5304 13 11.0391 12.7893 11.4142 12.4142C11.7893 12.0391 12 11.5304 12 11V7V3M5 21.5L2 18.5M5 21.5L8 18.5\"\n\t\t\tstroke=\"currentColor\"\n\t\t\tstrokeWidth=\"2\"\n\t\t\tstrokeLinecap=\"round\"\n\t\t\tstrokeLinejoin=\"round\"\n\t\t/>\n\t</svg>\n)\n","import { FC } from 'react'\nimport { TrashIcon, CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { ColumnsWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport { PageBuilderContextType } from 'pages/PageBuilder/utils'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport { Columns11Icon, Columns12Icon, Columns21Icon } from 'components/Icon'\nimport { watch } from '@primer/components/Form/utils'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport TableFrame from '@primer/components/TableFrame'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\n\ninterface OpenEditProps {\n\titem: ColumnsWidget\n\tpath: Path\n\tcontext: PageBuilderContextType\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = ColumnsWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, context, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tcontext.updateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst format = watch('data.format', formContext)\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<FormLabel>Column Format</FormLabel>\n\t\t\t\t\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <Columns11Icon className=\"w-5 h-5 -mx-1\" />,\n\t\t\t\t\t\t\t\t\t\t\t\tintent: format === '1:1' ? 'primary' : 'secondary',\n\t\t\t\t\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => formContext.setFieldValue('data.format', '1:1'),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <Columns12Icon className=\"w-5 h-5 -mx-1\" />,\n\t\t\t\t\t\t\t\t\t\t\t\tintent: format === '1:2' ? 'primary' : 'secondary',\n\t\t\t\t\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => formContext.setFieldValue('data.format', '1:2'),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <Columns21Icon className=\"w-5 h-5 -mx-1\" />,\n\t\t\t\t\t\t\t\t\t\t\t\tintent: format === '2:1' ? 'primary' : 'secondary',\n\t\t\t\t\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => formContext.setFieldValue('data.format', '2:1'),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tcontext.removeItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { FC, Fragment, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { ColumnsWidget } from '.'\nimport clsx from 'clsx'\nimport openEdit from './Edit'\nimport useHoverable from 'hooks/useHoverable'\nimport DropTarget from 'pages/PageBuilder/components/DropTarget'\nimport { BuildComp } from '..'\nimport { FieldType } from '../types'\n\nconst Accepts = [FieldType]\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst context = useContext(PageBuilderContext)\n\tconst { itemList } = context\n\tconst item: ColumnsWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<div\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, context })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx(\n\t\t\t\t'flex space-x-2 bg-gray-100 p-2 rounded-md cursor-pointer transition-all duration-10',\n\t\t\t\tisHovered && 'ring-4 ring-primary-500'\n\t\t\t)}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={clsx('p-2 rounded-md bg-white', {\n\t\t\t\t\t'w-1/2': item.data.format === '1:1',\n\t\t\t\t\t'w-1/3': item.data.format === '1:2',\n\t\t\t\t\t'w-2/3': item.data.format === '2:1',\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{item.data.items[0].map((x, i) => (\n\t\t\t\t\t<Fragment key={x.id}>\n\t\t\t\t\t\t<DropTarget path={[...path, 'data', 'items', 0, i]} isFirst={i === 0} accept={Accepts} />\n\t\t\t\t\t\t<BuildComp path={[...path, 'data', 'items', 0, i]} />\n\t\t\t\t\t</Fragment>\n\t\t\t\t))}\n\t\t\t\t<DropTarget\n\t\t\t\t\tpath={[...path, 'data', 'items', 0, item.data.items.length]}\n\t\t\t\t\tisFirst={item.data.items[0].length === 0}\n\t\t\t\t\tisLast\n\t\t\t\t\taccept={Accepts}\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclassName={clsx('p-2 rounded-md bg-white', {\n\t\t\t\t\t'w-1/2': item.data.format === '1:1',\n\t\t\t\t\t'w-1/3': item.data.format === '2:1',\n\t\t\t\t\t'w-2/3': item.data.format === '1:2',\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{item.data.items[1].map((x, i) => (\n\t\t\t\t\t<Fragment key={x.id}>\n\t\t\t\t\t\t<DropTarget path={[...path, 'data', 'items', 1, i]} isFirst={i === 0} accept={Accepts} />\n\t\t\t\t\t\t<BuildComp path={[...path, 'data', 'items', 1, i]} />\n\t\t\t\t\t</Fragment>\n\t\t\t\t))}\n\t\t\t\t<DropTarget\n\t\t\t\t\tpath={[...path, 'data', 'items', 1, item.data.items.length]}\n\t\t\t\t\tisFirst={item.data.items[1].length === 0}\n\t\t\t\t\tisLast\n\t\t\t\t\taccept={Accepts}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Build\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { ColumnsType } from '../types'\nimport openEdit from './Edit'\nimport Build from './Build'\nimport View from './View'\n\nexport interface ColumnsWidget extends Widget {\n\ttype: typeof ColumnsType\n\tdata: {\n\t\titems: [Widget[], Widget[]]\n\t\tformat: '1:1' | '1:2' | '2:1'\n\t}\n}\n\nexport const isColumnsWidget = (x: any): x is ColumnsWidget => x.type === ColumnsType\n\nexport const ColumnsTool: Tool<ColumnsWidget> = {\n\tname: 'Columns',\n\ttype: ColumnsType,\n\tdescription: 'Display a value',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: ColumnsType,\n\t\tdata: {\n\t\t\titems: [[], []],\n\t\t\tformat: '1:1',\n\t\t},\n\t}),\n}\n\nexport const ColumnsBuild = Build\nexport const ColumnsView = View\nexport const openEditColumns = openEdit\n","import { FC, useContext } from 'react'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { ColumnsWidget } from '.'\nimport { ViewComp } from '..'\nimport { Path } from '../types'\nimport clsx from 'clsx'\nimport Stack from '@primer/components/Stack'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList } = useContext(PageRendererContext)\n\tlet item: ColumnsWidget = view(lensPath(path), itemList)\n\n\treturn (\n\t\t<div className=\"flex space-x-4\">\n\t\t\t<Stack\n\t\t\t\tclassName={clsx({\n\t\t\t\t\t'w-1/2': item.data.format === '1:1',\n\t\t\t\t\t'w-1/3': item.data.format === '1:2',\n\t\t\t\t\t'w-2/3': item.data.format === '2:1',\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{item.data.items[0].map((_, i) => (\n\t\t\t\t\t<ViewComp key={i} path={[...path, 'data', 'items', 0, i]} />\n\t\t\t\t))}\n\t\t\t</Stack>\n\t\t\t<Stack\n\t\t\t\tclassName={clsx({\n\t\t\t\t\t'w-1/2': item.data.format === '1:1',\n\t\t\t\t\t'w-1/3': item.data.format === '2:1',\n\t\t\t\t\t'w-2/3': item.data.format === '1:2',\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{item.data.items[1].map((_, i) => (\n\t\t\t\t\t<ViewComp key={i} path={[...path, 'data', 'items', 1, i]} />\n\t\t\t\t))}\n\t\t\t</Stack>\n\t\t</div>\n\t)\n}\n\nexport default View\n","import { FC } from 'react'\nimport { TrashIcon, CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { FieldWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport { PageBuilderContextType } from 'pages/PageBuilder/utils'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport TableFrame from '@primer/components/TableFrame'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\nimport { watch } from '@primer/components/Form/utils'\nimport AutoHeight from '@primer/components/AutoHeight'\nimport FormInput from '@primer/components/Form/FormInput'\n\nconst customOption = { label: 'Custom', value: 'custom' }\n\ninterface OpenEditProps {\n\titem: FieldWidget\n\tpath: Path\n\tcontext: PageBuilderContextType\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = FieldWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, context, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tcontext.updateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\tconst fieldId = watch('data.fieldId', formContext)\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput name=\"data.label\" label=\"Custom Label\" />\n\n\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\tname=\"data.fieldId\"\n\t\t\t\t\t\t\t\tlabel=\"Field\"\n\t\t\t\t\t\t\t\toptions={\n\t\t\t\t\t\t\t\t\tcontext.entity?.fields\n\t\t\t\t\t\t\t\t\t\t.map((x) => ({ label: x.name, value: x.id }))\n\t\t\t\t\t\t\t\t\t\t.concat([customOption]) || [customOption]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<AutoHeight show={fieldId === 'custom'}>\n\t\t\t\t\t\t\t\t<FormInput name=\"data.customFormat\" label=\"Custom Format\" />\n\t\t\t\t\t\t\t</AutoHeight>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tcontext.removeItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { FieldType } from '../types'\nimport openEdit from './Edit'\nimport Build from './Build'\nimport View from './View'\n\nexport interface FieldWidget extends Widget {\n\ttype: typeof FieldType\n\tdata: {\n\t\tfieldId: string\n\t\tlabel?: string\n\t\tcustomFormat?: string\n\t}\n}\n\nexport const isFieldWidget = (x: any): x is FieldWidget => x.type === FieldType\n\nexport const FieldTool: Tool<FieldWidget> = {\n\tname: 'Field',\n\ttype: FieldType,\n\tdescription: 'Display a value',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: FieldType,\n\t\tdata: {\n\t\t\tfieldId: '',\n\t\t\tlabel: '',\n\t\t\tcustomFormat: '',\n\t\t},\n\t}),\n}\n\nexport const FieldBuild = Build\nexport const FieldView = View\nexport const openEditField = openEdit\n","import { FC, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { FieldWidget } from '.'\nimport clsx from 'clsx'\nimport openEdit from './Edit'\nimport useHoverable from 'hooks/useHoverable'\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst context = useContext(PageBuilderContext)\n\tconst { entity, itemList } = context\n\tconst item: FieldWidget = view(lensPath(path), itemList)\n\n\tconst field = entity?.fields.find((x) => x.id === item.data.fieldId)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<div\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, context })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx(\n\t\t\t\t'p-1 rounded-md cursor-pointer transition-all duration-100',\n\t\t\t\tisHovered && 'ring-4 ring-primary-500'\n\t\t\t)}\n\t\t>\n\t\t\t<div className=\"text-sm leading-5 text-gray-500 dark:text-gray-300\">Field</div>\n\t\t\t<div className=\"mt-1 text-sm leading-5 break-all text-gray-900 dark:text-white\">\n\t\t\t\t{(item.data.label ? `\"${item.data.label}\"${field?.name ? ` (${field?.name})` : ''}` : field?.name) ||\n\t\t\t\t\t'Please choose a field'}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default Build\n","import { FC, useContext } from 'react'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { FieldWidget } from '.'\nimport { Path } from '../types'\nimport { fieldResource, unitResource } from 'db/types'\nimport { replaceMarkers } from 'utils/funcs'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList, unitId } = useContext(PageRendererContext)\n\tlet item: FieldWidget = view(lensPath(path), itemList)\n\n\tlet field = item.data.fieldId !== 'custom' ? fieldResource(item.data.fieldId) : null\n\tlet unit = unitResource(unitId)\n\n\tconst markers = unit?.resolvedValues || {}\n\n\tif (field) {\n\t\treturn (\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"text-sm leading-5 text-gray-500 dark:text-gray-300\">\n\t\t\t\t\t{item.data.label || field?.name || '-'}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1 text-sm leading-5 break-all text-gray-900 dark:text-white\">\n\t\t\t\t\t{unit?.value(field.id)?.formatted || '-'}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\n\tif (item.data.fieldId === 'custom') {\n\t\treturn (\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"text-sm leading-5 text-gray-500 dark:text-gray-300\">{item.data.label || '-'}</div>\n\t\t\t\t<div className=\"mt-1 text-sm leading-5 break-all text-gray-900 dark:text-white\">\n\t\t\t\t\t{replaceMarkers(item.data.customFormat || '-', markers, (str) => `{{${str}}}`)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\n\treturn null\n}\n\nexport default View\n","import { FC } from 'react'\nimport { TrashIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { DividerWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport { PageBuilderContextType } from 'pages/PageBuilder/utils'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport Stack from '@primer/components/Stack'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport TableFrame from '@primer/components/TableFrame'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\n\ninterface OpenEditProps {\n\titem: DividerWidget\n\tpath: Path\n\tcontext: PageBuilderContextType\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, context, close }) => {\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<>\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<div className=\"py-6\">\n\t\t\t\t\t<Stack>\n\t\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</div>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tcontext.removeItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</>\n\t)\n}\n\nexport default openEdit\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { DividerType } from '../types'\nimport Build from './Build'\nimport View from './View'\nimport openEdit from './Edit'\n\nexport interface DividerWidget extends Widget {\n\ttype: typeof DividerType\n\tdata: {\n\t\titems: Widget[]\n\t}\n}\n\nexport const isDividerWidget = (x: any): x is DividerWidget => x.type === DividerType\n\nexport const DividerTool: Tool<DividerWidget> = {\n\tname: 'Divider',\n\ttype: DividerType,\n\tdescription: 'A box used for sectioning content',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: DividerType,\n\t\tdata: {\n\t\t\titems: [],\n\t\t},\n\t}),\n}\n\nexport const DividerBuild = Build\nexport const DividerView = View\nexport const openEditDivider = openEdit\n","import { FC, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { DividerWidget } from '.'\nimport openEdit from './Edit'\nimport clsx from 'clsx'\nimport useHoverable from 'hooks/useHoverable'\nimport Divider from '@primer/components/Divider'\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst context = useContext(PageBuilderContext)\n\tconst { itemList } = context\n\tlet item: DividerWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<div\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, context })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx(\n\t\t\t\t'p-2 rounded-md cursor-pointer transition-all duration-10',\n\t\t\t\tisHovered && 'ring-4 ring-primary-500'\n\t\t\t)}\n\t\t>\n\t\t\t<Divider />\n\t\t</div>\n\t)\n}\n\nexport default Build\n","import Divider from '@primer/components/Divider'\nimport { FC } from 'react'\nimport { Path } from '../types'\n\nconst View: FC<{ path: Path }> = () => {\n\treturn <Divider />\n}\n\nexport default View\n","import { FC, ReactNode } from 'react'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface FormCheckboxProps {\n\tname: string\n\tlabel?: ReactNode\n\tdescription?: ReactNode\n\tdefaultValue?: any\n\tdisabled?: boolean\n\tinputClassName?: ClassValue\n\tclassName?: ClassValue\n\tcolor?: string\n\tautoFocus?: boolean\n}\n\nconst FormCheckbox: FC<FormCheckboxProps> = ({\n\tname,\n\tlabel,\n\tdescription,\n\tdisabled,\n\tcolor = 'bg-primary-500 dark:bg-primary-500',\n\tclassName,\n\tautoFocus,\n}) => {\n\t// helpers: {setValue: ƒ, setTouched: ƒ, setError: ƒ}\n\tconst [field] = useField({\n\t\tname,\n\t\ttype: 'checkbox',\n\t})\n\n\tconst { value } = field\n\n\tconst formik = useFormikContext()\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<label className=\"text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 inline-flex items-center cursor-pointer\">\n\t\t\t\t<Toggle checked={value} color={color} />\n\t\t\t\t{(label || description) && (\n\t\t\t\t\t<div className=\"ml-3\">\n\t\t\t\t\t\t{label && <div>{label}</div>}\n\t\t\t\t\t\t{description && <div className=\"font-normal text-gray-500\">{description}</div>}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<input\n\t\t\t\t\t{...field}\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t\tclassName=\"hidden\"\n\t\t\t\t\tautoFocus={autoFocus}\n\t\t\t\t/>\n\t\t\t</label>\n\t\t</div>\n\t)\n}\n\ninterface ToggleProps {\n\tchecked: boolean\n\tcolor: string\n}\n\nconst Toggle: FC<ToggleProps> = ({ checked, color }) => {\n\treturn (\n\t\t<span\n\t\t\trole=\"checkbox\"\n\t\t\ttabIndex={0}\n\t\t\taria-checked=\"false\"\n\t\t\tclassName={clsx(\n\t\t\t\t'relative inline-block flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:shadow-outline',\n\t\t\t\t{\n\t\t\t\t\t[color]: checked,\n\t\t\t\t\t'bg-gray-200 dark:bg-gray-800': !checked,\n\t\t\t\t}\n\t\t\t)}\n\t\t>\n\t\t\t<span\n\t\t\t\taria-hidden=\"true\"\n\t\t\t\tclassName={clsx(\n\t\t\t\t\t'translate-x-0 inline-block h-5 w-5 rounded-full shadow transform transition ease-in-out duration-200',\n\t\t\t\t\t{\n\t\t\t\t\t\t'translate-x-5 bg-white dark:bg-white': checked,\n\t\t\t\t\t\t'translate-x-0 bg-white dark:bg-gray-400': !checked,\n\t\t\t\t\t}\n\t\t\t\t)}\n\t\t\t></span>\n\t\t</span>\n\t)\n}\n\nexport default FormCheckbox\n","import { FC } from 'react'\nimport { TrashIcon, CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { SectionWidget } from '.'\nimport { tools } from '..'\nimport { Path } from '../types'\nimport TableFrame from '@primer/components/TableFrame'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport FormToggle from '@primer/components/Form/FormToggle'\n\ninterface OpenEditProps {\n\titem: SectionWidget\n\tpath: Path\n\tremoveItem: (path: Path) => void\n\tupdateItem: (path: Path, newValue: SectionWidget) => void\n}\n\nconst openEdit = (props: OpenEditProps) => {\n\treturn openSlideout({\n\t\t// size: '2xl',\n\t\trender: (close) => <OpenEdit close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = SectionWidget\n\nconst OpenEdit: FC<OpenEditProps & { close: SlideoutResolveFn }> = ({ item, path, removeItem, updateItem, close }) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: item as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tconsole.log('new Data', formData)\n\t\t\tupdateItem(path, formData)\n\t\t\tclose()\n\t\t},\n\t})\n\n\tconst permissionsSchema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Role',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Can View',\n\t\t\t\tvalue: () => (\n\t\t\t\t\t<div className=\"flex justify-center w-full\">\n\t\t\t\t\t\t<input type=\"checkbox\" className=\"form-checkbox text-primary-500\" defaultChecked />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t}\n\n\tconst tool = tools[item.type]\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={`Edit ${tool.name}`} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput name=\"data.title\" label=\"Title\" className=\"flex-1\" autoFocus />\n\t\t\t\t\t\t\t<FormToggle name=\"data.bottomBorder\" label=\"Show a bottom border\" />\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<FormLabel>Permissions</FormLabel>\n\t\t\t\t\t\t<TableFrame className=\"mt-1\">\n\t\t\t\t\t\t\t<Table schema={permissionsSchema} items={db.roles.all()} className=\"-my-px\" />\n\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-between\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tremoveItem(path)\n\t\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openEdit\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport Actions from './Actions'\nimport { ActionType, isNotNone } from '@primer/types'\nimport ButtonSpacer from './ButtonSpacer'\n\ninterface SectionHeaderProps {\n\ttitle: ReactNode\n\tsubtitle?: ReactNode\n\tactions?: ActionType[]\n\tclassName?: ClassValue\n}\n\nconst SectionHeader: FC<SectionHeaderProps> = ({ title, subtitle, actions, className }) => (\n\t<div className={clsx('flex justify-between items-center flex-wrap sm:flex-nowrap', className)}>\n\t\t<div>\n\t\t\t<h3 className=\"text-lg leading-5 font-medium text-gray-900 dark:text-white\">{title}</h3>\n\t\t\t{subtitle && <p className=\"mt-1 text-sm leading-5 text-gray-500 dark:text-gray-300\">{subtitle}</p>}\n\t\t</div>\n\t\t<div className=\"flex-shrink-0\">\n\t\t\t{actions && actions.filter(isNotNone).length > 0 ? <Actions actions={actions} /> : <ButtonSpacer />}\n\t\t</div>\n\t</div>\n)\n\nexport default SectionHeader\n","import { FC, Fragment, useContext } from 'react'\nimport { PageBuilderContext, Path } from 'pages/PageBuilder/utils'\nimport { lensPath, view } from 'ramda'\nimport { SectionWidget } from '.'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport DropTarget from 'pages/PageBuilder/components/DropTarget'\nimport { BuildComp } from '../index'\nimport { ColumnsType, FieldType, WellType } from '../types'\nimport clsx from 'clsx'\nimport openEdit from './Edit'\nimport useHoverable from 'hooks/useHoverable'\n\nconst Accepts: string[] = [WellType, ColumnsType, FieldType]\n\ninterface BuildProps {\n\tpath: Path\n}\n\nconst Build: FC<BuildProps> = ({ path }) => {\n\tconst { itemList, removeItem, updateItem } = useContext(PageBuilderContext)\n\tlet item: SectionWidget = view(lensPath(path), itemList)\n\n\tconst [isHovered, bindHoverable] = useHoverable()\n\n\tif (!item) return null\n\n\treturn (\n\t\t<div\n\t\t\tonClick={(e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\topenEdit({ item, path, removeItem, updateItem })\n\t\t\t}}\n\t\t\t{...bindHoverable}\n\t\t\tclassName={clsx(\n\t\t\t\t'rounded-md cursor-pointer transition-all duration-100',\n\t\t\t\tisHovered && 'ring-4 ring-primary-500'\n\t\t\t)}\n\t\t>\n\t\t\t{item.data.title && <SectionHeader title={item.data.title} />}\n\t\t\t<div className=\"py-6\">\n\t\t\t\t{item.data.items.map((x, i) => (\n\t\t\t\t\t<Fragment key={x.id}>\n\t\t\t\t\t\t<DropTarget path={[...path, 'data', 'items', i]} isFirst={i === 0} accept={Accepts} />\n\t\t\t\t\t\t<BuildComp path={[...path, 'data', 'items', i]} />\n\t\t\t\t\t</Fragment>\n\t\t\t\t))}\n\t\t\t\t<DropTarget\n\t\t\t\t\tpath={[...path, 'data', 'items', item.data.items.length]}\n\t\t\t\t\tisFirst={item.data.items.length === 0}\n\t\t\t\t\tisLast\n\t\t\t\t\taccept={Accepts}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{item.data.bottomBorder && <div className=\"border-b border-gray-200 mt-6\" />}\n\t\t</div>\n\t)\n}\n\nexport default Build\n","import { uuid } from 'utils/funcs'\nimport { Tool, Widget } from '../../utils'\nimport { SectionType } from '../types'\nimport openEdit from './Edit'\n\nimport Build from './Build'\nimport View from './View'\n\nexport interface SectionWidget extends Widget {\n\ttype: typeof SectionType\n\tdata: {\n\t\ttitle?: string\n\t\tbottomBorder?: boolean\n\t\titems: Widget[]\n\t}\n}\n\nexport const isSectionWidget = (x: any): x is SectionWidget => x.type === SectionType\n\nexport const SectionTool: Tool<SectionWidget> = {\n\tname: 'Section',\n\ttype: SectionType,\n\tdescription: 'A box used for containing content',\n\tcreate: () => ({\n\t\tid: uuid(),\n\t\ttype: SectionType,\n\t\tdata: {\n\t\t\ttitle: '',\n\t\t\tbottomBorder: false,\n\t\t\titems: [],\n\t\t},\n\t}),\n}\n\nexport const SectionBuild = Build\nexport const SectionView = View\nexport const openEditSection = openEdit\n","import { FC, useContext } from 'react'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport { PageRendererContext } from 'pages/PageBuilder/utils'\nimport { view, lensPath } from 'ramda'\nimport { SectionWidget } from '.'\nimport { ViewComp } from '..'\nimport { Path } from '../types'\nimport clsx from 'clsx'\n\nconst View: FC<{ path: Path }> = ({ path }) => {\n\tlet { itemList } = useContext(PageRendererContext)\n\tlet item: SectionWidget = view(lensPath(path), itemList)\n\n\tconsole.log(item)\n\n\treturn (\n\t\t<div className={clsx(item.data.bottomBorder && 'border-b border-gray-200 pb-6', 'px-6')}>\n\t\t\t<Stack>\n\t\t\t\t{item.data.title && <SectionHeader title={item.data.title} />}\n\t\t\t\t{item.data.items.map((_, i) => (\n\t\t\t\t\t<ViewComp key={i} path={[...path, 'data', 'items', i]} />\n\t\t\t\t))}\n\t\t\t</Stack>\n\t\t</div>\n\t)\n}\n\nexport default View\n","import { ReactNode } from 'react'\nimport { useDrag } from 'react-dnd'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface DraggerProps<T extends {}> {\n\titem: T\n\ttype: string\n\tclassName?: ClassValue | ((x: { isDragging: boolean }) => ClassValue)\n\tchildren?: ReactNode | ((x: { isDragging: boolean }) => ReactNode)\n}\n\nfunction Dragger<T>({ item, type, className, children }: DraggerProps<T>) {\n\tconst [{ isDragging }, dragRef] = useDrag({\n\t\ttype,\n\t\titem,\n\t\tcollect: (monitor) => {\n\t\t\treturn {\n\t\t\t\tisDragging: !!monitor.isDragging(),\n\t\t\t}\n\t\t},\n\t})\n\n\treturn (\n\t\t<div ref={dragRef} className={typeof className === 'function' ? className({ isDragging }) : clsx(className)}>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\nexport default Dragger\n","import { useContext } from 'react'\nimport { lensPath, view } from 'ramda'\nimport { PageBuilderContext, PageRendererContext, Path, Widget } from '../utils'\n\nimport { CardType, WellType, PageTitleType, FieldType, ColumnsType, DividerType, SectionType } from './types'\n\nimport { CardTool, CardBuild, CardView, openEditCard } from './Card'\nimport { WellTool, WellBuild, WellView, openEditWell } from './Well'\nimport { PageTitleTool, PageTitleBuild, PageTitleView, openEditPageTitle } from './PageTitle'\nimport { ColumnsTool, ColumnsBuild, ColumnsView, openEditColumns } from './Columns'\nimport { FieldTool, FieldBuild, FieldView, openEditField } from './Field'\nimport { DividerTool, DividerBuild, DividerView, openEditDivider } from './Divider'\nimport { SectionTool, SectionBuild, SectionView, openEditSection } from './Section'\nimport Dragger from 'components/Builder/Dragger'\n\nexport const tools = {\n\t[PageTitleType]: PageTitleTool,\n\t[CardType]: CardTool,\n\t[SectionType]: SectionTool,\n\t[WellType]: WellTool,\n\t[ColumnsType]: ColumnsTool,\n\t[FieldType]: FieldTool,\n\t[DividerType]: DividerTool,\n}\n\nexport const builds = {\n\t[CardType]: CardBuild,\n\t[WellType]: WellBuild,\n\t[PageTitleType]: PageTitleBuild,\n\t[ColumnsType]: ColumnsBuild,\n\t[FieldType]: FieldBuild,\n\t[DividerType]: DividerBuild,\n\t[SectionType]: SectionBuild,\n}\n\nexport const views = {\n\t[CardType]: CardView,\n\t[WellType]: WellView,\n\t[PageTitleType]: PageTitleView,\n\t[ColumnsType]: ColumnsView,\n\t[FieldType]: FieldView,\n\t[DividerType]: DividerView,\n\t[SectionType]: SectionView,\n}\n\nexport const editors = {\n\t[CardType]: openEditCard,\n\t[WellType]: openEditWell,\n\t[PageTitleType]: openEditPageTitle,\n\t[ColumnsType]: openEditColumns,\n\t[FieldType]: openEditField,\n\t[DividerType]: openEditDivider,\n\t[SectionType]: openEditSection,\n}\n\nexport const BuildComp = ({ path }: { path: Path }) => {\n\tconst { itemList } = useContext(PageBuilderContext)\n\tlet item: Widget = view(lensPath(path), itemList)\n\n\tconst Comp = builds[item.type]\n\n\treturn (\n\t\t<Dragger type={item.type} item={{ item, path }}>\n\t\t\t<Comp path={path} />\n\t\t</Dragger>\n\t)\n}\n\nexport const ViewComp = ({ path }: { path: Path }) => {\n\tconst { itemList } = useContext(PageRendererContext)\n\tlet item: Widget = view(lensPath(path), itemList)\n\n\tconst Comp = views[item.type]\n\n\treturn <Comp path={path} />\n}\n","import { FC, useMemo } from 'react'\nimport { PageRendererProvider } from './utils'\nimport { planResource } from 'db/types'\nimport { Widget } from './utils'\nimport Stack from '@primer/components/Stack'\nimport { ViewComp } from './Widgets'\n\nconst PageRenderer: FC<{ id: string; unitId: string }> = ({ id, unitId }) => {\n\tconst plan = useMemo(() => planResource(id), [id])\n\n\tconst itemList: { items: Widget[] } = useMemo(() => {\n\t\ttry {\n\t\t\treturn JSON.parse(plan?.structure || 'null')\n\t\t} catch (error) {\n\t\t\treturn null\n\t\t}\n\t}, [plan])\n\n\treturn (\n\t\t<PageRendererProvider value={{ unitId, itemList }}>\n\t\t\t<Stack>\n\t\t\t\t{itemList.items.map((_, i) => (\n\t\t\t\t\t<ViewComp path={['items', i]} />\n\t\t\t\t))}\n\t\t\t</Stack>\n\t\t</PageRendererProvider>\n\t)\n}\n\nexport default PageRenderer\n","import { FC } from 'react'\nimport { RouteComponentProps } from '@reach/router'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport Actions from '@primer/components/Actions'\nimport { ArrowLeftIcon, ClockIcon, PencilIcon, PlusIcon, TemplateIcon } from '@heroicons/react/outline'\nimport { unitResource } from 'db/types'\n// import PlanRenderer from 'pages/PageBuilder/PageRenderer'\nimport { replaceMarkers } from 'utils/funcs'\nimport PageRenderer from 'pages/PageBuilder/PageRenderer'\n\nconst ViewUnit: FC<RouteComponentProps<{ id: string }>> = ({ id = '' }) => {\n\tconst unit = unitResource(id)\n\tconst entity = unit?.entity\n\n\tconst plan = entity?.plan('view')\n\n\t// const markers = entity?.fields?.reduce<Record<string, string>>(\n\t// \t(list, field) => ({ ...list, [field.key]: unit?.value(field)?.value || '-' }),\n\t// \t{}\n\t// )\n\tconst markers = unit?.resolvedValues\n\n\tconst title = replaceMarkers(plan?.name || `View ${entity?.name}`, markers || {}, (str) => `{{${str}}}`)\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: `/${entity?.key}`,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t\tactions={[\n\t\t\t\t\tplan && {\n\t\t\t\t\t\ttitle: 'Edit Page Plan',\n\t\t\t\t\t\ticon: <TemplateIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\tto: `/${entity?.key}/${id}/plan/view`,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: 'History',\n\t\t\t\t\t\ticon: <ClockIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\tto: `/${entity?.key}/${id}/history`,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: `Edit ${entity?.name}`,\n\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\tto: `/${entity?.key}/${id}/edit`,\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t{plan ? (\n\t\t\t\t\t<PageRenderer id={plan.id} unitId={id} />\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"flex flex-col items-center justify-center space-y-6\">\n\t\t\t\t\t\t<div className=\"text-2xl font-medium\">No plan exists for this page</div>\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Plan',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\tsize: 'lg',\n\t\t\t\t\t\t\t\t\tto: `/${entity?.key}/${id}/plan/view`,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default ViewUnit\n","import { FC, useEffect, useState } from 'react'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\nimport { usePopper } from '@primer/hooks/usePopper'\nimport { Placement } from '@popperjs/core/index'\nimport { ArrowLeftIcon, ArrowRightIcon } from '@heroicons/react/outline'\nimport useDismissable from '@primer/hooks/useDismissable'\nimport {\n\taddDays,\n\taddMonths,\n\tendOfMonth,\n\tformat,\n\tgetDaysInMonth,\n\tgetISODay,\n\tisAfter,\n\tisBefore,\n\tisSameDay,\n\tparse,\n\tstartOfMonth,\n\tsubDays,\n\tsubMonths,\n} from 'date-fns'\nimport { ensureDate, getReservedDate, isValidDate } from '@primer/utils/funcs'\nimport useAutoFocus from '@primer/hooks/useAutoFocus'\nimport composeRefs from '@seznam/compose-react-refs'\nimport { FormValidations, validate } from './utils'\n\nconst weekDays = ['Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa', 'Su']\n\nconst isDate = (x: any): x is Date => x && x instanceof Date && isValidDate(x)\n\ninterface FormDateProps {\n\tname: string\n\tlabel?: string\n\tdescription?: string\n\tplaceholder?: string\n\thideOptional?: boolean\n\tvalidations?: FormValidations\n\tplacement?: Placement\n\toffset?: number | [number, number]\n\tdisabled?: boolean\n\tminDate?: Date\n\tmaxDate?: Date\n\tdisableHolidays?: boolean\n\tinputDisabled?: boolean\n\tautoFocus?: boolean\n\tclassName?: ClassValue\n\tinputClassName?: ClassValue\n}\n\nconst FormDate: FC<FormDateProps> = ({\n\tname,\n\tlabel,\n\tdescription,\n\tplaceholder = 'DD/MM/YYYY',\n\thideOptional,\n\tvalidations = {},\n\tplacement = 'bottom-end',\n\toffset = 10,\n\tdisabled,\n\tminDate,\n\tmaxDate,\n\tinputDisabled,\n\tdisableHolidays = false,\n\tautoFocus = false,\n\tclassName,\n\tinputClassName,\n}) => {\n\tconst isRequired = validations?.required\n\n\tconst [{ value, onBlur }, { error, touched }, { setValue, setTouched }] = useField({\n\t\tname,\n\t\tvalidate: validate(validations),\n\t})\n\n\tconst formik = useFormikContext()\n\n\tconst [display, setDisplay] = useState(isDate(value) ? format(value, 'dd/MM/yyyy') : '')\n\tconst [context, setContext] = useState<Date>(startOfMonth(isDate(value) ? value : new Date()))\n\tconst [prevValue, setPrevValue] = useState<Date | null | undefined>()\n\n\tuseEffect(() => {\n\t\tif (prevValue !== value) {\n\t\t\tif (value) {\n\t\t\t\tlet ensuredDate = ensureDate(value)\n\t\t\t\tsetDisplay(isDate(ensuredDate) ? format(ensuredDate, 'dd/MM/yyyy') : '')\n\t\t\t\tsetPrevValue(value)\n\t\t\t} else {\n\t\t\t\tsetDisplay('')\n\t\t\t\tsetContext(new Date())\n\t\t\t}\n\t\t}\n\t}, [prevValue, value])\n\n\tconst {\n\t\topen,\n\t\tsetOpen,\n\t\tignoreClass,\n\t\tref: dismissableRef,\n\t} = useDismissable({\n\t\tonOpen: () => {\n\t\t\ttry {\n\t\t\t\tif (value) {\n\t\t\t\t\tlet dateValue = ensureDate(value)\n\t\t\t\t\tsetDisplay(format(dateValue, 'dd/MM/yyyy'))\n\t\t\t\t\tsetContext(dateValue)\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('error', error)\n\t\t\t\tsetDisplay('')\n\t\t\t\tsetContext(new Date())\n\t\t\t}\n\t\t},\n\t})\n\n\tconst [reference, tooltip] = usePopper({\n\t\tplacement,\n\t\tstrategy: 'fixed',\n\t\tmodifiers: [\n\t\t\t{\n\t\t\t\tname: 'offset',\n\t\t\t\toptions: { offset: offset instanceof Array ? offset : [0, offset] },\n\t\t\t},\n\t\t],\n\t})\n\n\tconst preDays = new Array(getISODay(startOfMonth(context)) - 1)\n\t\t.fill(null)\n\t\t.map((_, i) => subDays(endOfMonth(subMonths(context, 1)), i))\n\t\t.reverse()\n\n\tconst postDays = new Array(7 - getISODay(endOfMonth(context)))\n\t\t.fill(null)\n\t\t.map((_, i) => addDays(startOfMonth(addMonths(context, 1)), i))\n\n\tconst days = new Array(getDaysInMonth(context)).fill(null).map((_, i) => addDays(startOfMonth(context), i))\n\n\tconst select = (day: Date) => {\n\t\tsetValue(day)\n\t\tsetTouched(true)\n\t\tsetOpen(false)\n\n\t\tsetDisplay(format(day, 'dd/MM/yyyy'))\n\t}\n\n\tconst autoFocusRef = useAutoFocus<HTMLInputElement>(autoFocus)\n\n\treturn (\n\t\t<div className={clsx(className)} ref={dismissableRef}>\n\t\t\t<label>\n\t\t\t\t{label && (\n\t\t\t\t\t<div className=\"block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200\">\n\t\t\t\t\t\t{label}{' '}\n\t\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t<div className={clsx('relative rounded-md', label && 'mt-1')}>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tvalue={display}\n\t\t\t\t\t\tonChange={(e) => setDisplay(e.target.value)}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tdisabled={formik.isSubmitting || disabled}\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tref={composeRefs(reference, autoFocusRef)}\n\t\t\t\t\t\tonClick={() => setOpen(true)}\n\t\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\t\tif (inputDisabled) {\n\t\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetOpen(false)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={(event) => {\n\t\t\t\t\t\t\tif (!display) {\n\t\t\t\t\t\t\t\tsetValue(null)\n\t\t\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlet displayDate = parse(display, 'dd/MM/yyyy', new Date())\n\n\t\t\t\t\t\t\t\tif (isValidDate(displayDate)) {\n\t\t\t\t\t\t\t\t\tsetValue(displayDate)\n\t\t\t\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tsetDisplay(isDate(value) ? format(value, 'dd/MM/yyyy') : '')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tonBlur(event)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t'form-input block w-full sm:text-sm sm:leading-5',\n\t\t\t\t\t\t\terror &&\n\t\t\t\t\t\t\t\ttouched &&\n\t\t\t\t\t\t\t\t'pr-10 border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500',\n\t\t\t\t\t\t\tinputClassName,\n\t\t\t\t\t\t\tignoreClass\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div className={clsx(!open && 'hidden', 'z-10')} ref={tooltip}>\n\t\t\t\t\t\t<div className=\"mt rounded-md shadow-lg bg-white dark:bg-gray-700 w-80 overflow-hidden\">\n\t\t\t\t\t\t\t<div className=\"flex items-center dark:bg-gray-750 p-4 border-b border-gray-100 dark:border-gray-600\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tonClick={() => setContext((c) => subMonths(c, 1))}\n\t\t\t\t\t\t\t\t\tclassName=\"inline-flex items-center font-medium border transition ease-in-out duration-150 disabled:cursor-not-allowed border-gray-300 focus:border-indigo-500 dark:border-gray-600 dark:focus:border-indigo-500 text-gray-700 active:text-gray-800 hover:text-gray-500 dark:text-gray-200 dark:active:text-white dark:hover:text-white bg-white active:bg-gray-50 dark:bg-gray-800 dark:active:bg-gray-900 dark:hover:bg-gray-750 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:focus:ring-indigo-700 px-3 py-2 text-sm leading-5 rounded-md\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ArrowLeftIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t<div className=\"flex-1 flex items-center justify-center text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t{format(context, 'MMMM yyyy')}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tonClick={() => setContext((c) => addMonths(c, 1))}\n\t\t\t\t\t\t\t\t\tclassName=\"inline-flex items-center font-medium border transition ease-in-out duration-150 disabled:cursor-not-allowed border-gray-300 focus:border-indigo-500 dark:border-gray-600 dark:focus:border-indigo-500 text-gray-700 active:text-gray-800 hover:text-gray-500 dark:text-gray-200 dark:active:text-white dark:hover:text-white bg-white active:bg-gray-50 dark:bg-gray-800 dark:active:bg-gray-900 dark:hover:bg-gray-750 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:focus:ring-indigo-700 px-3 py-2 text-sm leading-5 rounded-md\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ArrowRightIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"p-4 grid grid-cols-7\">\n\t\t\t\t\t\t\t\t{weekDays.map((day, i) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded m-1 cursor-default text-sm text-gray-400\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{day}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t\t{preDays.map((day, i) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded text-gray-300 dark:text-gray-500 m-1 cursor-default text-sm font-medium\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t\t{days.map((day, i) => (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t'col-span-1 w-7 h-7 flex items-center justify-center rounded m-2 cursor-pointer disabled:pointer-events-none text-sm font-medium hover:bg-indigo-100 dark:hover:bg-gray-800 disabled:opacity-50',\n\t\t\t\t\t\t\t\t\t\t\tisSameDay(new Date(), day) && 'text-indigo-400 ring-2 ring-indigo-300',\n\t\t\t\t\t\t\t\t\t\t\tvalue && isSameDay(ensureDate(value), day) && 'bg-indigo-600 text-white'\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => select(day)}\n\t\t\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\t\t\t(minDate && isBefore(day, minDate)) ||\n\t\t\t\t\t\t\t\t\t\t\t(maxDate && isAfter(day, maxDate)) ||\n\t\t\t\t\t\t\t\t\t\t\t(disableHolidays && !!getReservedDate(day))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttitle={getReservedDate(day)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t\t{postDays.map((day, i) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded text-gray-300 dark:text-gray-500 m-1 cursor-default text-sm font-medium\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</label>\n\n\t\t\t{description && !error && !touched && <p className=\"mt-2 text-sm text-gray-500\">{description}</p>}\n\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t</div>\n\t)\n}\n\nexport default FormDate\n","import { FC, useState } from 'react'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport { RouteComponentProps } from '@reach/router'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport Card from '@primer/components/Card'\nimport db from 'db'\nimport Actions from '@primer/components/Actions'\nimport { ArrowLeftIcon, CheckIcon } from '@heroicons/react/outline'\nimport Stack from '@primer/components/Stack'\nimport FormDate from '@primer/components/Form/FormDate'\nimport FormToggle from '@primer/components/Form/FormToggle'\nimport { entityResource } from 'db/types'\n\ninterface FormSchema {\n\tfields: {\n\t\t[x: string]: {\n\t\t\tid?: string\n\t\t\tvalue: string\n\t\t}\n\t}\n}\n\nconst UnitForm: FC<RouteComponentProps<{ entityId: string; mode: 'create' | 'edit'; id: string }>> = ({\n\tentityId = '',\n\tmode,\n\tid = '',\n}) => {\n\tconst entity = entityResource(entityId)\n\tconst fields = entity?.fields\n\n\tconst [initialValues] = useState<FormSchema>({\n\t\tfields:\n\t\t\tfields?.reduce((list, field) => {\n\t\t\t\tlet value = field.value(id)\n\t\t\t\tlet key = field?.key || ''\n\t\t\t\tlet defaultValue = field?.defaultValue\n\t\t\t\tlet type = field?.type\n\t\t\t\tlet valueData = value\n\n\t\t\t\tif (valueData) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...list,\n\t\t\t\t\t\t[key]: {\n\t\t\t\t\t\t\tid: valueData?.id,\n\t\t\t\t\t\t\tvalue: valueData?.value || '',\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...list,\n\t\t\t\t\t\t[key]: {\n\t\t\t\t\t\t\tid: undefined,\n\t\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\t\ttype === 'string'\n\t\t\t\t\t\t\t\t\t? defaultValue || ''\n\t\t\t\t\t\t\t\t\t: type === 'date'\n\t\t\t\t\t\t\t\t\t? defaultValue\n\t\t\t\t\t\t\t\t\t\t? new Date(defaultValue || '').toISOString()\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t: type === 'boolean'\n\t\t\t\t\t\t\t\t\t? defaultValue?.toLowerCase() === 'true' || 'false'\n\t\t\t\t\t\t\t\t\t: type === 'number'\n\t\t\t\t\t\t\t\t\t? defaultValue || ''\n\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, {}) || {},\n\t})\n\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues,\n\t\tonSubmit: (formData) => {\n\t\t\tif (!entityId) return\n\n\t\t\tlet newUnit = db.units.save({ entityId, ...(id ? { id } : {}) })\n\n\t\t\tObject.entries(formData.fields).forEach(([key, field]) => {\n\t\t\t\tlet entityField = db.fields.find((x) => x.key === key)\n\n\t\t\t\tif (!entityField) return\n\n\t\t\t\tlet save = initialValues.fields[entityField.key].value !== field.value\n\n\t\t\t\tif (save || !field.id) {\n\t\t\t\t\t// console.log('value is', typeof field.value)\n\t\t\t\t\tdb.values.save({\n\t\t\t\t\t\tvalue: String(field.value),\n\t\t\t\t\t\tid: '',\n\t\t\t\t\t\tunitId: newUnit.id,\n\t\t\t\t\t\tfieldId: entityField?.id,\n\t\t\t\t\t\tcreated: String(new Date().valueOf()),\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// navigate(`${process.env.PUBLIC_URL}/${entity?.key}`)\n\t\t\twindow.history.back()\n\t\t},\n\t})\n\n\tconst title = mode === 'create' ? `Create ${entity?.plural}` : `Edit ${entity?.name}`\n\n\treturn (\n\t\t<Form context={formContext}>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: `/${entity?.key}`,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Stack>\n\t\t\t\t\t<Card>\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t{fields?.map((field) =>\n\t\t\t\t\t\t\t\tfield?.type === 'string' ? (\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tkey={field?.key}\n\t\t\t\t\t\t\t\t\t\tname={`fields.${field?.key}.value`}\n\t\t\t\t\t\t\t\t\t\tlabel={field?.name}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : field?.type === 'number' ? (\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tkey={field?.key}\n\t\t\t\t\t\t\t\t\t\tname={`fields.${field?.key}.value`}\n\t\t\t\t\t\t\t\t\t\tlabel={field?.name}\n\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : field?.type === 'date' ? (\n\t\t\t\t\t\t\t\t\t<FormDate\n\t\t\t\t\t\t\t\t\t\tkey={field?.key}\n\t\t\t\t\t\t\t\t\t\tname={`fields.${field?.key}.value`}\n\t\t\t\t\t\t\t\t\t\tlabel={field?.name}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : field?.type === 'boolean' ? (\n\t\t\t\t\t\t\t\t\t<FormToggle\n\t\t\t\t\t\t\t\t\t\tkey={field?.key}\n\t\t\t\t\t\t\t\t\t\tname={`fields.${field?.key}.value`}\n\t\t\t\t\t\t\t\t\t\tlabel={field?.name}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : field?.type === 'option' ? (\n\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\tkey={field?.key}\n\t\t\t\t\t\t\t\t\t\tname={`fields.${field?.key}.value`}\n\t\t\t\t\t\t\t\t\t\tlabel={field?.name}\n\t\t\t\t\t\t\t\t\t\toptions={field?.options.map((x) => ({ label: x, value: x })) || []}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</Card>\n\t\t\t\t\t<div className=\"flex items-center justify-end\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: mode === 'create' ? 'Create' : 'Save',\n\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\tdisabled: formContext.isSubmitting,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageContent>\n\t\t</Form>\n\t)\n}\n\nexport default UnitForm\n","import { FC } from 'react'\nimport ReactSelect from 'react-select'\nimport clsx, { ClassValue } from 'clsx'\nimport { XIcon } from '@heroicons/react/outline'\n\ninterface Option {\n\tlabel: string\n\tvalue: any\n}\n\ninterface SelectProps {\n\tvalue: any\n\tonChange: (value: any) => void\n\tonBlur?: () => void\n\toptions: Option[]\n\tclearable?: boolean\n\tdisabled?: boolean\n\tplaceholder?: string\n\tclassName?: ClassValue\n}\n\nconst Select: FC<SelectProps> = ({\n\tvalue,\n\tonChange,\n\tonBlur,\n\toptions,\n\tclearable,\n\tdisabled = false,\n\tplaceholder,\n\tclassName,\n\tonChange: onChangeProp,\n}) => {\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<ReactSelect\n\t\t\t\toptions={options}\n\t\t\t\tvalue={\n\t\t\t\t\toptions.find((x) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tx.value === value ||\n\t\t\t\t\t\t\tx.value === +value ||\n\t\t\t\t\t\t\t(x.value?.id !== undefined && x.value?.id === value?.id)\n\t\t\t\t\t\t)\n\t\t\t\t\t}) || null\n\t\t\t\t}\n\t\t\t\tonChange={(option: any) => {\n\t\t\t\t\tonChange(option ? option.value : null)\n\t\t\t\t\tif (onChangeProp) onChangeProp(option ? option.value : null)\n\t\t\t\t}}\n\t\t\t\tonBlur={onBlur}\n\t\t\t\tinputProps={{ autoComplete: 'none', autoCorrect: 'off', spellCheck: 'off' }}\n\t\t\t\tclassName=\"react-select-container\"\n\t\t\t\tclassNamePrefix=\"react-select\"\n\t\t\t\tplaceholder={placeholder}\n\t\t\t\tisClearable={clearable}\n\t\t\t\tisDisabled={disabled}\n\t\t\t\tmenuPlacement=\"auto\"\n\t\t\t\ttheme={(theme) => ({\n\t\t\t\t\t...theme,\n\t\t\t\t\tcolors: {\n\t\t\t\t\t\t...theme.colors,\n\t\t\t\t\t\tprimary25: '#f0f5ff',\n\t\t\t\t\t\tprimary: '#5850ec',\n\t\t\t\t\t},\n\t\t\t\t})}\n\t\t\t\tcomponents={{\n\t\t\t\t\tClearIndicator: ({ hasValue, innerProps: { ref, ...restInnerProps } }) => {\n\t\t\t\t\t\treturn hasValue ? (\n\t\t\t\t\t\t\t<span ref={ref} {...restInnerProps}>\n\t\t\t\t\t\t\t\t<XIcon className=\"mr-8 w-5 h-5 cursor-pointer text-gray-400 hover:text-red-500\" />\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t) : null\n\t\t\t\t\t},\n\t\t\t\t\tDropdownIndicator: ({ innerProps: { ref, ...restInnerProps } }) => null,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t)\n}\n\nexport default Select\n","import { FC, useEffect, useState } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { usePopper } from '@primer/hooks/usePopper'\nimport { Placement } from '@popperjs/core/index'\nimport { ArrowLeftIcon, ArrowRightIcon } from '@heroicons/react/outline'\nimport useDismissable from '@primer/hooks/useDismissable'\nimport {\n\taddDays,\n\taddMonths,\n\tendOfMonth,\n\tformat,\n\tgetDaysInMonth,\n\tgetISODay,\n\tisSameDay,\n\tparse,\n\tstartOfMonth,\n\tsubDays,\n\tsubMonths,\n} from 'date-fns'\nimport { ensureDate, isValidDate } from '@primer/utils/funcs'\n\nconst weekDays = ['Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa', 'Su']\n\nconst isDate = (x: any): x is Date => x && x instanceof Date && isValidDate(x)\n\ninterface DatePickerProps {\n\tvalue: Date | null\n\tonChange: (x: Date | null) => void\n\tonBlur?: () => void\n\tplaceholder?: string\n\tplacement?: Placement\n\toffset?: number | [number, number]\n\tdisabled?: boolean\n\tinputDisabled?: boolean\n\thasError?: boolean\n\tclassName?: ClassValue\n\tinputClassName?: ClassValue\n}\n\nconst DatePicker: FC<DatePickerProps> = ({\n\tvalue,\n\tonChange,\n\tonBlur,\n\tplaceholder = 'DD/MM/YYYY',\n\tplacement = 'bottom-end',\n\toffset = 10,\n\tdisabled,\n\tinputDisabled,\n\thasError,\n\tclassName,\n\tinputClassName,\n}) => {\n\tconst [display, setDisplay] = useState(isDate(value) ? format(value, 'dd/MM/yyyy') : '')\n\tconst [context, setContext] = useState<Date>(startOfMonth(isDate(value) ? value : new Date()))\n\tconst [prevValue, setPrevValue] = useState<Date | null | undefined>()\n\n\tuseEffect(() => {\n\t\tif (prevValue !== value && value) {\n\t\t\tlet ensuredDate = ensureDate(value)\n\t\t\tsetDisplay(isDate(ensuredDate) ? format(ensuredDate, 'dd/MM/yyyy') : '')\n\t\t\tsetPrevValue(value)\n\t\t}\n\t}, [prevValue, value])\n\n\tconst {\n\t\topen,\n\t\tsetOpen,\n\t\tignoreClass,\n\t\tref: dismissableRef,\n\t} = useDismissable({\n\t\tonOpen: () => {\n\t\t\tconst hasValue = isDate(value)\n\n\t\t\tsetDisplay(hasValue ? format(value, 'dd/MM/yyyy') : '')\n\t\t\tsetContext(hasValue ? value : new Date())\n\t\t},\n\t})\n\n\tconst [reference, tooltip] = usePopper({\n\t\tplacement,\n\t\tstrategy: 'fixed',\n\t\tmodifiers: [\n\t\t\t{\n\t\t\t\tname: 'offset',\n\t\t\t\toptions: { offset: offset instanceof Array ? offset : [0, offset] },\n\t\t\t},\n\t\t],\n\t})\n\n\tconst preDays = new Array(getISODay(startOfMonth(context)) - 1)\n\t\t.fill(null)\n\t\t.map((_, i) => subDays(endOfMonth(subMonths(context, 1)), i))\n\t\t.reverse()\n\n\tconst postDays = new Array(7 - getISODay(endOfMonth(context)))\n\t\t.fill(null)\n\t\t.map((_, i) => addDays(startOfMonth(addMonths(context, 1)), i))\n\n\tconst days = new Array(getDaysInMonth(context)).fill(null).map((_, i) => addDays(startOfMonth(context), i))\n\n\tconst select = (day: Date) => {\n\t\tonChange(day)\n\t\tsetOpen(false)\n\n\t\tsetDisplay(format(day, 'dd/MM/yyyy'))\n\t}\n\n\treturn (\n\t\t<div className={clsx(className)} ref={dismissableRef}>\n\t\t\t<div className={clsx('relative rounded-md')}>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tvalue={display}\n\t\t\t\t\tonChange={(e) => setDisplay(e.target.value)}\n\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tref={reference}\n\t\t\t\t\tonClick={() => setOpen(true)}\n\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\tif (inputDisabled) {\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetOpen(false)\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tonBlur={() => {\n\t\t\t\t\t\tif (!display) {\n\t\t\t\t\t\t\tonChange(null)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet displayDate = parse(display, 'dd/MM/yyyy', new Date())\n\n\t\t\t\t\t\t\tif (isValidDate(displayDate)) {\n\t\t\t\t\t\t\t\tonChange(displayDate)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetDisplay(isDate(value) ? format(value, 'dd/MM/yyyy') : '')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (onBlur) onBlur()\n\t\t\t\t\t}}\n\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t'form-input block w-full sm:text-sm sm:leading-5',\n\t\t\t\t\t\thasError &&\n\t\t\t\t\t\t\t'pr-10 border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500',\n\t\t\t\t\t\tinputClassName,\n\t\t\t\t\t\tignoreClass\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<div className={clsx(!open && 'hidden', 'z-10')} ref={tooltip}>\n\t\t\t\t\t<div className=\"mt rounded-md shadow-lg bg-white dark:bg-gray-700 w-80 overflow-hidden\">\n\t\t\t\t\t\t<div className=\"flex items-center dark:bg-gray-750 p-4 border-b border-gray-100 dark:border-gray-600\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={() => setContext((c) => subMonths(c, 1))}\n\t\t\t\t\t\t\t\tclassName=\"inline-flex items-center font-medium border transition ease-in-out duration-150 disabled:cursor-not-allowed border-gray-300 focus:border-indigo-500 dark:border-gray-600 dark:focus:border-indigo-500 text-gray-700 active:text-gray-800 hover:text-gray-500 dark:text-gray-200 dark:active:text-white dark:hover:text-white bg-white active:bg-gray-50 dark:bg-gray-800 dark:active:bg-gray-900 dark:hover:bg-gray-750 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:focus:ring-indigo-700 px-3 py-2 text-sm leading-5 rounded-md\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ArrowLeftIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t<div className=\"flex-1 flex items-center justify-center text-sm font-medium\">\n\t\t\t\t\t\t\t\t{format(context, 'MMMM yyyy')}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={() => setContext((c) => addMonths(c, 1))}\n\t\t\t\t\t\t\t\tclassName=\"inline-flex items-center font-medium border transition ease-in-out duration-150 disabled:cursor-not-allowed border-gray-300 focus:border-indigo-500 dark:border-gray-600 dark:focus:border-indigo-500 text-gray-700 active:text-gray-800 hover:text-gray-500 dark:text-gray-200 dark:active:text-white dark:hover:text-white bg-white active:bg-gray-50 dark:bg-gray-800 dark:active:bg-gray-900 dark:hover:bg-gray-750 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:focus:ring-indigo-700 px-3 py-2 text-sm leading-5 rounded-md\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ArrowRightIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"p-4 grid grid-cols-7\">\n\t\t\t\t\t\t\t{weekDays.map((day, i) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded m-1 cursor-default text-sm text-gray-400\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{day}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t{preDays.map((day, i) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded text-gray-300 dark:text-gray-500 m-1 cursor-default text-sm font-medium\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t{days.map((day, i) => (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t'col-span-1 w-7 h-7 flex items-center justify-center rounded m-2 cursor-pointer text-sm font-medium hover:bg-indigo-100 dark:hover:bg-gray-800',\n\t\t\t\t\t\t\t\t\t\tisSameDay(new Date(), day) && 'text-indigo-400 ring-2 ring-indigo-300',\n\t\t\t\t\t\t\t\t\t\tvalue && isSameDay(ensureDate(value), day) && 'bg-indigo-600 text-white'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tonClick={() => select(day)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t{postDays.map((day, i) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tclassName=\"col-span-1 w-8 h-8 flex items-center justify-center rounded text-gray-300 dark:text-gray-500 m-1 cursor-default text-sm font-medium\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{format(day, 'd')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default DatePicker\n","import { FC, useState } from 'react'\nimport { RouteComponentProps } from '@reach/router'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport Actions from '@primer/components/Actions'\nimport { ArrowLeftIcon, ChevronDownIcon, ChevronUpIcon, PencilIcon } from '@heroicons/react/outline'\nimport { FieldModel, unitResource, valueResource, ValueResource } from 'db/types'\nimport clsx from 'clsx'\nimport Card, { CardContent, CardWrapper } from '@primer/components/Card'\nimport { isNotNone } from '@primer/types'\nimport { formatRelative } from 'date-fns'\nimport CardHeader from '@primer/components/CardHeader'\nimport Select from '@primer/components/Select'\nimport Stack from '@primer/components/Stack'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport DatePicker from '@primer/components/DatePicker'\nimport AutoHeight from '@primer/components/AutoHeight'\n\nconst UnitHistory: FC<RouteComponentProps<{ id: string }>> = ({ id = '' }) => {\n\tconst unit = unitResource(id)\n\tconst entity = unit?.entity\n\n\tconst values = unit?.values || []\n\n\tconst history = values\n\t\t.reduce<ValueResource[]>((list, value) => {\n\t\t\tlet history = value.history.map(valueResource).filter(isNotNone)\n\t\t\treturn [...list, ...history]\n\t\t}, [])\n\t\t.sort((a: ValueResource, b: ValueResource) => {\n\t\t\treturn new Date(b.created).valueOf() - new Date(a.created).valueOf()\n\t\t})\n\n\tconst title = `${entity?.name} History`\n\n\tconst [open, setOpen] = useState(false)\n\n\tconst [fieldFilter, setFieldFilter] = useState<FieldModel | null>(null)\n\tconst [dateFromFilter, setDateFromFilter] = useState<Date | null>(null)\n\tconst [dateToFilter, setDateToFilter] = useState<Date | null>(null)\n\tconst [userFilter, setUserFilter] = useState<string | null>(null)\n\n\tconst filteredHistory = history\n\t\t.filter((val) => {\n\t\t\tif (fieldFilter === null) return true\n\t\t\treturn val.fieldId === fieldFilter.id\n\t\t})\n\t\t.filter((val) => {\n\t\t\tif (dateFromFilter === null) return true\n\t\t\treturn new Date(val.created).valueOf() > dateFromFilter.valueOf()\n\t\t})\n\t\t.filter((val) => {\n\t\t\tif (dateToFilter === null) return true\n\t\t\treturn new Date(val.created).valueOf() < dateToFilter.valueOf()\n\t\t})\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: `/${entity?.key}/${id}`,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Stack>\n\t\t\t\t\t<CardWrapper>\n\t\t\t\t\t\t<CardHeader\n\t\t\t\t\t\t\ttitle=\"Filter\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ticon: open ? (\n\t\t\t\t\t\t\t\t\t\t<ChevronUpIcon className=\"w-5 h-5\" />\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<ChevronDownIcon className=\"w-5 h-5\" />\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tintent: 'menu',\n\t\t\t\t\t\t\t\t\tonClick: () => setOpen((x) => !x),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<AutoHeight show={open}>\n\t\t\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-1\">\n\t\t\t\t\t\t\t\t\t\t<FormLabel>Field</FormLabel>\n\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\t\tvalue={fieldFilter}\n\t\t\t\t\t\t\t\t\t\t\tonChange={setFieldFilter}\n\t\t\t\t\t\t\t\t\t\t\toptions={entity?.fields.map((x) => ({ value: x, label: x.name })) || []}\n\t\t\t\t\t\t\t\t\t\t\tclearable\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-1\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-1\">\n\t\t\t\t\t\t\t\t\t\t<FormLabel>User</FormLabel>\n\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\t\tvalue={userFilter}\n\t\t\t\t\t\t\t\t\t\t\tonChange={setUserFilter}\n\t\t\t\t\t\t\t\t\t\t\toptions={[{ value: 'user', label: 'User' }]}\n\t\t\t\t\t\t\t\t\t\t\tclearable\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-1\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-1\">\n\t\t\t\t\t\t\t\t\t\t<FormLabel>Created From</FormLabel>\n\t\t\t\t\t\t\t\t\t\t<DatePicker\n\t\t\t\t\t\t\t\t\t\t\tvalue={dateFromFilter}\n\t\t\t\t\t\t\t\t\t\t\tonChange={setDateFromFilter}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-1\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-1\">\n\t\t\t\t\t\t\t\t\t\t<FormLabel>Created To</FormLabel>\n\t\t\t\t\t\t\t\t\t\t<DatePicker value={dateToFilter} onChange={setDateToFilter} className=\"mt-1\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</CardContent>\n\t\t\t\t\t\t</AutoHeight>\n\t\t\t\t\t</CardWrapper>\n\n\t\t\t\t\t<Card>\n\t\t\t\t\t\t<div className=\"flow-root\">\n\t\t\t\t\t\t\t<ul className=\"-mb-8\">\n\t\t\t\t\t\t\t\t{filteredHistory.map((value, i) => (\n\t\t\t\t\t\t\t\t\t<li key={value.id}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative pb-8\">\n\t\t\t\t\t\t\t\t\t\t\t{i !== filteredHistory.length - 1 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'bg-primary-600',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'h-8 w-8 rounded-full flex items-center justify-center ring-8 ring-white'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<PencilIcon className=\"h-5 w-5 text-white\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"min-w-0 flex-1 pt-0 flex justify-between space-x-4\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{value.field?.name} set to{' '}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<strong className=\"font-medium text-gray-900\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"{value.formatted}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</strong>{' '}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tby <a href=\"/\">User</a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-right text-sm whitespace-nowrap text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<time dateTime={value.created}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatRelative(new Date(value.created || 0), new Date())}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</time>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Card>\n\t\t\t\t</Stack>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default UnitHistory\n","export default __webpack_public_path__ + \"static/media/bg-grid.98c0f05a.svg\";","import { FC, ReactNode } from 'react'\nimport bg from 'assets/img/bg-grid.svg'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface CanvasProps {\n\tclassName?: ClassValue\n\tnoBackground?: boolean\n\tchildren: ReactNode\n}\n\nconst Canvas: FC<CanvasProps> = ({ className, noBackground, children }) => {\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx('h-screen bg-gray-200 dark:bg-gray-800', className)}\n\t\t\tstyle={!noBackground ? { backgroundImage: `url(${bg})` } : {}}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\nexport default Canvas\n","import clsx from 'clsx'\nimport Dragger from 'components/Builder/Dragger'\nimport { HandleIcon } from 'components/Icon'\nimport { FC } from 'react'\nimport { Tool } from '../utils'\n\nconst DraggableTool: FC<{ tool: Tool }> = ({ tool }) => {\n\treturn (\n\t\t<Dragger\n\t\t\ttype={tool.type}\n\t\t\titem={tool}\n\t\t\tclassName={({ isDragging }) =>\n\t\t\t\tclsx(\n\t\t\t\t\t'py-2 px-1 hover:pl-2.5 rounded-sm bg-white hover:ring-2 hover:ring-primary-500 transition-all duration-100 cursor-[grab] flex items-center justify-start space-x-3 hover:relative z-10',\n\t\t\t\t\tisDragging && 'opacity-50'\n\t\t\t\t)\n\t\t\t}\n\t\t>\n\t\t\t<HandleIcon className=\"w-5 h-5\" />\n\n\t\t\t<div>\n\t\t\t\t<div className=\"text-sm font-medium\">{tool.name}</div>\n\t\t\t\t<div className=\"text-xs text-gray-400\">{tool.description}</div>\n\t\t\t</div>\n\t\t</Dragger>\n\t)\n}\n\nexport default DraggableTool\n","import { FC, Fragment, useState } from 'react'\nimport { lensPath, over, set } from 'ramda'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport PageContent from '@primer/components/PageContent'\nimport Stack from '@primer/components/Stack'\nimport { PageBuilderProvider, Path } from './utils'\nimport DropTarget from './components/DropTarget'\nimport { uuid } from 'utils/funcs'\nimport Actions from '@primer/components/Actions'\nimport { ArrowLeftIcon, CheckIcon, TemplateIcon } from '@heroicons/react/outline'\nimport { DndProvider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\nimport { unitResource } from 'db/types'\nimport db from 'db'\nimport Canvas from 'components/Layouts/Canvas'\nimport { Widget } from './utils'\nimport { tools, builds } from './Widgets'\nimport DraggableTool from './components/DraggableTool'\n\nconst PageBuilder: FC<RouteComponentProps<{ id: string; keyName: string }>> = ({ id, keyName }) => {\n\tconst unit = unitResource(id || '-')\n\tconst entity = unit?.entity\n\tconst plan = entity?.plan(keyName || '-')\n\n\tconst [name, setName] = useState(plan?.name || 'Page name')\n\n\tconst [itemList, setItemList] = useState<{ items: Widget[] }>(\n\t\tJSON.parse(plan?.structure || 'null') || { items: [] }\n\t)\n\n\tconst save = () => {\n\t\tif (!entity || !keyName) return\n\n\t\tlet structure = JSON.stringify(itemList)\n\n\t\tif (plan?.data) {\n\t\t\tdb.plans.save({\n\t\t\t\t...(plan.data || {}),\n\t\t\t\tname,\n\t\t\t\tstructure,\n\t\t\t})\n\t\t} else {\n\t\t\tdb.plans.save({\n\t\t\t\tid: uuid(),\n\t\t\t\tentityId: entity.id,\n\t\t\t\tkey: keyName,\n\t\t\t\tname,\n\t\t\t\tstructure,\n\t\t\t})\n\t\t}\n\n\t\tnavigate(`${process.env.PUBLIC_URL}/${entity?.key}/${unit?.id}`)\n\t}\n\n\tconst addItem = (path: Path, data: Widget) => {\n\t\tsetItemList((l) => {\n\t\t\tlet pathStart = path.slice(0, -1)\n\t\t\tlet index = path.slice(-1)\n\n\t\t\tlet newItemList = over(\n\t\t\t\tlensPath(pathStart),\n\t\t\t\t(arr) => {\n\t\t\t\t\tlet before = arr.slice(0, index)\n\t\t\t\t\tlet after = arr.slice(index)\n\n\t\t\t\t\treturn [...before, data, ...after]\n\t\t\t\t},\n\t\t\t\tl\n\t\t\t)\n\n\t\t\treturn newItemList\n\t\t})\n\n\t\t// interesting feature, might get annoying?\n\t\t// // @ts-ignore\n\t\t// editors[data.type]({ path, item: data, removeItem, updateItem })\n\t}\n\n\tconst removeItem = (path: Path) => {\n\t\tsetItemList((l) => {\n\t\t\tlet pathStart = path.slice(0, -1)\n\t\t\tlet index = path.slice(-1)\n\n\t\t\tlet newItemList = over(\n\t\t\t\tlensPath(pathStart),\n\t\t\t\t(arr) => {\n\t\t\t\t\tlet before = arr.slice(0, index)\n\t\t\t\t\tlet after = arr.slice(+index + 1)\n\n\t\t\t\t\treturn [...before, ...after]\n\t\t\t\t},\n\t\t\t\tl\n\t\t\t)\n\n\t\t\treturn newItemList\n\t\t})\n\t}\n\n\tconst updateItem = (path: Path, newValue: unknown) => {\n\t\tsetItemList((l) => {\n\t\t\tlet newItemList = set(lensPath(path), newValue, l)\n\n\t\t\treturn newItemList\n\t\t})\n\t}\n\n\treturn (\n\t\t<DndProvider backend={HTML5Backend}>\n\t\t\t<PageBuilderProvider value={{ entity, itemList, addItem, removeItem, updateItem }}>\n\t\t\t\t<Canvas className=\"flex flex-col\">\n\t\t\t\t\t<div className=\"flex justify-between bg-white shadow h-16\">\n\t\t\t\t\t\t<div className=\"flex items-center p-4 border-r border-gray-300\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\t\tonClick: () => window.history.back(),\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-1 flex items-center px-6 border-r border-gray-300\">\n\t\t\t\t\t\t\t<div className=\"text-2xl font-medium\">Edit Page Plan</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex items-center px-6\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\tonClick: save,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className=\"flex-1 flex\">\n\t\t\t\t\t\t<div className=\"w-80 min-w-80 bg-white shadow border-t border-gray-200\">\n\t\t\t\t\t\t\t<div className=\"p-4 size-lg font-medium border-b border-gray-200 flex items-center space-between space-x-4\">\n\t\t\t\t\t\t\t\t<TemplateIcon className=\"w-5 h-5 text-gray-500\" />\n\t\t\t\t\t\t\t\t<div className=\"flex-1\">Page Elements</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Stack className=\"p-4\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t{Object.entries(tools).map(([type, tool]) => (\n\t\t\t\t\t\t\t\t\t\t<Fragment key={type}>\n\t\t\t\t\t\t\t\t\t\t\t<DraggableTool tool={tool} />\n\t\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"group flex items-center h-6 w-full\">\n\t\t\t\t\t\t\t\t\t<div className=\"group-hover:ring-2 ring-primary-500 transition-all duration-100 h-1 group-hover:bg-primary-500 rounded-full w-full\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<PageContent className=\"py-6\">\n\t\t\t\t\t\t\t<div className=\"flex items-center space-x-1 mb-6 mt-2\">\n\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2 text-primary-500\" />,\n\t\t\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setName(e.target.value)}\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1 flex items-center text-2xl leading-8 font-semibold text-gray-900 dark:text-white sm:text-3xl sm:leading-9 whitespace-nowrap bg-transparent border-none focus:ring-2 focus:ring-primary-500 rounded-md\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<Stack space={2}>\n\t\t\t\t\t\t\t\t{itemList.items.map((item, i) => (\n\t\t\t\t\t\t\t\t\t<Fragment key={item.id}>\n\t\t\t\t\t\t\t\t\t\t<DropTarget path={['items', i]} isFirst={i === 0} accept={Object.keys(tools)} />\n\t\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t\tlet BuildComp = builds[item.type]\n\n\t\t\t\t\t\t\t\t\t\t\tif (BuildComp) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn <BuildComp path={['items', i]} />\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<DropTarget\n\t\t\t\t\t\t\t\t\tpath={['items', itemList.items.length]}\n\t\t\t\t\t\t\t\t\tisFirst={itemList.items.length === 0}\n\t\t\t\t\t\t\t\t\tisLast\n\t\t\t\t\t\t\t\t\taccept={Object.keys(tools)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</PageContent>\n\t\t\t\t\t</div>\n\t\t\t\t</Canvas>\n\t\t\t</PageBuilderProvider>\n\t\t</DndProvider>\n\t)\n}\n\nexport default PageBuilder\n","import { FC } from 'react'\nimport Card from '@primer/components/Card'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport { RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport { valueResource } from 'db/types'\n\nconst ValueHistory: FC<RouteComponentProps<{ id: string }>> = ({ id = '' }) => {\n\tconst value = valueResource(id)\n\tconst field = value?.field\n\tconst entity = field?.entity\n\tconst unit = value?.unit\n\n\tconst title = `History of ${field?.name}`\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: `/${entity?.key}/${unit?.id}`,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Card>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t{value?.history.map((x) => (\n\t\t\t\t\t\t\t<li key={x.id}>{x.value}</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t</Card>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default ValueHistory\n","import { FC } from 'react'\nimport { useLocation, navigate, RouteComponentProps } from '@reach/router'\nimport { MailIcon, AcademicCapIcon, CubeIcon, PuzzleIcon, DocumentTextIcon, CogIcon } from '@heroicons/react/outline'\nimport { WorkflowIcon } from 'components/Icon'\n\nexport const links = [\n\t{\n\t\ttitle: 'Entities',\n\t\tto: '/settings/entities',\n\t\ticon: <CubeIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Roles',\n\t\tto: `/settings/roles`,\n\t\ticon: <AcademicCapIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Templates',\n\t\tto: `/settings/templates`,\n\t\ticon: <DocumentTextIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Notifications',\n\t\tto: '/settings/notifications',\n\t\ticon: <MailIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Workflows',\n\t\tto: '/settings/workflows',\n\t\ticon: <WorkflowIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Modules',\n\t\tto: '/settings/modules',\n\t\ticon: <PuzzleIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n\t{\n\t\ttitle: 'Site Settings',\n\t\tto: '/settings/site-settings',\n\t\ticon: <CogIcon className=\"w-5 h-5\" />,\n\t\tshow: () => true,\n\t\texact: true,\n\t},\n]\n\nconst Admin: FC<RouteComponentProps> = ({ children }) => {\n\tconst location = useLocation()\n\n\tif (location.pathname === '/settings') {\n\t\tnavigate(links[0].to)\n\t\treturn null\n\t}\n\n\treturn <>{children}</>\n}\n\nexport default Admin\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { isAnchorRouteConfig, isLinkRouteConfig, isNotNone, RouteConfig } from '@primer/types'\nimport { LinkGetProps, Link } from '@reach/router'\nimport { ExternalLinkIcon } from '@heroicons/react/outline'\nimport Tooltip from './Tooltip'\n\ntype IntentValue = 'primary' | 'secondary' | 'white'\n\nconst intents = {\n\tprimary: {\n\t\twrapper: 'bg-gray-800 dark:bg-gray-900 antialiased',\n\t\tlink: {\n\t\t\tactive: 'text-white bg-gray-700 dark:bg-gray-700 focus:bg-gray-900 dark:focus:bg-gray-800',\n\t\t\tinactive:\n\t\t\t\t'text-gray-200 hover:text-white hover:bg-gray-900 focus:text-white focus:bg-gray-700 dark:hover:bg-gray-800',\n\t\t},\n\t\ttoggle: 'text-gray-400 hover:text-gray-300 hover:bg-gray-700',\n\t},\n\tsecondary: {\n\t\twrapper: 'bg-white dark:bg-gray-700 antialiased shadow',\n\t\tlink: {\n\t\t\tactive: 'text-primary-900 dark:text-gray-100 bg-primary-100 dark:bg-gray-800 focus:bg-gray-200 dark:focus:bg-gray-800',\n\t\t\tinactive:\n\t\t\t\t'text-gray-600 dark:text-gray-200 hover:text-gray-900 dark:hover:text-gray-200 dark:hover:bg-gray-600 hover:bg-primary-50 focus:text-gray-900 focus:bg-gray-100 dark:focus:bg-gray-800 dark:focus:text-gray-200',\n\t\t},\n\t\ttoggle: 'text-gray-400 hover:text-gray-500 hover:bg-gray-100',\n\t},\n\twhite: {\n\t\twrapper: 'bg-white antialiased shadow',\n\t\tlink: {\n\t\t\tactive: 'text-gray-900 bg-gray-50 focus:bg-gray-200',\n\t\t\tinactive: 'text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:text-gray-900 focus:bg-gray-100',\n\t\t},\n\t\ttoggle: 'text-gray-400 hover:text-gray-500 hover:bg-gray-100',\n\t},\n}\n\ninterface NavListProps {\n\tlinks: RouteConfig[]\n\tintent?: IntentValue\n\tmin?: boolean\n\tclassName?: ClassValue\n}\n\nconst NavList: FC<NavListProps> = ({ links, intent = 'secondary', min = false, className = null }) => {\n\treturn (\n\t\t<nav className={clsx('space-y-1', className)}>\n\t\t\t{links.filter(isNotNone).map((link, i) => (\n\t\t\t\t<NavLink key={i} link={link} intent={intent} min={min} />\n\t\t\t))}\n\t\t</nav>\n\t)\n}\n\ninterface NavLinkProps {\n\tlink: RouteConfig\n\tintent: IntentValue\n\tmin?: boolean\n}\n\nconst NavLink: FC<NavLinkProps> = ({ link, intent, min = false }) => {\n\treturn (\n\t\t<div>\n\t\t\t{link && (\n\t\t\t\t<Tooltip message={link.tooltip || link.title} enabled={min} intent=\"dark\">\n\t\t\t\t\t<MenuLink route={link} intent={intent}>\n\t\t\t\t\t\t<div className=\"opacity-75 pointer-events-none mr-3\">{link.icon}</div>\n\t\t\t\t\t\t<div className={clsx(min && 'lg:hidden')}>{link.title}</div>\n\t\t\t\t\t</MenuLink>\n\t\t\t\t</Tooltip>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nconst getProps =\n\t(route: RouteConfig, intent: IntentValue) =>\n\t({ isCurrent, isPartiallyCurrent }: LinkGetProps) => {\n\t\treturn (route.exact ? isCurrent : isPartiallyCurrent)\n\t\t\t? {\n\t\t\t\t\tclassName: clsx(\n\t\t\t\t\t\t'group flex items-center p-2 text-sm font-medium leading-5 rounded-l rounded-r transition ease-in-out duration-150 focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t\t\t\tintents[intent].link.active\n\t\t\t\t\t),\n\t\t\t  }\n\t\t\t: {\n\t\t\t\t\tclassName: clsx(\n\t\t\t\t\t\t'group flex items-center p-2 text-sm font-medium leading-5 rounded-l rounded-r transition ease-in-out duration-150 focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t\t\t\tintents[intent].link.inactive\n\t\t\t\t\t),\n\t\t\t  }\n\t}\n\nconst MenuLink = ({ route, intent, children }: { route: RouteConfig; intent: IntentValue; children: ReactNode }) => {\n\treturn isAnchorRouteConfig(route) ? (\n\t\t<a\n\t\t\thref={route.url}\n\t\t\tclassName={clsx(\n\t\t\t\t'group flex items-center justify-center p-2 text-sm leading-5 rounded-l rounded-r transition ease-in-out duration-150 focus:outline-none focus:ring-2 focus:ring-primary-500',\n\t\t\t\tintents[intent].link.inactive,\n\t\t\t\t'justify-center'\n\t\t\t)}\n\t\t\ttarget=\"_blank\"\n\t\t\trel=\"noopener noreferrer\"\n\t\t>\n\t\t\t<div className=\"flex items-center justify-center\">{children}</div>\n\n\t\t\t<div className=\"flex-1 flex justify-end\">\n\t\t\t\t<ExternalLinkIcon className=\"opacity-25 w-4 h-4\" />\n\t\t\t</div>\n\t\t</a>\n\t) : isLinkRouteConfig(route) ? (\n\t\t<Link to={`${process.env.PUBLIC_URL}${route.to}`} getProps={getProps(route, intent)}>\n\t\t\t{children}\n\t\t</Link>\n\t) : null\n}\n\nexport default NavList\n","import { FC, ReactNode } from 'react'\nimport { RouteConfig } from '@primer/types'\nimport NavList from '@primer/components/NavList'\nimport PageContent from '@primer/components/PageContent'\nimport { CardWrapper } from '@primer/components/Card'\nimport clsx, { ClassValue } from 'clsx'\nimport useLocalStorage from '@primer/hooks/useLocalStorage'\n\ninterface PageNavbarProps {\n\tlinks: RouteConfig[]\n\tclassName?: ClassValue\n\tchildren: ReactNode\n}\n\nconst PageNavbar: FC<PageNavbarProps> = ({ links, className, children }) => {\n\tconst [min, setMin] = useLocalStorage('case-min', false)\n\n\treturn (\n\t\t<PageContent className={className}>\n\t\t\t<CardWrapper className=\"relative\">\n\t\t\t\t<div className=\"max-w-full\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t'grid grid-cols-1 max-w-full',\n\t\t\t\t\t\t\tmin ? 'md:grid-cols-[62px,minmax(0,1fr)]' : 'md:grid-cols-[20rem,minmax(0,1fr)]'\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t\t<NavList links={links} min={min} />\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"relative mt-6 lg:mt-0 border-t lg:border-t-0 lg:border-l border-gray-200 dark:border-gray-600\">\n\t\t\t\t\t\t\t<div className=\"absolute top-0 left-0 h-full group z-10\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t'w-1 -ml-0.5 h-full bg-primary-600 opacity-0 group-hover:opacity-100 transition-opacity duration-100 ease-linear',\n\t\t\t\t\t\t\t\t\t\tmin ? 'cursor-right' : 'cursor-left'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tonClick={() => setMin(!min)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>{children}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</CardWrapper>\n\t\t</PageContent>\n\t)\n}\n\nexport default PageNavbar\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ntype SizeType = 'sm' | 'md'\n\nconst sizes = {\n\tsm: 'px-2 py-0.5 -my-0.5 text-xs leading-5',\n\tmd: 'px-2.5 py-0.5 -my-0.5 text-sm leading-6',\n}\n\ntype ThemeType = 'gray' | 'red' | 'green' | 'yellow' | 'green' | 'teal' | 'blue' | 'indigo' | 'purple' | 'pink'\n\nexport const themes = {\n\tgray: 'bg-gray-400 text-gray-800 dark:bg-gray-500 dark:text-gray-300 bg-opacity-25 dark:bg-opacity-25',\n\tred: 'bg-red-400 text-red-800 dark:bg-red-500 dark:text-red-300 bg-opacity-25 dark:bg-opacity-25',\n\torange: 'bg-green-400 text-green-800 dark:bg-green-500 dark:text-green-300 bg-opacity-25 dark:bg-opacity-25',\n\tyellow: 'bg-yellow-400 text-yellow-800 dark:bg-yellow-500 dark:text-yellow-300 bg-opacity-25 dark:bg-opacity-25',\n\tgreen: 'bg-green-400 text-green-800 dark:bg-green-500 dark:text-green-300 bg-opacity-25 dark:bg-opacity-25',\n\tteal: 'bg-teal-400 text-teal-800 dark:bg-teal-500 dark:text-teal-300 bg-opacity-25 dark:bg-opacity-25',\n\tblue: 'bg-blue-400 text-blue-800 dark:bg-blue-500 dark:text-blue-300 bg-opacity-25 dark:bg-opacity-25',\n\tindigo: 'bg-indigo-400 text-indigo-800 dark:bg-indigo-500 dark:text-indigo-300 bg-opacity-25 dark:bg-opacity-25',\n\tpurple: 'bg-purple-400 text-purple-800 dark:bg-purple-500 dark:text-purple-300 bg-opacity-25 dark:bg-opacity-25',\n\tpink: 'bg-pink-400 text-pink-800 dark:bg-pink-500 dark:text-pink-300 bg-opacity-25 dark:bg-opacity-25',\n}\n\nexport interface BadgeProps {\n\tcolor: ThemeType\n\tsize?: SizeType\n\ticon?: ReactNode\n\tclassName?: ClassValue\n\tchildren?: ReactNode\n}\n\nconst Badge: FC<BadgeProps> = ({ color, size = 'md', icon, className, children }) => {\n\treturn (\n\t\t<span\n\t\t\tclassName={clsx(`inline-flex items-center font-medium`, themes[color], sizes[size], 'rounded', className)}\n\t\t>\n\t\t\t{icon !== undefined ? (\n\t\t\t\ticon\n\t\t\t) : (\n\t\t\t\t<svg className=\"mr-2 h-2 w-2\" fill=\"currentColor\" viewBox=\"0 0 8 8\">\n\t\t\t\t\t<circle cx=\"4\" cy=\"4\" r=\"3\" />\n\t\t\t\t</svg>\n\t\t\t)}\n\t\t\t{children}\n\t\t</span>\n\t)\n}\n\nexport default Badge\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport {\n\tBeakerIcon,\n\tCheckIcon,\n\tDotsHorizontalIcon,\n\tPencilIcon,\n\tPlusIcon,\n\tTrashIcon,\n\tXIcon,\n} from '@heroicons/react/outline'\nimport Badge from '@primer/components/Badge'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport db from 'db'\nimport { NotificationModel } from 'db/types'\nimport { confirm } from '@primer/alerts'\n\nconst Notifications: FC<RouteComponentProps> = () => {\n\tconst schema: TableSchema<NotificationModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Enabled',\n\t\t\t\tvalue: (x) => (\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tcolor={x.enabled ? 'green' : 'red'}\n\t\t\t\t\t\ticon={x.enabled ? <CheckIcon className=\"w-5 h-5\" /> : <XIcon className=\"w-5 h-5\" />}\n\t\t\t\t\t/>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Edit',\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/settings/notifications/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Test',\n\t\t\t\t\t\t\ticon: <BeakerIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.notifications.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Notifications\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Notification',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/notifications/create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={db.notifications.all()} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Notifications\n","import { FC, ReactNode } from 'react'\nimport clsx from 'clsx'\nimport { ActionType } from '@primer/types'\nimport Actions from '@primer/components/Actions'\n\ninterface FormSectionProps {\n\ttitle: ReactNode\n\tsubtitle?: ReactNode\n\tactions?: ActionType | ActionType[]\n\tvertical?: boolean\n\tchildren: ReactNode\n}\n\nconst FormSection: FC<FormSectionProps> = ({ title, subtitle, actions, vertical = false, children }) => {\n\treturn (\n\t\t<div className={clsx(vertical ? 'flex flex-col space-y-6' : 'md:grid md:grid-cols-3 md:gap-6')}>\n\t\t\t<div className=\"md:col-span-1\">\n\t\t\t\t<h3 className=\"-mt-1 text-lg font-medium leading-6 text-gray-900 dark:text-white\">{title}</h3>\n\t\t\t\t{subtitle && <div className=\"mt-1 text-sm leading-5 text-gray-500 dark:text-gray-300\">{subtitle}</div>}\n\t\t\t\t{actions && (\n\t\t\t\t\t<div className=\"mt-2\">\n\t\t\t\t\t\t<Actions actions={actions} />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<div className=\"mt-5 md:mt-0 md:col-span-2\">{children}</div>\n\t\t</div>\n\t)\n}\n\nexport default FormSection\n","import { CalendarIcon, CursorClickIcon, RefreshIcon } from '@heroicons/react/outline'\nimport { ordinal } from '@primer/utils/funcs'\n\nexport const types = [\n\t{\n\t\tlabel: (\n\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t<CursorClickIcon className=\"w-5 h-5 text-gray-500\" />\n\t\t\t\t<div>Action</div>\n\t\t\t</div>\n\t\t),\n\t\tvalue: 'action',\n\t},\n\t{\n\t\tlabel: (\n\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t<RefreshIcon className=\"w-5 h-5 text-gray-500\" />\n\t\t\t\t<div>Repeat</div>\n\t\t\t</div>\n\t\t),\n\t\tvalue: 'repeat',\n\t},\n\t{\n\t\tlabel: (\n\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t<CalendarIcon className=\"w-5 h-5 text-gray-500\" />\n\t\t\t\t<div>Date</div>\n\t\t\t</div>\n\t\t),\n\t\tvalue: 'date',\n\t},\n]\n\nexport const repeatOptions = [\n\t{ label: 'day', value: 'day' },\n\t{ label: 'week', value: 'week' },\n\t{ label: 'month', value: 'month' },\n\t{ label: 'year', value: 'year' },\n]\n\nexport const weekOnOptions = [\n\t{ label: 'monday', value: 'monday' },\n\t{ label: 'tuesday', value: 'tuesday' },\n\t{ label: 'wednesday', value: 'wednesday' },\n\t{ label: 'thursday', value: 'thursday' },\n\t{ label: 'friday', value: 'friday' },\n\t{ label: 'saturday', value: 'saturday' },\n\t{ label: 'sunday', value: 'sunday' },\n]\n\nexport const yearInOptions = [\n\t{ label: 'january', value: 'january' },\n\t{ label: 'february', value: 'february' },\n\t{ label: 'march', value: 'march' },\n\t{ label: 'april', value: 'april' },\n\t{ label: 'may', value: 'may' },\n\t{ label: 'june', value: 'june' },\n\t{ label: 'july', value: 'july' },\n\t{ label: 'august', value: 'august' },\n\t{ label: 'september', value: 'september' },\n\t{ label: 'october', value: 'october' },\n\t{ label: 'november', value: 'november' },\n\t{ label: 'december', value: 'december' },\n]\n\nexport const generateMonthList = (length: number) =>\n\tnew Array(length).fill(null).map((_, i) => ({ label: ordinal(i + 1), value: i + 1 }))\n\nexport const getMonthOnOptions = (str: string) => {\n\t// @ts-ignore\n\treturn {\n\t\tjanuary: generateMonthList(31),\n\t\tfebruary: generateMonthList(28),\n\t\tmarch: generateMonthList(31),\n\t\tapril: generateMonthList(30),\n\t\tmay: generateMonthList(31),\n\t\tjune: generateMonthList(30),\n\t\tjuly: generateMonthList(31),\n\t\taugust: generateMonthList(31),\n\t\tseptember: generateMonthList(30),\n\t\toctober: generateMonthList(31),\n\t\tnovember: generateMonthList(30),\n\t\tdecember: generateMonthList(31),\n\t}[str]\n}\n\nexport const entityTiming = [\n\t{ label: 'minute', value: 'minute' },\n\t{ label: 'hour', value: 'hour' },\n\t{ label: 'day', value: 'day' },\n\t{ label: 'week', value: 'week' },\n\t{ label: 'month', value: 'month' },\n\t{ label: 'year', value: 'year' },\n]\n\nexport const entityTimingType = [\n\t{ label: 'before', value: 'before' },\n\t{ label: 'after', value: 'after' },\n]\n\nexport const getRuleOperatorOptions = (str: string) => {\n\t// @ts-ignore\n\treturn {\n\t\tdate: [\n\t\t\t{ label: 'is before', value: 'isBefore' },\n\t\t\t{ label: 'is after', value: 'isAfter' },\n\t\t\t{ label: 'is same minute as', value: 'sameMinute' },\n\t\t\t{ label: 'is same hour as', value: 'sameHour' },\n\t\t\t{ label: 'is same day as', value: 'sameDay' },\n\t\t],\n\t\tstring: [\n\t\t\t{ label: 'is', value: 'stringIs' },\n\t\t\t{ label: 'is not', value: 'stringNot' },\n\t\t\t{ label: 'includes', value: 'stringIncludes' },\n\t\t\t{ label: \"doesn't include\", value: 'stringNotIncludes' },\n\t\t\t{ label: 'starts with', value: 'stringStarts' },\n\t\t\t{ label: 'ends with', value: 'stringEnds' },\n\t\t\t{ label: 'is empty', value: 'stringEmpty' },\n\t\t\t{ label: 'is not empty', value: 'stringNotEmpty' },\n\t\t],\n\t\tnumber: [\n\t\t\t{ label: 'is', value: 'numberEquals' },\n\t\t\t{ label: 'is greater than', value: 'numberGT' },\n\t\t\t{ label: 'is at least', value: 'numberGTE' },\n\t\t\t{ label: 'is lesser than', value: 'numberLT' },\n\t\t\t{ label: 'is at most', value: 'numberLTE' },\n\t\t],\n\t\tboolean: [\n\t\t\t{ label: 'is true', value: 'true' },\n\t\t\t{ label: 'is false', value: 'false' },\n\t\t],\n\t\tusers: [\n\t\t\t{ label: 'includes', value: 'collectionIncludes' },\n\t\t\t{ label: \"doesn't include\", value: 'collectionNotIncludes' },\n\t\t],\n\t\tuser: [\n\t\t\t{ label: 'is', value: 'stringIs' },\n\t\t\t{ label: 'is not', value: 'stringNot' },\n\t\t],\n\t\toption: [\n\t\t\t{ label: 'is', value: 'stringIs' },\n\t\t\t{ label: 'is not', value: 'stringNot' },\n\t\t],\n\t}[str]\n}\n","import { useCallback, useRef, useEffect } from 'react'\nimport { FormikContextType } from 'formik'\nimport update from 'immutability-helper'\nimport { FieldArray, FieldArrayPath, FieldValues } from '@primer/types/form'\n\n\n// problem: https://github.com/formium/formik/issues/1476\n// solution: https://gist.github.com/joshsalverda/d808d92f46a7085be062b2cbde978ae6\n// plus some types from react-hook-form\nconst useFieldArray = <\n  TFieldValues extends FieldValues = FieldValues,\n  TFieldArrayName extends FieldArrayPath<TFieldValues> = FieldArrayPath<TFieldValues>,\n>(\n\tname: TFieldArrayName,\n\tcontext: FormikContextType<TFieldValues>\n) => {\n\tlet setFieldValue = context.setFieldValue\n\n\tlet field = context.getFieldProps<FieldArray<TFieldValues, TFieldArrayName>[]>(name)\n\tlet meta = context.getFieldMeta(field.name)\n\n\tlet fieldArray = useRef(field.value)\n\n\tuseEffect(() => {\n\t\tfieldArray.current = field.value\n\t}, [field.value])\n\n\tconst push = useCallback(\n\t\t(value) => {\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$push: [value],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst swap = useCallback(\n\t\t(indexA, indexB) => {\n\t\t\tconst swapA = fieldArray.current[indexA]\n\t\t\tconst swapB = fieldArray.current[indexB]\n\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$splice: [\n\t\t\t\t\t[indexA, 1, swapB],\n\t\t\t\t\t[indexB, 1, swapA],\n\t\t\t\t],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst move = useCallback(\n\t\t(from, to) => {\n\t\t\tconst toMove = fieldArray.current[from]\n\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$splice: [\n\t\t\t\t\t[from, 1],\n\t\t\t\t\t[to, 0, toMove],\n\t\t\t\t],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst insert = useCallback(\n\t\t(index, value) => {\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$splice: [[index, 0, value]],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst unshift = useCallback(\n\t\t(value) => {\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$unshift: [value],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t\treturn fieldArray.current.length\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst remove = useCallback(\n\t\t(index) => {\n\t\t\tconst removedItem = fieldArray.current[index]\n\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$splice: [[index, 1]],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t\treturn removedItem\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\tconst pop = useCallback(() => {\n\t\tconst lastIndex = fieldArray.current.length - 1\n\t\tconst poppedItem = fieldArray.current[lastIndex]\n\n\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t$splice: [[lastIndex, 1]],\n\t\t})\n\n\t\tsetFieldValue(field.name, fieldArray.current)\n\t\treturn poppedItem\n\t}, [field.name, setFieldValue])\n\n\tconst replace = useCallback(\n\t\t(index, value) => {\n\t\t\tfieldArray.current = update(fieldArray.current, {\n\t\t\t\t$splice: [[index, 1, value]],\n\t\t\t})\n\n\t\t\tsetFieldValue(field.name, fieldArray.current)\n\t\t},\n\t\t[field.name, setFieldValue]\n\t)\n\n\treturn {\n\t\tfield,\n\t\t// this is kind of weird, if the type of this field in your form is an array, then cool.\n\t\t// If you're trying to use useFieldArray on a field in your form that is not an array, then, you're an idiot\n\t\t// and the \"values\" property will be incorrectly typed as an arrayed version of the fields type\n\t\tvalues: field.value || [],\n\t\tmeta,\n\t\tarrayHelpers: {\n\t\t\tpush,\n\t\t\tswap,\n\t\t\tmove,\n\t\t\tinsert,\n\t\t\tunshift,\n\t\t\tremove,\n\t\t\tpop,\n\t\t\treplace,\n\t\t},\n\t}\n}\n\nexport default useFieldArray\n","import { forwardRef } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport ReactQuill from 'react-quill'\nimport Actions from '../Actions'\nimport { ActionType } from '@primer/types'\nimport { useField, useFormikContext } from 'formik'\nimport { FormValidations, validate } from './utils'\n\nexport const defaultEditorModules = {\n\ttoolbar: [\n\t\t[{ header: [1, 2, false] }],\n\t\t['bold', 'italic', { color: [] }],\n\t\t[{ list: 'ordered' }, { list: 'bullet' }],\n\t\t[{ align: [] }],\n\t\t['clean'],\n\t],\n}\n\ninterface FormEditorProps {\n\tname: string\n\tlabel?: string\n\tclassName?: ClassValue\n\tvalidations?: FormValidations\n\thideOptional?: boolean\n\tdisabled?: boolean\n\tmodules?: any\n\tactions?: ActionType[]\n}\n\nconst FormEditor = forwardRef<ReactQuill, FormEditorProps>(\n\t({ name, label, className, validations = {}, hideOptional, disabled, modules, actions }, ref) => {\n\t\tconst formik = useFormikContext()\n\n\t\tconst [{ value }, { error, touched }, { setValue, setTouched }] = useField({\n\t\t\tname,\n\t\t\tvalidate: validate(validations),\n\t\t})\n\n\t\tconst isRequired = !!validations.required\n\n\t\treturn (\n\t\t\t<div className={clsx(className)}>\n\t\t\t\t{label && (\n\t\t\t\t\t<div className=\"block text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 cursor-default\">\n\t\t\t\t\t\t{label}{' '}\n\t\t\t\t\t\t{!isRequired && !hideOptional && (\n\t\t\t\t\t\t\t<span className=\"text-gray-400 dark:text-gray-300 font-normal text-xs leading-4 opacity-75\">\n\t\t\t\t\t\t\t\t(optional)\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t<div className={clsx('relative h-full', label && 'mt-1')}>\n\t\t\t\t\t{actions && (\n\t\t\t\t\t\t<div className=\"absolute top-0 right-0 mr-1.5 h-11 flex items-center\">\n\t\t\t\t\t\t\t<Actions actions={actions} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<ReactQuill\n\t\t\t\t\t\tref={ref}\n\t\t\t\t\t\tvalue={value || ''}\n\t\t\t\t\t\tonChange={(content) => {\n\t\t\t\t\t\t\t// setTouched(true)\n\t\t\t\t\t\t\tsetValue(content)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={(e) => {\n\t\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tmodules={modules || defaultEditorModules}\n\t\t\t\t\t\treadOnly={disabled || formik.isSubmitting}\n\t\t\t\t\t\tclassName=\"h-full\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{error && touched && <p className=\"mt-2 text-sm text-red-600\">{error}</p>}\n\t\t\t</div>\n\t\t)\n\t}\n)\n\nexport default FormEditor\n","import { Dispatch, FC, ReactNode, SetStateAction, useState } from 'react'\nimport clsx from 'clsx'\n\ninterface ExpandableProps {\n\tchildren: (setOpen: Dispatch<SetStateAction<boolean>>, isExpanded: boolean) => ReactNode\n}\n\nconst Expandable: FC<ExpandableProps> = ({ children }) => {\n\tconst [isExpanded, setExpanded] = useState(false)\n\n\treturn (\n\t\t<div className={clsx(isExpanded ? 'fixed z-[9999] w-screen h-screen' : 'static', 'top-0 left-0')}>\n\t\t\t{children(setExpanded, isExpanded)}\n\t\t</div>\n\t)\n}\n\nexport default Expandable\n","import { ChevronLeftIcon } from '@heroicons/react/outline'\nimport { ActionType } from '@primer/types'\nimport db from 'db'\n\nexport const templateTagActions = (insertFn: (x: string) => void, level: string): ActionType[] => {\n\tlet userEntity = db.entities.find((x) => x.key === 'user')\n\n\treturn [\n\t\t{\n\t\t\ttitle: 'Recipient',\n\t\t\ticon: <ChevronLeftIcon className=\"w-4 h-4\" />,\n\t\t\ticonSide: 'left',\n\t\t\thoverable: true,\n\t\t\tplacement: 'left-start',\n\t\t\tactions: db.fields\n\t\t\t\t.all((x) => x.entityId === userEntity?.id)\n\t\t\t\t.map((x) => ({\n\t\t\t\t\ttitle: x.name,\n\t\t\t\t\tonClick: () => insertFn(`{{recipient-${x.key}}}`),\n\t\t\t\t})),\n\t\t},\n\t\t...db.entities.all().map<ActionType>((entity) => ({\n\t\t\ttitle: entity.name,\n\t\t\ticon: <ChevronLeftIcon className=\"w-4 h-4\" />,\n\t\t\ticonSide: 'left',\n\t\t\thoverable: true,\n\t\t\tplacement: 'left-start',\n\t\t\tactions: db.fields\n\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t.map((x) => ({\n\t\t\t\t\ttitle: x.name,\n\t\t\t\t\tonClick: () => insertFn(`{{${entity.key}-${x.key}}}`),\n\t\t\t\t})),\n\t\t})),\n\t]\n}\n","import { FC, ReactNode, useRef } from 'react'\nimport clsx from 'clsx'\nimport ReactQuill from 'react-quill'\nimport { ArrowsExpandIcon, ChevronDownIcon, XIcon } from '@heroicons/react/outline'\nimport { FormValidations } from '@primer/components/Form/utils'\nimport FormEditor from '@primer/components/Form/FormEditor'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport Expandable from '@primer/components/Expandable'\nimport { templateTagActions } from 'pages/Settings/Templates/utils/actions'\n\ninterface FormTemplateEditorProps {\n\tname: string\n\tlabel?: ReactNode\n\tvalidations?: FormValidations\n\tfocus: string\n}\n\nconst FormTemplateEditor: FC<FormTemplateEditorProps> = ({ name, label, validations, focus }) => {\n\tconst ref = useRef<ReactQuill>(null)\n\n\tconst insertTag = (str: string) => {\n\t\tlet editor = ref.current?.getEditor()\n\t\tlet selection = editor?.getSelection()\n\t\tlet text = editor?.getText()\n\n\t\tif (!editor || !text) return\n\n\t\tconst index = selection?.index\n\t\tconst length = selection?.length\n\n\t\tif (!index) {\n\t\t\teditor.insertText(editor.getText().length - 1, str)\n\t\t} else {\n\t\t\tif (length) editor.deleteText(index, length)\n\t\t\teditor.insertText(index, str)\n\t\t}\n\t}\n\n\treturn (\n\t\t<Expandable>\n\t\t\t{(setExpanded, isExpanded) => (\n\t\t\t\t<div className={clsx(isExpanded && 'bg-white h-full')}>\n\t\t\t\t\t{!isExpanded && label && <FormLabel>{label}</FormLabel>}\n\n\t\t\t\t\t<FormEditor\n\t\t\t\t\t\tname={name}\n\t\t\t\t\t\tvalidations={validations}\n\t\t\t\t\t\tclassName={clsx(!isExpanded && label && 'mt-1', isExpanded && 'h-full pb-10')}\n\t\t\t\t\t\tref={ref}\n\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: 'Insert Tag',\n\t\t\t\t\t\t\t\ticon: <ChevronDownIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\ticonSide: 'right',\n\t\t\t\t\t\t\t\tintent: 'secondary',\n\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\tactions: templateTagActions(insertTag, focus) || [],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ticon: isExpanded ? (\n\t\t\t\t\t\t\t\t\t<XIcon className=\"w-4 h-4 -mx-1\" />\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<ArrowsExpandIcon className=\"w-4 h-4 -mx-1\" />\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\tonClick: () => setExpanded((x) => !x),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</Expandable>\n\t)\n}\n\nexport default FormTemplateEditor\n","import { FC, Fragment } from 'react'\nimport { v4 as uuid } from 'uuid'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport Card from '@primer/components/Card'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport Actions from '@primer/components/Actions'\nimport Stack from '@primer/components/Stack'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport FormDate from '@primer/components/Form/FormDate'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport FormSection from '@primer/components/Form/FormSection'\nimport FormToggle from '@primer/components/Form/FormToggle'\nimport AutoHeight from '@primer/components/AutoHeight'\nimport Tabs from '@primer/components/Tabs'\nimport { ArrowLeftIcon, BeakerIcon, CheckIcon, ChevronDownIcon, PlusIcon } from '@heroicons/react/outline'\nimport { XIcon } from '@heroicons/react/solid'\nimport { ActionType, isNotNone } from '@primer/types'\nimport {\n\ttypes,\n\trepeatOptions,\n\tyearInOptions,\n\tgetMonthOnOptions,\n\tweekOnOptions,\n\tgetRuleOperatorOptions,\n\tentityTiming,\n\tentityTimingType,\n} from './utils/options'\nimport useFieldArray from '@primer/components/Form/useFieldArray'\nimport { watch } from '@primer/components/Form/utils'\nimport { useFormikContext } from 'formik'\nimport FormTemplateEditor from 'components/FormTemplateEditor'\nimport { templateTagActions } from 'pages/Settings/Templates/utils/actions'\nimport db from 'db'\nimport { confirm } from '@primer/alerts'\n\ninterface RuleType {\n\tentity: string\n\tfield: string\n\toperator: string\n\tvalue: string\n}\n\ninterface RuleGroupType {\n\trules: RuleType[]\n}\n\ninterface FormData {\n\tname: string\n\tenabled: boolean\n\tenabledDate: Date | undefined\n\tfocus: string\n\n\ttriggerType: string\n\ttriggerRepeat: number\n\n\ttriggerEvery: string\n\ttriggerYearIn: string\n\ttriggerMonthOn: string\n\ttriggerWeekOn: string\n\ttriggerDayAt: string\n\n\ttriggerAction: string\n\n\tobeyTriggerTiming: boolean\n\ttriggerTimingType: string\n\ttriggerTiming: string\n\ttriggerDate: string\n\n\truleGroups: RuleGroupType[]\n\n\tsubject: string\n\tcontent: string\n}\n\nconst NotificationForm: FC<RouteComponentProps<{ id: string; mode: 'create' | 'edit' }>> = ({ id, mode }) => {\n\tconst originalNotification = db.notifications.find(id)\n\n\tconst formContext = useForm<FormData>({\n\t\tinitialValues: {\n\t\t\tname: originalNotification?.name || '',\n\t\t\tfocus: originalNotification?.focus || '',\n\t\t\tenabled: originalNotification?.enabled || false,\n\t\t\tenabledDate: originalNotification?.enabledDate || undefined,\n\n\t\t\ttriggerType: originalNotification?.triggerType || 'action',\n\t\t\ttriggerRepeat: originalNotification?.triggerRepeat || 1,\n\n\t\t\ttriggerEvery: originalNotification?.triggerEvery || '',\n\t\t\ttriggerYearIn: originalNotification?.triggerYearIn || '',\n\t\t\ttriggerMonthOn: originalNotification?.triggerMonthOn || '',\n\t\t\ttriggerWeekOn: originalNotification?.triggerWeekOn || '',\n\t\t\ttriggerDayAt: originalNotification?.triggerDayAt || '',\n\n\t\t\ttriggerAction: originalNotification?.triggerAction || '',\n\n\t\t\tobeyTriggerTiming: originalNotification?.obeyTriggerTiming || true,\n\t\t\ttriggerTimingType: originalNotification?.triggerTimingType || '',\n\t\t\ttriggerTiming: originalNotification?.triggerTiming || '',\n\t\t\ttriggerDate: originalNotification?.triggerDate || '',\n\n\t\t\truleGroups: originalNotification?.ruleGroups || [],\n\n\t\t\tsubject: originalNotification?.subject || '',\n\t\t\tcontent: originalNotification?.content || '',\n\t\t},\n\t\tonSubmit: (formData) => {\n\t\t\tdb.notifications.save({\n\t\t\t\tid: uuid(),\n\t\t\t\t...(originalNotification || {}),\n\t\t\t\t...formData,\n\t\t\t})\n\n\t\t\tnavigate('/settings/notifications')\n\t\t},\n\t})\n\n\tconst {\n\t\tvalues: ruleGroups,\n\t\tarrayHelpers: { push: appendRuleGroup, remove: removeRuleGroup },\n\t} = useFieldArray('ruleGroups', formContext)\n\n\t// obeyTriggerTiming,\n\n\tconst triggerType = watch('triggerType', formContext)\n\tconst triggerRepeat = watch('triggerRepeat', formContext)\n\tconst triggerEvery = watch('triggerEvery', formContext)\n\tconst triggerYearIn = watch('triggerYearIn', formContext)\n\tconst triggerMonthOn = watch('triggerMonthOn', formContext)\n\tconst triggerWeekOn = watch('triggerWeekOn', formContext)\n\tconst triggerTiming = watch('triggerTiming', formContext)\n\tconst triggerTimingType = watch('triggerTimingType', formContext)\n\tconst enabled = watch('enabled', formContext)\n\tconst subject = watch('subject', formContext)\n\tconst focus = watch('focus', formContext)\n\n\tconst title = mode === 'create' ? 'Create Notification' : 'Edit Notification'\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/notifications',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Form context={formContext}>\n\t\t\t\t\t<Stack dividers>\n\t\t\t\t\t\t<FormSection title=\"Details\" subtitle=\"Basic information about the notification\">\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t<FormLabel>Notification is about</FormLabel>\n\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\tname=\"focus\"\n\t\t\t\t\t\t\t\t\t\t\toptions={db.entities.all().map((x) => ({ value: x.id, label: x.name }))}\n\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Focus is required' }}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-[150px]\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<FormToggle name=\"enabled\" label=\"Enabled\" />\n\n\t\t\t\t\t\t\t\t\t<AutoHeight show={!!enabled}>\n\t\t\t\t\t\t\t\t\t\t<FormDate name=\"enabledDate\" label=\"Enabled from\" />\n\t\t\t\t\t\t\t\t\t</AutoHeight>\n\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Trigger\"\n\t\t\t\t\t\t\tsubtitle={\n\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t\t<div>Choose how to trigger the notification</div>\n\t\t\t\t\t\t\t\t\t<ul className=\"list-disc pl-5 text-xs\">\n\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t<strong>Action</strong>: When a certain action occurs within the platform\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t<strong>Repeat</strong>: On a recurring schedule\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t<strong>Date</strong>: Relative to a defined date\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\t\tvalue={triggerType}\n\t\t\t\t\t\t\t\tonChange={(x) => formContext.setFieldValue('triggerType', x)}\n\t\t\t\t\t\t\t\tintent=\"card\"\n\t\t\t\t\t\t\t\ttabs={types}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<div className=\"relative z-10\">\n\t\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<Stack className={triggerType === 'action' ? '' : 'hidden'}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[300px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerAction\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={db.actions\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.all((x) => x.entityId === focus)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((x) => ({ value: x.id, label: x.name }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// validations={{ required: 'Action is required' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Select action...\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Stack>\n\n\t\t\t\t\t\t\t\t\t\t\t<Stack className={triggerType === 'repeat' ? '' : 'hidden'}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>Every</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[60px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerRepeat\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired: 'required',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: 'Every must be at least 1',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerEvery\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={repeatOptions.map((x) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tx.label + ((triggerRepeat || 1) > 1 ? 's' : ''),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: x.value,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{triggerEvery === 'year' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>in</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerYearIn\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={yearInOptions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired: 'Time is required',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(triggerEvery === 'month' ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(triggerEvery === 'year' && isNotNone(triggerYearIn))) && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>on the</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerMonthOn\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttriggerEvery === 'month'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetMonthOnOptions(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttriggerYearIn || 'february'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) || []\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ).concat([\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'last day',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: Infinity,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: getMonthOnOptions(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttriggerYearIn || 'february'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ) || []\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired: 'Time is required',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{triggerEvery === 'week' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>on</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerWeekOn\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={weekOnOptions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired: 'Time is required',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(triggerEvery === 'day' ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisNotNone(triggerWeekOn) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisNotNone(triggerMonthOn)) && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>at</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[130px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormInput name=\"triggerDayAt\" type=\"time\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Stack>\n\n\t\t\t\t\t\t\t\t\t\t\t<Stack className={triggerType === 'date' ? '' : 'hidden'}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[60px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerRepeat\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired: 'required',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: 'min 1',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerTiming\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={entityTiming.map((x) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: x.label + ((triggerRepeat || 1) > 1 ? 's' : ''),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: x.value,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{triggerTiming && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[100px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerTimingType\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={entityTimingType}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'required' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{triggerTimingType && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[200px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"triggerDate\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={db.fields\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.all(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(x) => x.entityId === focus && x.type === 'date'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((x) => ({ value: x.id, label: x.name }))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'required' }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Conditions\"\n\t\t\t\t\t\t\tsubtitle=\"Fine grained controls over if the notification gets sent\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t{ruleGroups.map((x, i) => (\n\t\t\t\t\t\t\t\t\t\t<Fragment key={i}>\n\t\t\t\t\t\t\t\t\t\t\t<RuleGroup index={i} remove={() => removeRuleGroup(i)} />\n\t\t\t\t\t\t\t\t\t\t\t{i !== ruleGroups.length - 1 && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium px-4 py-1 rounded-full bg-indigo-600 text-white\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tOR\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t\t))}\n\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add condition set',\n\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => appendRuleGroup({ rules: [] }),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Template\"\n\t\t\t\t\t\t\tsubtitle={\n\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t\t<div>Customise the content of the email message</div>\n\t\t\t\t\t\t\t\t\t<div>Use the tag reference to add placeholders for real values</div>\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Import Template',\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <ChevronDownIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\t\ticonSide: 'right',\n\t\t\t\t\t\t\t\t\t\t\t\tplacement: 'bottom-start',\n\t\t\t\t\t\t\t\t\t\t\t\tactions: db.templates.all().map<ActionType>((x) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: x.name,\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet pass = false\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformContext.values.content !== '' &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformContext.values.content !== '<p><br></p>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait confirm({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'This will overwrite your existing email content',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpass = true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpass = true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (pass) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformContext.setFieldValue('content', x.content)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\n\t\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\t\tname=\"subject\"\n\t\t\t\t\t\t\t\t\t\t\tlabel=\"Subject line\"\n\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Subject line is required' }}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1 mr-3\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-6\">\n\t\t\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Insert Tag',\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: <ChevronDownIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonSide: 'right',\n\t\t\t\t\t\t\t\t\t\t\t\t\tactions:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplateTagActions((x) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformContext.setFieldValue(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'subject',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubject?.length ? `${subject}${x}` : `${x}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}, focus) || [],\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<FormTemplateEditor\n\t\t\t\t\t\t\t\t\t\tname=\"content\"\n\t\t\t\t\t\t\t\t\t\tlabel=\"Content\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Content is required' }}\n\t\t\t\t\t\t\t\t\t\tfocus={focus}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t{/* <AutoHeight show={focus !== '' && focus !== 'user'}>\n\t\t\t\t\t\t\t<FormSection title=\"Recipients\" subtitle=\"Who will receive this email notification\">\n\t\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t\t<MultiColumns\n\t\t\t\t\t\t\t\t\t\tcolumns={2}\n\t\t\t\t\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t\t\t\t\t(focus === 'case' || focus === 'event') && (\n\t\t\t\t\t\t\t\t\t\t\t\t<FormCheckbox name=\"recipients.caseApplicant\" label=\"Case Applicant\" />\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t(focus === 'case' || focus === 'event') && (\n\t\t\t\t\t\t\t\t\t\t\t\t<FormCheckbox\n\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"recipients.caseRespondent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Case Respondent\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\tfocus === 'event' && (\n\t\t\t\t\t\t\t\t\t\t\t\t<FormCheckbox name=\"recipients.eventAttendee\" label=\"Event Attendees\" />\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t\t</FormSection>\n\t\t\t\t\t\t</AutoHeight> */}\n\n\t\t\t\t\t\t<div className=\"flex items-center justify-end\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: 'Test',\n\t\t\t\t\t\t\t\t\t\tintent: 'secondary',\n\t\t\t\t\t\t\t\t\t\ticon: <BeakerIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\t\t\t\tdisabled: !isNotNone(focus) || true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: mode === 'create' ? 'Create' : 'Save',\n\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t\tdisabled: !isNotNone(focus),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</Form>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nconst RuleGroup: FC<{ index: number; remove: () => void }> = ({ index, remove }) => {\n\tconst formContext = useFormikContext<FormData>()\n\n\tconst {\n\t\tvalues: rules,\n\t\tarrayHelpers: { push: appendRule, remove: removeRule },\n\t} = useFieldArray(`ruleGroups.${index}.rules`, formContext)\n\n\treturn (\n\t\t<div className=\"relative\">\n\t\t\t<div className=\"absolute top-0 right-0 -mr-3 -my-3\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={{\n\t\t\t\t\t\ticon: <XIcon className=\"w-4 h-4 -mx-1 text-red-500\" />,\n\t\t\t\t\t\tintent: 'secondary',\n\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\tonClick: remove,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<Stack className=\"p-4 rounded-md bg-gray-100 dark:bg-gray-750\">\n\t\t\t\t{rules.map((_, i) => (\n\t\t\t\t\t<Rule\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tgroupIndex={index}\n\t\t\t\t\t\tindex={i}\n\t\t\t\t\t\tremove={() => removeRule(i)}\n\t\t\t\t\t\tprefix={i === 0 ? 'IF' : 'AND'}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\n\t\t\t\t<Actions\n\t\t\t\t\tactions={{\n\t\t\t\t\t\ttitle: 'Add condition',\n\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\tonClick: () => appendRule({ entity: '', field: '', operator: '', value: '' }),\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Stack>\n\t\t</div>\n\t)\n}\n\nconst Rule: FC<{ groupIndex: number; index: number; prefix: string; remove: () => void }> = ({\n\tgroupIndex,\n\tindex,\n\tprefix,\n\tremove,\n}) => {\n\tconst formContext = useFormikContext<FormData>()\n\n\tconst entity = watch(`ruleGroups.${groupIndex}.rules.${index}.entity`, formContext)\n\tconst field = watch(`ruleGroups.${groupIndex}.rules.${index}.field`, formContext)\n\tconst operator = watch(`ruleGroups.${groupIndex}.rules.${index}.operator`, formContext)\n\tconst entityField = db.fields.find(field)\n\tconst type = entityField?.type || 'string'\n\tconst options = entityField?.options || []\n\n\treturn (\n\t\t<div className=\"flex items-center justify-between space-x-3\">\n\t\t\t<div className=\"flex items-center space-x-3 flex-1\">\n\t\t\t\t<span className=\"text-sm font-medium text-center p-1 w-full max-w-[50px] rounded-full bg-white dark:bg-gray-800 text-indigo-600 dark:text-indigo-400 border border-gray-300 dark:border-gray-600\">\n\t\t\t\t\t{prefix}\n\t\t\t\t</span>\n\n\t\t\t\t<FormSelect\n\t\t\t\t\tname={`ruleGroups.${groupIndex}.rules.${index}.entity`}\n\t\t\t\t\toptions={db.entities.all().map((x) => ({ value: x.id, label: x.name }))}\n\t\t\t\t\tclassName=\"w-full max-w-[100px]\"\n\t\t\t\t/>\n\n\t\t\t\t<FormSelect\n\t\t\t\t\tname={`ruleGroups.${groupIndex}.rules.${index}.field`}\n\t\t\t\t\toptions={\n\t\t\t\t\t\tdb.fields.all((x) => x.entityId === entity).map((x) => ({ value: x.id, label: x.name })) || []\n\t\t\t\t\t}\n\t\t\t\t\tclassName=\"w-full max-w-[200px]\"\n\t\t\t\t/>\n\n\t\t\t\t<FormSelect\n\t\t\t\t\tname={`ruleGroups.${groupIndex}.rules.${index}.operator`}\n\t\t\t\t\toptions={getRuleOperatorOptions(type) || []}\n\t\t\t\t\tclassName=\"w-full max-w-[200px]\"\n\t\t\t\t/>\n\n\t\t\t\t{type === 'date' ? (\n\t\t\t\t\t<FormDate name={`ruleGroups.${groupIndex}.rules.${index}.value`} className=\"w-full max-w-[200px]\" />\n\t\t\t\t) : type === 'string' && operator !== 'stringEmpty' && operator !== 'stringNotEmpty' ? (\n\t\t\t\t\t<FormInput\n\t\t\t\t\t\tname={`ruleGroups.${groupIndex}.rules.${index}.value`}\n\t\t\t\t\t\tclassName=\"w-full max-w-[200px]\"\n\t\t\t\t\t/>\n\t\t\t\t) : type === 'option' ? (\n\t\t\t\t\t<FormSelect\n\t\t\t\t\t\tname={`ruleGroups.${groupIndex}.rules.${index}.value`}\n\t\t\t\t\t\toptions={options.map((x) => ({ value: x, label: x }))}\n\t\t\t\t\t\tclassName=\"w-full max-w-[200px]\"\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<Actions\n\t\t\t\t\tactions={{\n\t\t\t\t\t\ticon: <XIcon className=\"w-4 h-4 text-red-500 -mx-2\" />,\n\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\tonClick: remove,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default NotificationForm\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { BeakerIcon, DotsHorizontalIcon, PencilIcon, PlusIcon, TrashIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport { TemplateModel } from 'db/types'\nimport db from 'db'\nimport { confirm } from '@primer/alerts'\n\nconst Templates: FC<RouteComponentProps> = () => {\n\tconst schema: TableSchema<TemplateModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Edit',\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/settings/templates/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Test',\n\t\t\t\t\t\t\ticon: <BeakerIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.templates.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Templates\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Template',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/templates/create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={db.templates.all()} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Templates\n","import { FC } from 'react'\nimport { v4 as uuid } from 'uuid'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon, BeakerIcon, CheckIcon } from '@heroicons/react/outline'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Actions from '@primer/components/Actions'\nimport PageContent from '@primer/components/PageContent'\nimport PageHeading from '@primer/components/PageHeading'\nimport { CardWrapper, CardContent, CardFooter } from '@primer/components/Card'\nimport Stack from '@primer/components/Stack'\nimport FormTemplateEditor from 'components/FormTemplateEditor'\nimport db from 'db'\n\ninterface FormData {\n\tname: string\n\tcontent: string\n}\n\nconst CreateTemplate: FC<RouteComponentProps<{ id: string; mode: 'create' | 'edit' }>> = ({ id, mode }) => {\n\tconst originalTemplate = db.templates.find(id)\n\n\tconst formContext = useForm<FormData>({\n\t\tinitialValues: {\n\t\t\tname: originalTemplate?.name || '',\n\t\t\tcontent: originalTemplate?.content || '',\n\t\t},\n\t\tonSubmit: (formData) => {\n\t\t\tdb.templates.save({\n\t\t\t\tid: uuid(),\n\t\t\t\t...(originalTemplate || {}),\n\t\t\t\t...formData,\n\t\t\t})\n\n\t\t\tnavigate('/settings/templates')\n\t\t},\n\t})\n\n\tconst title = mode === 'create' ? 'Create Template' : 'Edit Template'\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/templates',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Form context={formContext}>\n\t\t\t\t\t<CardWrapper>\n\t\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<FormInput name=\"name\" label=\"Name\" validations={{ required: 'Name is required' }} />\n\n\t\t\t\t\t\t\t\t<FormTemplateEditor\n\t\t\t\t\t\t\t\t\tname=\"content\"\n\t\t\t\t\t\t\t\t\tlabel=\"Content\"\n\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Content is required' }}\n\t\t\t\t\t\t\t\t\tfocus={'all'}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</CardContent>\n\n\t\t\t\t\t\t<CardFooter>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-end\">\n\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Test',\n\t\t\t\t\t\t\t\t\t\t\tintent: 'secondary',\n\t\t\t\t\t\t\t\t\t\t\ticon: <BeakerIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttitle: mode === 'create' ? 'Create' : 'Save',\n\t\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CardFooter>\n\t\t\t\t\t</CardWrapper>\n\t\t\t\t</Form>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default CreateTemplate\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport db from 'db'\nimport { RoleModel } from 'db/types'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { DotsHorizontalIcon, PencilIcon, PlusIcon, TrashIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport { confirm } from '@primer/alerts'\n\nconst Roles: FC<RouteComponentProps> = () => {\n\tconst schema: TableSchema<RoleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Edit',\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/settings/roles/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.roles.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Roles\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Role',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/roles/create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={db.roles.all()} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Roles\n","import { FC, ReactNode } from 'react'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface FormCheckboxProps {\n\tname: string\n\tlabel?: ReactNode\n\tdefaultValue?: any\n\tdisabled?: boolean\n\tinputClassName?: ClassValue\n\tclassName?: ClassValue\n\tcolor?: string\n}\n\nconst FormCheckbox: FC<FormCheckboxProps> = ({\n\tname,\n\tlabel,\n\tdisabled,\n\tinputClassName,\n\tcolor = 'text-primary-500 dark:text-primary-600',\n\tclassName,\n}) => {\n\t// helpers: {setValue: ƒ, setTouched: ƒ, setError: ƒ}\n\tconst [field] = useField({\n\t\tname,\n\t\ttype: 'checkbox',\n\t})\n\n\tconst formik = useFormikContext()\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<label className=\"text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 inline-flex items-center cursor-pointer\">\n\t\t\t\t<input\n\t\t\t\t\t{...field}\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tclassName={clsx('form-checkbox', inputClassName, {\n\t\t\t\t\t\t[color]: !disabled,\n\t\t\t\t\t\t'text-gray-400': disabled,\n\t\t\t\t\t})}\n\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t/>\n\t\t\t\t{label && <span className=\"ml-3\">{label}</span>}\n\t\t\t</label>\n\t\t</div>\n\t)\n}\n\nexport default FormCheckbox\n","import { FC } from 'react'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon, CheckIcon } from '@heroicons/react/outline'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Actions from '@primer/components/Actions'\nimport PageContent from '@primer/components/PageContent'\nimport PageHeading from '@primer/components/PageHeading'\nimport Card, { CardWrapper } from '@primer/components/Card'\nimport Stack from '@primer/components/Stack'\nimport FormCheckbox from '@primer/components/Form/FormCheckbox'\nimport CardHeader from '@primer/components/CardHeader'\nimport db from 'db'\nimport FormSection from '@primer/components/Form/FormSection'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport TableFrame from '@primer/components/TableFrame'\nimport { FieldPermissionModel, ActionPermissionModel, RelationPermissionModel } from 'db/types'\n\ninterface PermissionSet<T> {\n\t[key: string]: T\n}\n\ninterface Permissions {\n\t[key: string]: {\n\t\tfields: PermissionSet<FieldPermissionModel>\n\t\tactions: PermissionSet<ActionPermissionModel>\n\t\trelations: PermissionSet<RelationPermissionModel>\n\t}\n}\n\ninterface FormSchema {\n\tname: string\n\tentities: Permissions\n}\n\nconst RoleForm: FC<RouteComponentProps<{ id: string; mode: 'create' | 'edit' }>> = ({ id, mode }) => {\n\tconst originalRole = db.roles.find(id)\n\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\tname: originalRole?.name || '',\n\t\t\tentities: db.entities.all().reduce<Permissions>((list, entity) => {\n\t\t\t\treturn {\n\t\t\t\t\t...list,\n\t\t\t\t\t[entity.key]: {\n\t\t\t\t\t\tfields: db.fields\n\t\t\t\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t\t\t\t.reduce<PermissionSet<FieldPermissionModel>>(\n\t\t\t\t\t\t\t\t(items, x) => ({\n\t\t\t\t\t\t\t\t\t...items,\n\t\t\t\t\t\t\t\t\t[x.key]: db.fieldPermissions.find((y) => y.fieldId === x.id && y.roleId === id) || {\n\t\t\t\t\t\t\t\t\t\tid: '',\n\t\t\t\t\t\t\t\t\t\tview: true,\n\t\t\t\t\t\t\t\t\t\tmodify: true,\n\t\t\t\t\t\t\t\t\t\troleId: id || '',\n\t\t\t\t\t\t\t\t\t\tfieldId: x.id,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tactions: db.actions\n\t\t\t\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t\t\t\t.reduce<PermissionSet<ActionPermissionModel>>(\n\t\t\t\t\t\t\t\t(items, x) => ({\n\t\t\t\t\t\t\t\t\t...items,\n\t\t\t\t\t\t\t\t\t[x.key]: db.actionPermissions.find(\n\t\t\t\t\t\t\t\t\t\t(y) => y.actionId === x.id && y.roleId === id\n\t\t\t\t\t\t\t\t\t) || {\n\t\t\t\t\t\t\t\t\t\tid: '',\n\t\t\t\t\t\t\t\t\t\tperform: true,\n\t\t\t\t\t\t\t\t\t\troleId: id || '',\n\t\t\t\t\t\t\t\t\t\tactionId: x.id,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\trelations: db.relations\n\t\t\t\t\t\t\t.all((x) => x.entityId === entity.id)\n\t\t\t\t\t\t\t.reduce<PermissionSet<RelationPermissionModel>>(\n\t\t\t\t\t\t\t\t(items, x) => ({\n\t\t\t\t\t\t\t\t\t...items,\n\t\t\t\t\t\t\t\t\t[x.key]: db.relationPermissions.find(\n\t\t\t\t\t\t\t\t\t\t(y) => y.relationId === x.id && y.roleId === id\n\t\t\t\t\t\t\t\t\t) || {\n\t\t\t\t\t\t\t\t\t\tid: '',\n\t\t\t\t\t\t\t\t\t\tview: true,\n\t\t\t\t\t\t\t\t\t\tmodify: true,\n\t\t\t\t\t\t\t\t\t\tremove: true,\n\t\t\t\t\t\t\t\t\t\troleId: id || '',\n\t\t\t\t\t\t\t\t\t\trelationId: x.id,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}, {}),\n\t\t},\n\t\tonSubmit: (formValues) => {\n\t\t\tdb.roles.save({\n\t\t\t\t...(originalRole || {}),\n\t\t\t\tname: formValues.name,\n\t\t\t})\n\n\t\t\tdb.entities.all().forEach((entityType) => {\n\t\t\t\tObject.values(formValues.entities[entityType.key].fields).forEach((val) => {\n\t\t\t\t\tdb.fieldPermissions.save({ ...val, id: val.id || undefined })\n\t\t\t\t})\n\n\t\t\t\tObject.values(formValues.entities[entityType.key].actions).forEach((val) => {\n\t\t\t\t\tdb.actionPermissions.save({ ...val, id: val.id || undefined })\n\t\t\t\t})\n\n\t\t\t\tObject.values(formValues.entities[entityType.key].relations).forEach((val) => {\n\t\t\t\t\tdb.relationPermissions.save({ ...val, id: val.id || undefined })\n\t\t\t\t})\n\t\t\t})\n\n\t\t\tnavigate(`${process.env.PUBLIC_URL}/settings/roles`)\n\t\t},\n\t})\n\n\tconst fieldSchema = (entityTypeKey: string): TableSchema<any> => ({\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Field',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'View',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.fields.${x.key}.view`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Modify',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.fields.${x.key}.modify`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t})\n\n\tconst actionSchema = (entityTypeKey: string): TableSchema<any> => ({\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Action',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Perform',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.actions.${x.key}.perform`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t})\n\n\tconst relationSchema = (entityTypeKey: string): TableSchema<any> => ({\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Relation',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'View',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.relations.${x.key}.view`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Modify',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.relations.${x.key}.modify`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Remove',\n\t\t\t\tvalue: (x, i) => (\n\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t<FormCheckbox name={`entities.${entityTypeKey}.relations.${x.key}.remove`} />\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t],\n\t})\n\n\tconst title = mode === 'create' ? 'Create Role' : 'Edit Role'\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/roles',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Form context={formContext}>\n\t\t\t\t\t<Stack>\n\t\t\t\t\t\t<FormSection title=\"Details\" subtitle=\"Basic details about the role\">\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Permissions\"\n\t\t\t\t\t\t\tsubtitle=\"A view of permissions for all existing entity types and their fields/actions/relations\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t{db.entities.all().map((entityType) => (\n\t\t\t\t\t\t\t\t\t<CardWrapper key={entityType.key}>\n\t\t\t\t\t\t\t\t\t\t<CardHeader title={entityType.name} />\n\t\t\t\t\t\t\t\t\t\t<div className=\"rounded-b-md overflow-hidden\">\n\t\t\t\t\t\t\t\t\t\t\t<Stack className=\"p-6\">\n\t\t\t\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = db.fields.all((x) => x.entityId === entityType.id)\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\titems.length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tschema={fieldSchema(entityType.key)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titems={items}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"-my-px\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = db.actions.all((x) => x.entityId === entityType.id)\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\titems.length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tschema={actionSchema(entityType.key)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titems={items}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"-my-px\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = db.relations.all((x) => x.entityId === entityType.id)\n\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\titems.length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Table\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tschema={relationSchema(entityType.key)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titems={items}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"-my-px\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</TableFrame>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</CardWrapper>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<div className=\"flex items-center justify-end\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: mode === 'create' ? 'Create' : 'Save',\n\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</Form>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default RoleForm\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport { RouteComponentProps } from '@reach/router'\nimport db from 'db'\nimport { EntityModel } from 'db/types'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { DotsHorizontalIcon, PencilIcon, PlusIcon, TrashIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport Stack from '@primer/components/Stack'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport { confirm } from '@primer/alerts'\n\nconst Entities: FC<RouteComponentProps> = () => {\n\tconst schema: TableSchema<EntityModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Fields',\n\t\t\t\tvalue: (x) => db.fields.all((y) => y.entityId === x.id).length || '',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Actions',\n\t\t\t\tvalue: (x) => db.actions.all((y) => y.entityId === x.id).length || '',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Relations',\n\t\t\t\tvalue: (x) => db.relations.all((y) => y.entityId === x.id).length || '',\n\t\t\t},\n\t\t],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Edit',\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/settings/entities/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.entities.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Entities\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Entity',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/entities/create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={db.entities.all()} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Entities\n","import { ChangeEvent, ElementType, FC, ReactNode, useState } from 'react'\nimport { useField, useFormikContext } from 'formik'\nimport clsx, { ClassValue } from 'clsx'\nimport useAutoFocus from '@primer/hooks/useAutoFocus'\nimport { FormValidations, validate } from './utils'\nimport { v4 as uuidv4 } from 'uuid'\n\ninterface FormInputProps {\n\tas?: ElementType | string\n\tname: string\n\tlabel?: ReactNode\n\ttype?: string\n\tclassName?: ClassValue\n\tautoFocus?: boolean\n\tvalidations?: FormValidations\n\tplaceholder?: string\n\tdisabled?: boolean\n\tstep?: number\n\tinputProps?: {\n\t\tmin?: number\n\t\tmax?: number\n\t\tstep?: number\n\t\tclassName?: string\n\t}\n}\n\nconst FormInput: FC<FormInputProps> = ({\n\tas = 'input',\n\tname,\n\tlabel,\n\ttype = 'text',\n\tclassName,\n\tautoFocus = false,\n\tvalidations = {},\n\tplaceholder,\n\tdisabled = false,\n\tinputProps = {},\n}) => {\n\tconst ref = useAutoFocus<HTMLInputElement>(autoFocus)\n\n\tconst Comp = as\n\n\tconst [{ value }, , { setValue, setTouched }] = useField({\n\t\tname,\n\t\ttype,\n\t\tvalidate: validate(validations),\n\t})\n\n\tconst formik = useFormikContext()\n\n\tconst [token] = useState(uuidv4())\n\n\tconst { className: extraClassName, ...extraProps } = inputProps\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<div className=\"text-[0px] leading-none select-none\">{token}</div>\n\n\t\t\t<div className={clsx('relative rounded-md', label && 'mt-1')}>\n\t\t\t\t<Comp\n\t\t\t\t\tref={ref}\n\t\t\t\t\ttype={type}\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>) => setValue(e.target.value)}\n\t\t\t\t\tonBlur={() => {\n\t\t\t\t\t\tsetTouched(true)\n\t\t\t\t\t}}\n\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\tdisabled={disabled || formik.isSubmitting}\n\t\t\t\t\tclassName={clsx(extraClassName)}\n\t\t\t\t\t{...(Comp === 'input' ? extraProps : {})}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default FormInput\n","import { FC } from 'react'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport { watch } from '@primer/components/Form/utils'\nimport FormInput from '@primer/components/Form/FormInput'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport Stack from '@primer/components/Stack'\nimport { FieldModel } from 'db/types'\nimport FormDate from '@primer/components/Form/FormDate'\nimport { CheckIcon, PlusIcon, XIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport FormInputRaw from '@primer/components/Form/FormInputRaw'\nimport useFieldArray from '@primer/components/Form/useFieldArray'\nimport clsx from 'clsx'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { slugify } from '@primer/utils/funcs'\n\nexport const typeOptions = [\n\t{ value: 'string', label: 'Text' },\n\t{ value: 'number', label: 'Number' },\n\t{ value: 'boolean', label: 'Boolean' },\n\t{ value: 'date', label: 'Date' },\n\t{ value: 'option', label: 'Options' },\n]\n\ntype FormFieldModel = FieldModel\n\ninterface OpenFieldProps {\n\tmode?: 'create' | 'edit'\n\tfield: FormFieldModel\n}\n\nconst openField = (props: OpenFieldProps) => {\n\treturn openSlideout<FormFieldModel>({\n\t\trender: (close) => <Component close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = FormFieldModel\n\nconst Component: FC<OpenFieldProps & { close: SlideoutResolveFn<FormFieldModel> }> = ({\n\tmode = 'create',\n\tfield,\n\tclose,\n}) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\t...field,\n\t\t\tdateFormat: 'dd/MM/yyyy',\n\t\t} as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tclose({\n\t\t\t\t...formData,\n\t\t\t\tkey: slugify(formData.name),\n\t\t\t})\n\t\t},\n\t})\n\n\tconst type = watch('type', formContext)\n\tconst { values: options, arrayHelpers: optionsHelpers } = useFieldArray('options', formContext)\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={mode === 'create' ? 'Create Entity Field' : 'Edit Entity Field'} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\tname=\"type\"\n\t\t\t\t\t\t\t\tlabel=\"Type\"\n\t\t\t\t\t\t\t\toptions={typeOptions}\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Type is required' }}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t{type === 'string' && <FormInput name=\"defaultValue\" label=\"Default Value\" />}\n\t\t\t\t\t\t\t{type === 'number' && <FormInput name=\"defaultValue\" label=\"Default Value\" type=\"number\" />}\n\t\t\t\t\t\t\t{type === 'boolean' && (\n\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\tname=\"defaultValue\"\n\t\t\t\t\t\t\t\t\tlabel=\"Default Value\"\n\t\t\t\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t\t\t\t{ value: 'false', label: 'False' },\n\t\t\t\t\t\t\t\t\t\t{ value: 'true', label: 'True' },\n\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{type === 'date' && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<FormDate name=\"defaultValue\" label=\"Default Value\" />\n\t\t\t\t\t\t\t\t\t<FormInput name=\"dateFormat\" label=\"Date Format\" />\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{type === 'option' && (\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t{options.map((x, i) => (\n\t\t\t\t\t\t\t\t\t\t<div key={i} className=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute z-[2] top-0 left-0 ml-3 h-full flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs font-medium rounded-full w-5 h-5 bg-gray-200 dark:bg-gray-700 dark:text-gray-100 flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{i + 1}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<FormInputRaw\n\t\t\t\t\t\t\t\t\t\t\t\tname={`options[${i}]`}\n\t\t\t\t\t\t\t\t\t\t\t\tinputProps={{\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: clsx(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'py-2 pl-12 pr-8 -mb-px relative text-sm w-full border border-gray-300 dark:border-gray-600 focus:z-[1] focus:ring-1 focus:ring-primary-500 focus:border-primary-500 dark:focus:border-primary-500 bg-white dark:bg-gray-800 dark:text-gray-100',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ti === 0 && 'rounded-t-md',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ti === options.length - 1 && 'rounded-b-md'\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t{options.length > 1 && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute z-[1] top-0 right-0 mr-3 h-full flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-full w-5 h-5 bg-red-100 dark:bg-red-500 dark:bg-opacity-25 text-red-500 flex items-center justify-center focus:ring-2 focus:ring-red-500 transition-shadow\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => optionsHelpers.remove(i)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<XIcon className=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t<div className=\"mt-2 flex justify-end\">\n\t\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add option',\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-4 h-4\" />,\n\t\t\t\t\t\t\t\t\t\t\t\tsize: 'sm',\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => optionsHelpers.push(''),\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<FormInput name=\"defaultValue\" label=\"Default Value\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<FormInput name=\"description\" label=\"Description\" />\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-end\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openField\n","import { FC } from 'react'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport { ActionModel, FieldModel } from 'db/types'\nimport { CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport { SlideoutResolveFn } from '@primer/types'\nimport { slugify } from '@primer/utils/funcs'\n\ntype FormActionModel = ActionModel\n\ninterface OpenActionProps {\n\tmode?: 'create' | 'edit'\n\taction: FormActionModel\n\tfields: FieldModel[]\n}\n\nconst openAction = (props: OpenActionProps) => {\n\treturn openSlideout<FormActionModel>({\n\t\tsize: '2xl',\n\t\trender: (close) => <Component close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = FormActionModel\n\nconst Component: FC<OpenActionProps & { close: SlideoutResolveFn<FormActionModel> }> = ({\n\tmode = 'create',\n\taction,\n\tfields,\n\tclose,\n}) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: action as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tclose({\n\t\t\t\t...formData,\n\t\t\t\tkey: slugify(formData.name),\n\t\t\t})\n\t\t},\n\t})\n\n\t// const { values: changes, arrayHelpers: changesHelpers } = useFieldArray('changes', formContext)\n\n\t// const getEntityField = (id?: string) => fields.find((x) => x.id === id)\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={mode === 'create' ? 'Create Action' : 'Edit Action'} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t{/* <div>\n\t\t\t\t\t\t\t\t<FormLabel>Changes</FormLabel>\n\t\t\t\t\t\t\t\t<Well className=\"mt-2\">\n\t\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t\t{changes.filter(isNotNone).map((change, i) => {\n\t\t\t\t\t\t\t\t\t\t\tlet entityField = getEntityField(change.fieldId)\n\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<div key={i} className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>Set</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[200px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`changes[${i}].fieldId`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={fields.map((x) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: x.id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: x.name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{entityField?.type === 'boolean' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>to</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[200px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`changes[${i}].newValue`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ label: 'True', value: 'true' },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ label: 'False', value: 'false' },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{entityField?.type === 'string' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>to</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[200px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormInput name={`changes[${i}].newValue`} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{entityField?.type === 'date' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>to</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[300px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`changes[${i}].newValue`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'Current Time',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: 'current-time',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{entityField?.type === 'option' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormLabel>to</FormLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-[300px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`changes[${i}].newValue`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={entityField.options.map((x) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: x,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: x,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add change',\n\t\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\t\t\t\t\t\t\t\tchangesHelpers.push({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: uuid(),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserDefined: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t</Well>\n\t\t\t\t\t\t\t</div> */}\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-end\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openAction\n","import { FC } from 'react'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport Stack from '@primer/components/Stack'\nimport { RelationModel } from 'db/types'\nimport { CheckIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport { SlideoutResolveFn } from '@primer/types'\nimport FormSelect from '@primer/components/Form/FormSelect'\nimport db from 'db'\nimport { slugify } from '@primer/utils/funcs'\nimport FormInput from '@primer/components/Form/FormInput'\n\nexport const relationTypeOptions = [\n\t{ value: 'one-to-one', label: 'Single' },\n\t{ value: 'one-to-many', label: 'Many' },\n]\n\nexport const oppositeRelationTypeOptions = [\n\t{ value: 'one-to-one', label: 'Single' },\n\t{ value: 'one-to-many', label: 'Single' },\n]\n\ntype FormRelationModel = RelationModel\n\ninterface OpenConnectionProps {\n\tmode?: 'create' | 'edit'\n\trelation: FormRelationModel\n}\n\nconst openRelation = (props: OpenConnectionProps) => {\n\treturn openSlideout<FormRelationModel>({\n\t\trender: (close) => <Component close={close} {...props} />,\n\t})\n}\n\ntype FormSchema = FormRelationModel\n\nconst Component: FC<OpenConnectionProps & { close: SlideoutResolveFn<FormRelationModel> }> = ({\n\tmode = 'create',\n\trelation,\n\tclose,\n}) => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: relation as FormSchema,\n\t\tonSubmit: (formData) => {\n\t\t\tclose({\n\t\t\t\t...formData,\n\t\t\t\tkey: slugify(formData.name),\n\t\t\t})\n\t\t},\n\t})\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={mode === 'create' ? 'Create Connection' : 'Edit Connection'} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\">\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<FormInput name=\"name\" label=\"Name\" validations={{ required: 'Name is required' }} />\n\n\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\tname=\"relatedId\"\n\t\t\t\t\t\t\t\tlabel=\"Entity\"\n\t\t\t\t\t\t\t\toptions={db.entities.all().map((x) => ({ value: x.id, label: x.name }))}\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Entity is required' }}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\tname=\"type\"\n\t\t\t\t\t\t\t\tlabel=\"Cardinality\"\n\t\t\t\t\t\t\t\toptions={relationTypeOptions}\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Cardinality is required' }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-end\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\nexport default openRelation\n","import { FC, useState } from 'react'\nimport { v4 as uuid } from 'uuid'\nimport Card, { CardWrapper } from '@primer/components/Card'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageContent from '@primer/components/PageContent'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon, CheckIcon, PencilIcon, PlusIcon, XIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport Stack from '@primer/components/Stack'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport db from 'db'\nimport {\n\tActionModel,\n\tActionPermissionModel,\n\tRelationModel,\n\tRelationPermissionModel,\n\tFieldModel,\n\tFieldPermissionModel,\n} from 'db/types'\nimport useFieldArray from '@primer/components/Form/useFieldArray'\nimport FormSection from '@primer/components/Form/FormSection'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport openField, { typeOptions } from 'slideouts/openField'\nimport openAction from 'slideouts/openAction'\nimport { confirm } from '@primer/alerts'\nimport { slugify } from '@primer/utils/funcs'\nimport openRelation, { relationTypeOptions, oppositeRelationTypeOptions } from 'slideouts/openRelation'\nimport produce from 'immer'\n\ntype FormFieldModel = FieldModel & { permissions: FieldPermissionModel[] }\ntype FormActionModel = ActionModel & { permissions: ActionPermissionModel[] }\ntype FormRelationModel = RelationModel & { permissions: RelationPermissionModel[] }\n\ninterface FormSchema {\n\tname: string\n\tplural: string\n\tfields: FormFieldModel[]\n\tactions: FormActionModel[]\n\trelations: FormRelationModel[]\n}\n\nconst EntityForm: FC<RouteComponentProps<{ id: string; mode: 'create' | 'edit' }>> = ({ id, mode }) => {\n\tconst original = db.entities.find(id)\n\n\tconst originalFields = db.fields.all((x) => x.entityId === id)\n\tconst originalActions = db.actions.all((x) => x.entityId === id)\n\tconst originalRelations = db.relations.all((x) => x.entityId === id || x.relatedId === id)\n\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\tname: original?.name || '',\n\t\t\tplural: original?.plural || '',\n\t\t\tfields: originalFields\n\t\t\t\t? originalFields.map((x) => ({\n\t\t\t\t\t\t...x,\n\t\t\t\t\t\tpermissions: db.fieldPermissions.all((y) => y.fieldId === x.id),\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t\t\tactions: originalActions\n\t\t\t\t? originalActions.map((x) => ({\n\t\t\t\t\t\t...x,\n\t\t\t\t\t\tpermissions: db.actionPermissions.all((y) => y.actionId === x.id),\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t\t\trelations: originalRelations\n\t\t\t\t? originalRelations.map((x) => ({\n\t\t\t\t\t\t...x,\n\t\t\t\t\t\tpermissions: db.relationPermissions.all((y) => y.relationId === x.id),\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t\t},\n\t\tonSubmit: (formSchema) => {\n\t\t\tconst newEntityType = db.entities.save({\n\t\t\t\t...original,\n\t\t\t\tkey: slugify(formSchema.name),\n\t\t\t\tname: formSchema.name,\n\t\t\t\tplural: formSchema.plural,\n\t\t\t})\n\n\t\t\tformSchema.fields.forEach((entityField) => {\n\t\t\t\tdb.fields.save({\n\t\t\t\t\t...entityField,\n\t\t\t\t\tentityId: newEntityType.id,\n\t\t\t\t})\n\t\t\t})\n\n\t\t\tformSchema.actions.forEach((entityAction) => {\n\t\t\t\tdb.actions.save({\n\t\t\t\t\t...entityAction,\n\t\t\t\t\tentityId: newEntityType.id,\n\t\t\t\t})\n\t\t\t})\n\n\t\t\tformSchema.relations.forEach((relation) => {\n\t\t\t\tdb.relations.save({\n\t\t\t\t\t...relation,\n\t\t\t\t\tentityId: newEntityType.id,\n\t\t\t\t})\n\t\t\t})\n\n\t\t\ttoDelete.fields.forEach(db.fields.remove)\n\t\t\ttoDelete.actions.forEach(db.actions.remove)\n\t\t\ttoDelete.relations.forEach(db.relations.remove)\n\n\t\t\tnavigate(`${process.env.PUBLIC_URL}/settings/entities`)\n\t\t},\n\t})\n\n\tconst { values: fields, arrayHelpers: fieldsHelpers } = useFieldArray('fields', formContext)\n\tconst { values: actions, arrayHelpers: actionsHelpers } = useFieldArray('actions', formContext)\n\tconst { values: relations, arrayHelpers: relationsHelpers } = useFieldArray('relations', formContext)\n\n\tconst [toDelete, setToDelete] = useState<{\n\t\tfields: string[]\n\t\tactions: string[]\n\t\trelations: string[]\n\t}>({\n\t\tfields: [],\n\t\tactions: [],\n\t\trelations: [],\n\t})\n\n\tconst fieldSchema: TableSchema<FormFieldModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Type',\n\t\t\t\tvalue: (x) => typeOptions.find((y) => y.value === x.type)?.label || '',\n\t\t\t},\n\t\t],\n\t\tactions: (x, i) => [\n\t\t\t{\n\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tonClick: async () => {\n\t\t\t\t\tconst editedField = await openField({ mode: 'edit', field: x })\n\t\t\t\t\tif (editedField) {\n\t\t\t\t\t\tfieldsHelpers.replace(i, editedField)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: <XIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu-danger',\n\t\t\t\tonClick: () => {\n\t\t\t\t\tconfirm({\n\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\tfieldsHelpers.remove(i)\n\t\t\t\t\t\t\tsetToDelete(\n\t\t\t\t\t\t\t\tproduce((draft) => {\n\t\t\t\t\t\t\t\t\tdraft.fields.push(x.id)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t}\n\n\tconst actionsSchema: TableSchema<FormActionModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t],\n\t\tactions: (x, i) => [\n\t\t\t{\n\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tonClick: async () => {\n\t\t\t\t\tconst editedAction = await openAction({ mode: 'edit', action: x, fields })\n\t\t\t\t\tif (editedAction) {\n\t\t\t\t\t\tactionsHelpers.replace(i, editedAction)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: <XIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu-danger',\n\t\t\t\tonClick: () => {\n\t\t\t\t\tconfirm({\n\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\tactionsHelpers.remove(i)\n\t\t\t\t\t\t\tsetToDelete(\n\t\t\t\t\t\t\t\tproduce((draft) => {\n\t\t\t\t\t\t\t\t\tdraft.actions.push(x.id)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t}\n\n\tconst relationSchema: TableSchema<FormRelationModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Related Entity',\n\t\t\t\tvalue: (x) =>\n\t\t\t\t\tx.entityId === id\n\t\t\t\t\t\t? db.entities.find((y) => y.id === x.relatedId)?.name\n\t\t\t\t\t\t: db.entities.find((y) => y.id === x.entityId)?.name,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Cardinality',\n\t\t\t\tvalue: (x) =>\n\t\t\t\t\tx.entityId === id\n\t\t\t\t\t\t? relationTypeOptions.find((y) => y.value === x.type)?.label\n\t\t\t\t\t\t: oppositeRelationTypeOptions.find((y) => y.value === x.type)?.label,\n\t\t\t},\n\t\t],\n\t\tactions: (x, i) => [\n\t\t\tx.entityId === id && {\n\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tonClick: async () => {\n\t\t\t\t\tconst editedRelation = await openRelation({ mode: 'edit', relation: x })\n\t\t\t\t\tif (editedRelation) {\n\t\t\t\t\t\trelationsHelpers.replace(i, editedRelation)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tx.entityId === id && {\n\t\t\t\ticon: <XIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu-danger',\n\t\t\t\tonClick: () => {\n\t\t\t\t\tconfirm({\n\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\trelationsHelpers.remove(i)\n\t\t\t\t\t\t\tsetToDelete(\n\t\t\t\t\t\t\t\tproduce((draft) => {\n\t\t\t\t\t\t\t\t\tdraft.relations.push(x.id)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t}\n\n\tconst title = mode === 'create' ? 'Create Entity' : 'Edit Entity'\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/entities',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<Form context={formContext}>\n\t\t\t\t<PageContent>\n\t\t\t\t\t<Stack dividers>\n\t\t\t\t\t\t<FormSection title=\"Details\" subtitle=\"The name and different types of labels for the entity\">\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t<FormInput name=\"plural\" label=\"Plural\" />\n\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Fields\"\n\t\t\t\t\t\t\tsubtitle=\"Fields are custom fields that are attached to this entity, that can be configured to contain many different kinds of data\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<CardWrapper className=\"rounded-md overflow-hidden\">\n\t\t\t\t\t\t\t\t\t<Table items={fields} schema={fieldSchema} className=\"-my-px\" />\n\t\t\t\t\t\t\t\t</CardWrapper>\n\n\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add Field Type',\n\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\t\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tlet id = uuid()\n\t\t\t\t\t\t\t\t\t\t\t\tconst newField = await openField({\n\t\t\t\t\t\t\t\t\t\t\t\t\tfield: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tentityId: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplural: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttemplate: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions: [''],\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (newField) fieldsHelpers.push(newField)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Actions\"\n\t\t\t\t\t\t\tsubtitle=\"Actions are custom interactions that the user can use do to this entity. They can modify a field, or be used as triggers for notifications.\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<CardWrapper className=\"rounded-md overflow-hidden\">\n\t\t\t\t\t\t\t\t\t<Table items={actions} schema={actionsSchema} className=\"-my-px\" />\n\t\t\t\t\t\t\t\t</CardWrapper>\n\n\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add Action',\n\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\t\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tlet id = uuid()\n\t\t\t\t\t\t\t\t\t\t\t\tconst newAction = await openAction({\n\t\t\t\t\t\t\t\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tentityId: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchanges: [],\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\tfields,\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (newAction) actionsHelpers.push(newAction)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Relations\"\n\t\t\t\t\t\t\tsubtitle={\n\t\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\tRelations are a way to define a relationship between this entity type, and\n\t\t\t\t\t\t\t\t\t\tanother entity type.\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\tFor example, if a \"case has many events\", then a case should have a relation\n\t\t\t\t\t\t\t\t\t\tnamed \"Events\", set to the Event entity and a cardinality of \"Many\"\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<CardWrapper className=\"rounded-md overflow-hidden\">\n\t\t\t\t\t\t\t\t\t<Table items={relations} schema={relationSchema} className=\"-my-px\" />\n\t\t\t\t\t\t\t\t</CardWrapper>\n\n\t\t\t\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Add Relation',\n\t\t\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\t\tintent: 'invisible',\n\t\t\t\t\t\t\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tlet id = uuid()\n\t\t\t\t\t\t\t\t\t\t\t\tconst newRelation = await openRelation({\n\t\t\t\t\t\t\t\t\t\t\t\t\trelation: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tentityId: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trelatedId: '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'one-to-many',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (newRelation) relationsHelpers.push(newRelation)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: mode === 'create' ? 'Create' : 'Save',\n\t\t\t\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</PageContent>\n\t\t\t</Form>\n\t\t</>\n\t)\n}\n\nexport default EntityForm\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { BeakerIcon, DotsHorizontalIcon, PencilIcon, PlusIcon, TrashIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport { WorkflowModel } from 'db/types'\nimport db from 'db'\nimport { confirm } from '@primer/alerts'\n\nconst Workflows: FC<RouteComponentProps> = () => {\n\tconst schema: TableSchema<WorkflowModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t],\n\t\tactions: (x) => [\n\t\t\t{\n\t\t\t\ticon: <DotsHorizontalIcon className=\"w-5 h-5\" />,\n\t\t\t\tintent: 'menu',\n\t\t\t\tactions: [\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Edit',\n\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tto: `/settings/workflows/${x.id}/edit`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Test',\n\t\t\t\t\t\t\ticon: <BeakerIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\t\t\tintent: 'danger',\n\t\t\t\t\t\t\ticon: <TrashIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tdb.workflows.remove(x.id)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Workflows\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Create Workflow',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/workflows/create',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={db.workflows.all()} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Workflows\n","import { FC } from 'react'\nimport openSlideout, { SlideoutHeader, SlideoutContent } from '@primer/hooks/openSlideout'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Stack from '@primer/components/Stack'\nimport { CheckIcon, ExclamationCircleIcon } from '@heroicons/react/outline'\nimport Actions from '@primer/components/Actions'\nimport { SlideoutResolveFn } from '@primer/types'\nimport FormSelect, { Option } from '@primer/components/Form/FormSelect'\nimport { entityResource, fieldResource, WorkflowStepConnectionModel, WorkflowStepModel } from 'db/types'\nimport { WorkflowIcon } from 'components/Icon'\nimport { useFormikContext } from 'formik'\nimport { watch } from '@primer/components/Form/utils'\nimport FormToggle from '@primer/components/Form/FormToggle'\nimport db from 'db'\nimport { uuid } from 'utils/funcs'\n\nconst isStep = (x: any): x is WorkflowStepModel => x.id && x.name\nconst isConnection = (x: any): x is WorkflowStepConnectionModel => x.id && x.targetId\n\nconst triggerOptions: Option[] = [\n\t{\n\t\tvalue: 'document',\n\t\tlabel: 'A document was uploaded',\n\t},\n\t{\n\t\tvalue: 'field-update',\n\t\tlabel: 'A field was updated',\n\t},\n\t{\n\t\tvalue: 'date-met',\n\t\tlabel: 'A date was met',\n\t},\n\t{\n\t\tvalue: 'user-action',\n\t\tlabel: 'A user took an action',\n\t},\n]\n\ninterface CreateProps {\n\tmode: 'create'\n\tstep: WorkflowStepModel\n\telements?: (WorkflowStepModel | WorkflowStepConnectionModel)[]\n}\n\ninterface EditProps {\n\tmode: 'edit'\n\tstep: WorkflowStepModel\n\telements: (WorkflowStepModel | WorkflowStepConnectionModel)[]\n}\n\ntype OpenWorkflowStepProps = CreateProps | EditProps\n\nconst openWorkflowStep = (props: OpenWorkflowStepProps) => {\n\treturn openSlideout<FormSchema>({\n\t\trender: (close) => <Component close={close} {...props} />,\n\t})\n}\n\ntype ConnectionRecords = Record<string, WorkflowStepConnectionModel>\n\ninterface FormSchema {\n\tid: string\n\tworkflowId: string\n\tname: string\n\tdescription: string\n\tisTransition: boolean\n\tisStart: boolean\n\ttargetWorkflow: string\n\tposX: number\n\tposY: number\n\tconnections: ConnectionRecords\n}\n\nconst Component: FC<OpenWorkflowStepProps & { close: SlideoutResolveFn<FormSchema> }> = ({\n\tmode = 'create',\n\tstep,\n\telements = [],\n\tclose,\n}) => {\n\tconst connections = elements.filter(isConnection)\n\tconst outgoingConnections = connections.filter((x) => x.sourceId === step.id)\n\tconst incomingConnections = connections.filter((x) => x.targetId === step.id)\n\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\tid: step.id || uuid(),\n\t\t\tworkflowId: step.workflowId || '',\n\t\t\tname: step.name || '',\n\t\t\tdescription: step.description || '',\n\t\t\tisTransition: step.isTransition || false,\n\t\t\tisStart: step.isStart || false,\n\t\t\ttargetWorkflow: step.targetWorkflow || '',\n\t\t\tposX: step.posX || 0,\n\t\t\tposY: step.posY || 0,\n\t\t\tconnections: outgoingConnections.reduce((list, con) => ({ ...list, [con.id]: con }), {}),\n\t\t},\n\t\tonSubmit: (formData) => {\n\t\t\tclose(formData)\n\t\t},\n\t})\n\n\tconst isTransition = watch('isTransition', formContext)\n\tconst startStep = elements.filter(isStep).find((x) => x.isStart)\n\n\treturn (\n\t\t<Form context={formContext} className=\"contents\">\n\t\t\t<SlideoutHeader title={mode === 'create' ? 'Create Workflow Step' : 'Edit Workflow Step'} />\n\n\t\t\t<SlideoutContent>\n\t\t\t\t<Stack className=\"py-6\" dividers>\n\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-800\">Details</div>\n\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">Basic info about the step</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Name is required' }}\n\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\tname=\"description\"\n\t\t\t\t\t\t\t\tlabel=\"Description\"\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t// validations={{ required: 'Description is required' }}\n\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Stack>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{incomingConnections.length === 0 && (!startStep || startStep.id === step.id) && (\n\t\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-800\">Starting Point</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\tIs this step the beginning of the workflow\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<FormToggle name=\"isStart\" label=\"Is Start\" />\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{mode === 'edit' && (\n\t\t\t\t\t\t<div className=\"px-6\">\n\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-800\">Triggers</div>\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\tWhat conditions cause the case to move to a next step\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{outgoingConnections.length !== 0 ? (\n\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col space-y-4\">\n\t\t\t\t\t\t\t\t\t\t{outgoingConnections.map((con) => (\n\t\t\t\t\t\t\t\t\t\t\t<TriggerSection key={con.id} connection={con} elements={elements} />\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Stack>\n\t\t\t\t\t\t\t\t\t\t<FormToggle name=\"isTransition\" label=\"Is a transition to another workflow\" />\n\t\t\t\t\t\t\t\t\t\t{!isTransition ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"p-4 flex items-center justify-start space-x-3 text-sm font-medium rounded-md bg-yellow-50 text-yellow-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t<ExclamationCircleIcon className=\"w-5 h-5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<div>No steps are connected after this one</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"targetWorkflow\"\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Workflow to transition to\"\n\t\t\t\t\t\t\t\t\t\t\t\toptions={db.workflows\n\t\t\t\t\t\t\t\t\t\t\t\t\t.all()\n\t\t\t\t\t\t\t\t\t\t\t\t\t.filter((x) => x.id !== step.workflowId)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map((x) => ({ label: x.name, value: x.id }))}\n\t\t\t\t\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Required' }}\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</Stack>\n\t\t\t</SlideoutContent>\n\n\t\t\t<div className=\"p-6 border-t border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-750 flex justify-end\">\n\t\t\t\t<Actions\n\t\t\t\t\tactions={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Cancel',\n\t\t\t\t\t\t\tonClick: () => close(),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Form>\n\t)\n}\n\ninterface TriggerSectionProps {\n\tconnection: WorkflowStepConnectionModel\n\telements: (WorkflowStepModel | WorkflowStepConnectionModel)[]\n}\n\nconst TriggerSection: FC<TriggerSectionProps> = ({ connection, elements }) => {\n\tconst formContext = useFormikContext<FormSchema>()\n\n\tconst trigger = watch(`connections.${connection.id}.trigger`, formContext)\n\tconst triggerField = watch(`connections.${connection.id}.field`, formContext)\n\tconst field = fieldResource(triggerField)\n\n\tconst fieldOptions =\n\t\tentityResource((x) => x.key === 'case')?.fields?.map((x) => ({ label: x.name, value: x.id })) || []\n\n\treturn (\n\t\t<div className=\"flex flex-col space-y-4 px-2 pt-1 pb-2 border border-gray-200 rounded-md\">\n\t\t\t<div className=\"flex space-x-2 items-center\">\n\t\t\t\t<WorkflowIcon className=\"w-5 h-5\" />\n\t\t\t\t<div className=\"font-medium\">\n\t\t\t\t\t{elements.filter(isStep).find((x) => x.id === connection.targetId)?.name}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"bg-white rounded-md p-1 pt-4\">\n\t\t\t\t<Stack>\n\t\t\t\t\t<FormSelect\n\t\t\t\t\t\tname={`connections.${connection.id}.trigger`}\n\t\t\t\t\t\tlabel=\"What happened\"\n\t\t\t\t\t\toptions={triggerOptions}\n\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\tvalidations={{ required: 'Required' }}\n\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t{trigger === 'field-update' ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\tname={`connections.${connection.id}.field`}\n\t\t\t\t\t\t\t\tlabel=\"Which field\"\n\t\t\t\t\t\t\t\toptions={fieldOptions}\n\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t\tvalidations={{ required: 'Required' }}\n\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{field &&\n\t\t\t\t\t\t\t\t(field?.type === 'option' ? (\n\t\t\t\t\t\t\t\t\t<FormSelect\n\t\t\t\t\t\t\t\t\t\tname={`connections.${connection.id}.fieldValue`}\n\t\t\t\t\t\t\t\t\t\tlabel=\"To what value\"\n\t\t\t\t\t\t\t\t\t\toptions={field.options.map((x) => ({ label: x, value: x }))}\n\t\t\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Required' }}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<FormInput\n\t\t\t\t\t\t\t\t\t\tname={`connections.${connection.id}.fieldValue`}\n\t\t\t\t\t\t\t\t\t\tlabel=\"To what value\"\n\t\t\t\t\t\t\t\t\t\tintent=\"overlap\"\n\t\t\t\t\t\t\t\t\t\tvalidations={{ required: 'Required' }}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : null}\n\t\t\t\t</Stack>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default openWorkflowStep\n","import { FC, useCallback, useMemo, useRef, useState } from 'react'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport ReactFlow, {\n\tArrowHeadType,\n\tBackground,\n\tBackgroundVariant,\n\tConnection,\n\tConnectionLineType,\n\tConnectionMode,\n\tControls,\n\tEdge,\n\tElements,\n\tFlowElement,\n\tisEdge,\n\tisNode,\n\tNode,\n\tOnLoadParams,\n\tReactFlowProvider,\n\tuseStoreState,\n} from 'react-flow-renderer'\nimport Actions from '@primer/components/Actions'\nimport { ArrowLeftIcon, CheckIcon, PencilIcon, PlusIcon, XIcon } from '@heroicons/react/outline'\nimport Canvas from 'components/Layouts/Canvas'\nimport { uuid } from 'utils/funcs'\nimport clsx from 'clsx'\nimport openWorkflowStep from './openWorkflowStep'\nimport { workflowResource, WorkflowStepConnectionModel, WorkflowStepModel, workflowStepResource } from 'db/types'\nimport useDismissable from '@primer/hooks/useDismissable'\nimport db from 'db'\nimport FormLabel from '@primer/components/Form/FormLabel'\nimport dagre from 'dagre'\nimport { confirm } from '@primer/alerts'\n\nconst dagreGraph = new dagre.graphlib.Graph()\ndagreGraph.setDefaultEdgeLabel(() => ({}))\n\nconst withFlowProvider = <T,>(Comp: FC<T>) => {\n\treturn (props: T) => {\n\t\treturn (\n\t\t\t<ReactFlowProvider>\n\t\t\t\t<Comp {...props} />\n\t\t\t</ReactFlowProvider>\n\t\t)\n\t}\n}\n\nconst getLayoutedElements = (elements: Elements, nodes: Node<any>[], direction = 'TB') => {\n\tconst isHorizontal = direction === 'LR'\n\tdagreGraph.setGraph({ rankdir: direction })\n\n\telements.forEach((el) => {\n\t\tif (isNode(el)) {\n\t\t\tlet node = nodes.find((x) => x.id === el.id)\n\t\t\tdagreGraph.setNode(el.id, { width: node?.__rf.width || 0, height: node?.__rf.height || 0 })\n\t\t} else {\n\t\t\tdagreGraph.setEdge(el.source, el.target)\n\t\t}\n\t})\n\n\tdagre.layout(dagreGraph)\n\n\treturn elements.map((el) => {\n\t\tif (isNode(el)) {\n\t\t\tlet node = nodes.find((x) => x.id === el.id)\n\n\t\t\tconst nodeWithPosition = dagreGraph.node(el.id)\n\t\t\t// @ts-ignore\n\t\t\tel.targetPosition = isHorizontal ? 'left' : 'top'\n\t\t\t// @ts-ignore\n\t\t\tel.sourcePosition = isHorizontal ? 'right' : 'bottom'\n\n\t\t\t// unfortunately we need this little hack to pass a slightly different position\n\t\t\t// to notify react flow about the change. Moreover we are shifting the dagre node position\n\t\t\t// (anchor=center center) to the top left so it matches the react flow node anchor point (top left).\n\t\t\tel.position = {\n\t\t\t\tx: nodeWithPosition.x - (node?.__rf.width || 0) / 2 + Math.random() / 1000 + 20,\n\t\t\t\ty: nodeWithPosition.y - (node?.__rf.height || 0) / 2 + 20,\n\t\t\t}\n\t\t}\n\n\t\treturn el\n\t})\n}\n\nconst WorkflowForm: FC<RouteComponentProps<{ id: string }> & { mode: string }> = withFlowProvider(({ id, mode }) => {\n\tconst workflowId = id || uuid()\n\n\tlet workflow = workflowResource(workflowId)\n\tlet [steps, setSteps] = useState<WorkflowStepModel[]>(workflow?.steps || [])\n\tlet [connections, setConnections] = useState<WorkflowStepConnectionModel[]>(\n\t\tsteps?.map((x) => workflowStepResource(x)?.connections || []).flat() || []\n\t)\n\n\tconst nodes = useStoreState((state) => state.nodes)\n\tconst edges = useStoreState((state) => state.edges)\n\n\tconst generateElements = useCallback(\n\t\t() => [\n\t\t\t...steps.map((x) => ({\n\t\t\t\tid: x.id,\n\t\t\t\ttype: x.isTransition ? 'output' : x.isStart ? 'input' : 'default',\n\t\t\t\tdata: {\n\t\t\t\t\tlabel: (\n\t\t\t\t\t\t<StepDisplay\n\t\t\t\t\t\t\tstep={x}\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tlet updatedStep = await openWorkflowStep({\n\t\t\t\t\t\t\t\t\tstep: x,\n\t\t\t\t\t\t\t\t\tmode: 'edit',\n\t\t\t\t\t\t\t\t\telements: [...steps, ...connections],\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tif (!updatedStep) return\n\n\t\t\t\t\t\t\t\tconst { connections: cons, ...updatedStepValues } = updatedStep\n\n\t\t\t\t\t\t\t\tsetSteps((s) => {\n\t\t\t\t\t\t\t\t\treturn s.map((y) => {\n\t\t\t\t\t\t\t\t\t\tif (!updatedStep) return y\n\n\t\t\t\t\t\t\t\t\t\treturn y.id !== x.id\n\t\t\t\t\t\t\t\t\t\t\t? y\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t...y,\n\t\t\t\t\t\t\t\t\t\t\t\t\t...updatedStepValues,\n\t\t\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tsetConnections((c) => {\n\t\t\t\t\t\t\t\t\treturn c.map((x) => {\n\t\t\t\t\t\t\t\t\t\tif (cons[x.id] === undefined) return x\n\t\t\t\t\t\t\t\t\t\treturn cons[x.id]\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\tconfirm({\n\t\t\t\t\t\t\t\t\ttitle: 'Are you sure you want to delete this step?',\n\t\t\t\t\t\t\t\t\tmessage: 'This cannot be undone',\n\t\t\t\t\t\t\t\t\tonAccept: () => {\n\t\t\t\t\t\t\t\t\t\tonElementsRemove([x])\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\tposition: { x: x.posX || 0, y: x.posY || 0 },\n\t\t\t})),\n\t\t\t...connections.map((x) => ({\n\t\t\t\tid: x.id,\n\t\t\t\tsource: x.sourceId,\n\t\t\t\ttarget: x.targetId,\n\t\t\t\ttype: ConnectionLineType.SmoothStep,\n\t\t\t\tarrowHeadType: ArrowHeadType.Arrow,\n\t\t\t})),\n\t\t],\n\t\t[steps, connections]\n\t)\n\n\tconst elements = useMemo(() => generateElements(), [generateElements])\n\n\tconst [stepsToDelete, setStepsToDelete] = useState<string[]>([])\n\tconst [connectionsToDelete, setConnectionsToDelete] = useState<string[]>([])\n\n\tconst onElementAdd = (element: WorkflowStepModel) => {\n\t\tsetSteps((s) => (!element ? s : [...s, element]))\n\t}\n\n\tconst onElementsRemove = (elementsToRemove: { id: string }[]) => {\n\t\telementsToRemove.forEach((el) => {\n\t\t\tsetSteps((x) => x.filter((y) => y.id !== el.id))\n\t\t\tsetConnections((x) => x.filter((y) => y.id !== el.id && y.targetId !== el.id && y.sourceId !== el.id))\n\t\t\tsetStepsToDelete((x) => [...x, el.id])\n\t\t\tsetConnectionsToDelete((x) => [...x, el.id])\n\t\t})\n\t}\n\n\tconst onConnect = (params: Edge | Connection) => {\n\t\tsetConnections((c) => {\n\t\t\tif (!params.source || !params.target) return c\n\t\t\treturn [\n\t\t\t\t...c,\n\t\t\t\t{\n\t\t\t\t\tid: uuid(),\n\t\t\t\t\tsourceId: params.source,\n\t\t\t\t\ttargetId: params.target,\n\t\t\t\t\ttrigger: '',\n\t\t\t\t\tfield: '',\n\t\t\t\t\tfieldValue: '',\n\t\t\t\t},\n\t\t\t]\n\t\t})\n\n\t\t// setElements((els) => addEdge({ ...params }, els))\n\t}\n\n\tconst updateNodePosition = (node: Node) => {\n\t\tsetSteps((s) => {\n\t\t\treturn s.map((x) =>\n\t\t\t\tx.id !== node.id\n\t\t\t\t\t? x\n\t\t\t\t\t: {\n\t\t\t\t\t\t\t...x,\n\t\t\t\t\t\t\tposX: node.position.x,\n\t\t\t\t\t\t\tposY: node.position.y,\n\t\t\t\t\t  }\n\t\t\t)\n\t\t})\n\t}\n\n\tconst doLayout = () => {\n\t\tlet layouted = getLayoutedElements(elements, nodes, 'TB')\n\n\t\tlayouted.forEach((x) => {\n\t\t\tif (isNode(x)) updateNodePosition(x)\n\t\t})\n\n\t\tif (instance) {\n\t\t\tinstance.setTransform({ x: 0, y: 0, zoom: 1 })\n\t\t}\n\t}\n\n\tconst [name, setName] = useState(workflow?.name || '')\n\n\tconst [instance, setInstance] = useState<OnLoadParams<any> | null>(null)\n\tconst containerRef = useRef<HTMLDivElement>(null)\n\tconst menuRef = useRef<HTMLDivElement>(null)\n\n\tconst [menuPos, setMenuPos] = useState<{ x: number; y: number }>({ x: 0, y: 0 })\n\n\tconst { open, setOpen, ref: clickRef } = useDismissable()\n\n\tconst save = () => {\n\t\tdb.workflows.save({ id: workflowId, name })\n\n\t\tsteps.forEach((step) => {\n\t\t\tlet node = nodes.find((x) => x.id === step.id)\n\n\t\t\tif (!workflowId || !node || !isNode(node)) return\n\n\t\t\tdb.workflowSteps.save({\n\t\t\t\tid: step.id,\n\t\t\t\tworkflowId,\n\t\t\t\tname: step.name,\n\t\t\t\tdescription: step.description,\n\t\t\t\ttargetWorkflow: step.targetWorkflow,\n\t\t\t\tisTransition: step.isTransition,\n\t\t\t\tisStart: step.isStart,\n\t\t\t\tposX: node?.position.x,\n\t\t\t\tposY: node?.position.y,\n\t\t\t})\n\t\t})\n\n\t\tconnections.forEach((connection) => {\n\t\t\tlet edge = edges.find((x) => x.id === connection.id)\n\n\t\t\tif (!edge || !isEdge(edge)) return\n\n\t\t\tdb.workflowStepConnections.save({\n\t\t\t\tid: connection.id,\n\t\t\t\tsourceId: edge.source,\n\t\t\t\ttargetId: edge.target,\n\t\t\t\ttrigger: connection.trigger,\n\t\t\t\tfield: connection.field,\n\t\t\t\tfieldValue: connection.fieldValue,\n\t\t\t})\n\t\t})\n\n\t\tstepsToDelete.forEach((id) => {\n\t\t\tdb.workflowSteps.remove(id)\n\t\t})\n\n\t\tconnectionsToDelete.forEach((id) => {\n\t\t\tdb.workflowStepConnections.remove(id)\n\t\t})\n\n\t\tnavigate(`${process.env.PUBLIC_URL}/settings/workflows`)\n\t}\n\n\treturn (\n\t\t<Canvas className=\"flex flex-col\" noBackground>\n\t\t\t<div className=\"flex justify-between bg-white shadow h-16\">\n\t\t\t\t<div className=\"flex items-center p-4 border-r border-gray-300\">\n\t\t\t\t\t<Actions\n\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\tonClick: () => window.history.back(),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-1 flex items-center px-6 border-r border-gray-300 space-x-6\">\n\t\t\t\t\t<div className=\"text-2xl font-medium\">{mode === 'create' ? 'Create' : 'Edit'} Workflow</div>\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<FormLabel>Name:</FormLabel>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\t\tonChange={(e) => setName(e.target.value)}\n\t\t\t\t\t\t\tclassName=\"form-input\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={doLayout}\n\t\t\t\t\t\t\tclassName=\"text-sm font-medium px-3 py-2 rounded-md border border-gray-200 shadow-sm ring-0 focus:ring-1 focus:border-primary-500 focus:ring-primary-500 transition-all duration-100\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tReorganise\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex items-center px-6\">\n\t\t\t\t\t<Actions\n\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\tonClick: () => save(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"flex-1 flex relative\" ref={containerRef}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={clsx('absolute z-10 shadow-lg rounded-md', !open && 'hidden')}\n\t\t\t\t\tstyle={{ left: menuPos.x + 'px', top: menuPos.y + 'px' }}\n\t\t\t\t\tref={menuRef}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"p-2 bg-white rounded-md ring-1 ring-black ring-opacity-5\" ref={clickRef}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"text-sm font-medium hover:bg-primary-50 active:bg-primary-100 flex items-center px-4 py-2 text-left leading-5 rounded-md\"\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tsetOpen(false)\n\t\t\t\t\t\t\t\tlet newStep = await openWorkflowStep({\n\t\t\t\t\t\t\t\t\tmode: 'create',\n\t\t\t\t\t\t\t\t\tstep: {\n\t\t\t\t\t\t\t\t\t\tid: uuid(),\n\t\t\t\t\t\t\t\t\t\tworkflowId,\n\t\t\t\t\t\t\t\t\t\tposX: menuPos.x,\n\t\t\t\t\t\t\t\t\t\tposY: menuPos.y,\n\t\t\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\telements: [...connections, ...steps],\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tif (!newStep) return\n\n\t\t\t\t\t\t\t\tconst { connections: cons, ...newStepValues } = newStep\n\n\t\t\t\t\t\t\t\tonElementAdd(newStepValues as WorkflowStepModel)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PlusIcon className=\"w-5 h-5 mr-2 -ml-1\" />\n\t\t\t\t\t\t\tAdd Step\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<ReactFlow\n\t\t\t\t\telements={elements}\n\t\t\t\t\tonElementsRemove={onElementsRemove}\n\t\t\t\t\tonNodeDragStop={(_, node) => updateNodePosition(node)}\n\t\t\t\t\tonSelectionDragStop={(_, nodes) => {\n\t\t\t\t\t\tnodes.filter(isNode).forEach((node) => {\n\t\t\t\t\t\t\tupdateNodePosition(node)\n\t\t\t\t\t\t})\n\t\t\t\t\t}}\n\t\t\t\t\tonLoad={(instance) => setInstance(instance)}\n\t\t\t\t\tonConnect={onConnect}\n\t\t\t\t\tdeleteKeyCode={8} /* backspace-key */\n\t\t\t\t\tonClick={() => setOpen(false)}\n\t\t\t\t\tonPaneContextMenu={(e) => {\n\t\t\t\t\t\te.preventDefault()\n\n\t\t\t\t\t\tlet rect = containerRef.current?.getBoundingClientRect()\n\n\t\t\t\t\t\tlet x = e.pageX - (rect?.left || 0)\n\t\t\t\t\t\tlet y = e.pageY - (rect?.top || 0)\n\n\t\t\t\t\t\tsetOpen(true)\n\t\t\t\t\t\tsetMenuPos({ x, y })\n\t\t\t\t\t}}\n\t\t\t\t\tconnectionMode={ConnectionMode.Loose}\n\t\t\t\t>\n\t\t\t\t\t<Controls />\n\t\t\t\t\t<Background variant={BackgroundVariant.Dots} gap={12} size={1} color={'#ccc'} />\n\t\t\t\t</ReactFlow>\n\t\t\t</div>\n\t\t</Canvas>\n\t)\n})\n\nconst StepDisplay: FC<{ step: WorkflowStepModel; onClick: () => void; onDelete: () => void }> = ({\n\tstep,\n\tonClick,\n\tonDelete,\n}) => {\n\treturn (\n\t\t<div className=\"relative\">\n\t\t\t<button\n\t\t\t\tclassName=\"absolute top-0 right-0 -mt-4 -mr-4 w-5 h-5 rounded-full bg-red-100 hover:bg-red-200 transition-colors duration-100 ring-2 ring-white flex items-center justify-center\"\n\t\t\t\tonClick={onDelete}\n\t\t\t>\n\t\t\t\t<XIcon className=\"w-4 h-4 text-red-500\" />\n\t\t\t</button>\n\n\t\t\t<div className=\"px-2 flex items-center space-x-4 relative\">\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"w-8 h-8 rounded-full flex items-center justify-center bg-gray-200 hover:bg-gray-300 text-gray-600 transition-all duration-100\"\n\t\t\t\t\tonClick={onClick}\n\t\t\t\t>\n\t\t\t\t\t<PencilIcon className=\"w-5 h-5\" />\n\t\t\t\t</button>\n\n\t\t\t\t<div className=\"flex flex-col items-start\">\n\t\t\t\t\t<div className=\"text-base text-gray-900 font-medium\">{step.name}</div>\n\t\t\t\t\t<div className=\"text-sm text-gray-500 text-left\">{step?.description}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default WorkflowForm\n","import { isNotNone } from '@primer/types'\nimport db from 'db'\nimport { Model, Identifier } from 'types/db'\nimport { workflowStepResource, WorkflowStepResource } from '.'\n\nexport interface WorkflowModel extends Model {\n\tname: string\n}\n\nexport interface WorkflowResource extends WorkflowModel {\n\treadonly steps: WorkflowStepResource[]\n}\n\nexport const workflowResource = (id: Identifier<WorkflowModel>): WorkflowResource | null => {\n\tlet data = typeof id === 'string' || typeof id === 'function' ? db.workflows.find(id) : id\n\n\tif (!data) return null\n\n\treturn {\n\t\t...data,\n\t\tget steps() {\n\t\t\treturn db.workflowSteps\n\t\t\t\t.all((x) => x.workflowId === data?.id)\n\t\t\t\t.map(workflowStepResource)\n\t\t\t\t.filter(isNotNone)\n\t\t},\n\t}\n}\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport Table, { TableSchema } from '@primer/components/Table'\nimport { PlusIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\n\ninterface ModuleModel {\n\tname: string\n}\n\nconst modules = [{ name: 'Shared Workspace' }, { name: 'Document Production' }, { name: 'Document Exchange' }]\n\nconst Modules: FC<RouteComponentProps> = () => {\n\t// const editNotification = (x: ModuleModel) => null\n\t// const deleteNotification = (x: ModuleModel) => null\n\n\tconst schema: TableSchema<ModuleModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Name',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t},\n\t\t],\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Modules\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Add Module',\n\t\t\t\t\t\t\t\t\ticon: <PlusIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/modules/add',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden rounded-br-md\">\n\t\t\t\t\t\t<Table schema={schema} items={modules} className=\"-mb-px\" />\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Modules\n","import { FC, ReactNode } from 'react'\nimport clsx, { ClassValue } from 'clsx'\nimport { isNotNone, None } from '@primer/types'\n\ninterface DataItemType {\n\ttitle?: string\n\tvalue?: ReactNode\n}\n\ninterface DataListColumnsProps {\n\titems: (DataItemType | None)[]\n\tcolumns?: 1 | 2 | 3\n\tclassName?: ClassValue\n}\n\nconst columnClassNames = {\n\t1: '',\n\t2: 'sm:w-1/2',\n\t3: 'sm:w-1/3',\n}\n\nconst DataListColumns: FC<DataListColumnsProps> = ({ items, columns = 2, className }) => {\n\tconst cols = items\n\t\t.filter(isNotNone)\n\t\t.filter((x) => x.value)\n\t\t.reduce(\n\t\t\t(list: DataItemType[][], item: DataItemType) => {\n\t\t\t\tif (list[list.length - 1].length < columns) {\n\t\t\t\t\tlist[list.length - 1].push(item)\n\t\t\t\t\treturn list\n\t\t\t\t} else {\n\t\t\t\t\treturn [...list, [item]]\n\t\t\t\t}\n\t\t\t},\n\t\t\t[[]]\n\t\t)\n\n\treturn (\n\t\t<div className={clsx(className)}>\n\t\t\t<dl className=\"flex flex-col space-y-8\">\n\t\t\t\t{cols.map((lists, i) => (\n\t\t\t\t\t<div key={i} className=\"flex flex-col sm:flex-row sm:space-x-8 space-y-8 sm:space-y-0\">\n\t\t\t\t\t\t{lists.map((item, j) => (\n\t\t\t\t\t\t\t<div key={j} className={clsx('w-full', columnClassNames[columns])}>\n\t\t\t\t\t\t\t\t{item.title && (\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm leading-5 text-gray-500 dark:text-gray-300\">{item.title}</dt>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-5 break-all text-gray-900 dark:text-white\">\n\t\t\t\t\t\t\t\t\t{item.value}\n\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</dl>\n\t\t</div>\n\t)\n}\n\nexport default DataListColumns\n","import { ChangeEvent, FC } from 'react'\nimport clsx, { ClassValue } from 'clsx'\n\ninterface CheckboxProps {\n\tchecked: boolean\n\tname?: string\n\tlabel?: string\n\tclassName?: ClassValue\n\tdisabled?: boolean\n\tonChange?: (event: ChangeEvent<HTMLInputElement>) => void\n\tcolor?: string\n}\n\nconst Checkbox: FC<CheckboxProps> = ({\n\tchecked,\n\tname,\n\tlabel = '',\n\tclassName,\n\tdisabled,\n\tonChange,\n\tcolor = 'text-emerald-600 dark:text-emerald-500',\n}) => {\n\treturn (\n\t\t<label\n\t\t\tclassName={clsx(\n\t\t\t\t'text-sm font-medium leading-5 text-gray-700 dark:text-gray-200 inline-flex items-start cursor-pointer',\n\t\t\t\tclassName\n\t\t\t)}\n\t\t>\n\t\t\t<input\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\tname={name}\n\t\t\t\tid={name}\n\t\t\t\tchecked={checked}\n\t\t\t\tdisabled={disabled}\n\t\t\t\tonChange={onChange}\n\t\t\t\tclassName={clsx('form-checkbox rounded-sm border-gray-300 mt-1', {\n\t\t\t\t\t[color]: !disabled,\n\t\t\t\t\t'text-gray-400': disabled,\n\t\t\t\t})}\n\t\t\t/>\n\t\t\t{label && <span className=\"ml-3 mt-0.5 select-none\">{label}</span>}\n\t\t</label>\n\t)\n}\n\nexport default Checkbox\n","import { FC, useState } from 'react'\nimport { v4 as uuid } from 'uuid'\nimport PageHeading from '@primer/components/PageHeading'\nimport { RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon, CheckIcon } from '@heroicons/react/outline'\nimport Stack from '@primer/components/Stack'\nimport Actions from '@primer/components/Actions'\nimport PageContent from '@primer/components/PageContent'\nimport Card from '@primer/components/Card'\nimport clsx from 'clsx'\nimport DataListColumns from '@primer/components/DataListColumns'\nimport Checkbox from '@primer/components/Checkbox'\n\nconst modules = [\n\t{ id: uuid(), name: 'Shared Workspace' },\n\t{ id: uuid(), name: 'Document Production' },\n\t{ id: uuid(), name: 'Document Exchange' },\n\t{ id: uuid(), name: 'Video Conferencing' },\n\t{ id: uuid(), name: 'Peer Review' },\n]\n\nconst AddModule: FC<RouteComponentProps> = () => {\n\tconst [selected, setSelected] = useState<string[]>([])\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle=\"Add Module\"\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/modules',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>Add Module</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Stack>\n\t\t\t\t\t<Card>\n\t\t\t\t\t\t<div className=\"grid grid-cols-3 gap-6\">\n\t\t\t\t\t\t\t{modules.map((x) => (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={x.id}\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t'border rounded relative cursor-pointer shadow-sm',\n\t\t\t\t\t\t\t\t\t\t'col-span-1 min-h-[300px]',\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t'bg-white dark:bg-gray-750 border-gray-200 dark:border-gray-600':\n\t\t\t\t\t\t\t\t\t\t\t\t!selected.includes(x.id),\n\t\t\t\t\t\t\t\t\t\t\t'bg-primary-50 dark:bg-primary-500 dark:bg-opacity-25 border-primary-500 dark:border-primary-500 ring-1 ring-primary-500':\n\t\t\t\t\t\t\t\t\t\t\t\tselected.includes(x.id),\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tif (selected.includes(x.id)) {\n\t\t\t\t\t\t\t\t\t\t\tsetSelected((s) => s.filter((y) => y !== x.id))\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tsetSelected((s) => [...s, x.id])\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Stack className=\"p-4\">\n\t\t\t\t\t\t\t\t\t\t<DataListColumns\n\t\t\t\t\t\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: <span className=\"text-lg font-medium\">{x.name}</span>,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Includes',\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ul className=\"list-disc pl-4\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>3 Entities</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>5 Templates</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li>5 Notifications</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\tcolumns={1}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<button className=\"text-primary-600 text-sm font-medium underline\">\n\t\t\t\t\t\t\t\t\t\t\tView More\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</Stack>\n\t\t\t\t\t\t\t\t\t<div className=\"p-4 absolute top-0 right-0\">\n\t\t\t\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\t\t\t\tchecked={selected.includes(x.id)}\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.target.checked) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelected((s) => s.filter((y) => y !== x.id))\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetSelected((s) => [...s, x.id])\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Card>\n\n\t\t\t\t\t<div className=\"flex justify-end\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ttitle: 'Save',\n\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\tintent: 'save',\n\t\t\t\t\t\t\t\tonClick: () => {},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default AddModule\n","import { FC } from 'react'\nimport PageHeading from '@primer/components/PageHeading'\nimport PageNavbar from '@primer/components/PageNavbar'\nimport { RouteComponentProps } from '@reach/router'\nimport db from 'db'\nimport { PencilIcon } from '@heroicons/react/outline'\nimport { links } from '../Settings'\nimport SectionHeader from '@primer/components/SectionHeader'\nimport Stack from '@primer/components/Stack'\nimport DataListColumns from '@primer/components/DataListColumns'\n\nconst Roles: FC<RouteComponentProps> = () => {\n\treturn (\n\t\t<>\n\t\t\t<PageHeading title=\"Settings\" />\n\n\t\t\t<PageNavbar links={links}>\n\t\t\t\t<Stack>\n\t\t\t\t\t<div className=\"px-6 pt-6\">\n\t\t\t\t\t\t<SectionHeader\n\t\t\t\t\t\t\ttitle=\"Site Settings\"\n\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Edit Site Settings',\n\t\t\t\t\t\t\t\t\ticon: <PencilIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\tto: '/settings/site-settings/edit',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"p-6\">\n\t\t\t\t\t\t<DataListColumns\n\t\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t\t{ title: 'Title', value: db.siteSettings.get('title') },\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: 'Layout',\n\t\t\t\t\t\t\t\t\tvalue: db.siteSettings.get('layout') === 'sidebar' ? 'Nav on side' : 'Nav on top',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</Stack>\n\t\t\t</PageNavbar>\n\t\t</>\n\t)\n}\n\nexport default Roles\n","export default __webpack_public_path__ + \"static/media/layout-sidebar.55a16042.svg\";","export default __webpack_public_path__ + \"static/media/layout-topbar.ff4c6906.svg\";","import { FC } from 'react'\nimport { navigate, RouteComponentProps } from '@reach/router'\nimport { ArrowLeftIcon, CheckIcon } from '@heroicons/react/outline'\nimport Form, { useForm } from '@primer/components/Form/Form'\nimport FormInput from '@primer/components/Form/FormInput'\nimport Actions from '@primer/components/Actions'\nimport PageContent from '@primer/components/PageContent'\nimport PageHeading from '@primer/components/PageHeading'\nimport Card, { CardWrapper } from '@primer/components/Card'\nimport Stack from '@primer/components/Stack'\nimport db from 'db'\nimport FormSection from '@primer/components/Form/FormSection'\nimport { EntityModel, SiteSettings } from 'db/types'\nimport LayoutSidebar from 'assets/img/layout-sidebar.svg'\nimport LayoutTopbar from 'assets/img/layout-topbar.svg'\nimport { watch } from '@primer/components/Form/utils'\nimport clsx from 'clsx'\nimport Table, { TableCol, TableSchema } from '@primer/components/Table'\nimport { getIn } from 'formik'\nimport Checkbox from '@primer/components/Checkbox'\nimport FormEditor from '@primer/components/Form/FormEditor'\n\ntype FormSchema = SiteSettings & {\n\tnav: {\n\t\t[x: string]: {\n\t\t\tlink: string\n\t\t\tpermissions: string[]\n\t\t}\n\t}\n\tsignature: string\n}\n\nconst SiteSettingsForm: FC<RouteComponentProps> = () => {\n\tconst formContext = useForm<FormSchema>({\n\t\tinitialValues: {\n\t\t\ttitle: db.siteSettings.get('title') || '',\n\t\t\tlayout: db.siteSettings.get('layout') || 'sidebar',\n\t\t\tnav: db.entities.all().reduce(\n\t\t\t\t(list, entity) => ({\n\t\t\t\t\t...list,\n\t\t\t\t\t[entity.key]: {\n\t\t\t\t\t\tlink: entity.plural || entity.name,\n\t\t\t\t\t\tpermissions: db.roles.all().map((x) => x.id),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\t{}\n\t\t\t),\n\t\t\tsignature: '',\n\t\t},\n\t\tonSubmit: (formValues) => {\n\t\t\tdb.siteSettings.set('title', formValues.title)\n\t\t\tdb.siteSettings.set('layout', formValues.layout)\n\n\t\t\tnavigate(`${process.env.PUBLIC_URL}/settings/site-settings`)\n\t\t},\n\t})\n\n\tconst layout = watch('layout', formContext)\n\n\tconst navSchema: TableSchema<EntityModel> = {\n\t\tcols: [\n\t\t\t{\n\t\t\t\ttitle: 'Entity Type',\n\t\t\t\tvalue: (x) => x.name,\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Link Name',\n\t\t\t\tvalue: (x) => <FormInput name={`nav.${x.key}.link`} />,\n\t\t\t},\n\t\t\t...db.roles.all().map<TableCol<EntityModel>>((role) => ({\n\t\t\t\ttitle: role.name,\n\t\t\t\tvalue: (x) => {\n\t\t\t\t\tlet perms = getIn(formContext.values, `nav.${x.key}.permissions`) as string[]\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div className=\"w-full flex justify-center\">\n\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\tchecked={perms?.includes(role.id)}\n\t\t\t\t\t\t\t\tonChange={(e) =>\n\t\t\t\t\t\t\t\t\tformContext.setFieldValue(\n\t\t\t\t\t\t\t\t\t\t`nav.${x.key}.permissions`,\n\t\t\t\t\t\t\t\t\t\te.target.checked ? [...perms, role.id] : perms.filter((y) => y !== role.id)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\twidth: 'minmax(auto, max-content)',\n\t\t\t})),\n\t\t],\n\t}\n\n\tconst title = 'Edit Site Settings'\n\n\treturn (\n\t\t<>\n\t\t\t<PageHeading\n\t\t\t\tpageTitle={title}\n\t\t\t\ttitle={\n\t\t\t\t\t<div className=\"flex items-center space-x-3\">\n\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\tactions={{\n\t\t\t\t\t\t\t\ticon: <ArrowLeftIcon className=\"w-5 h-5 -mx-2\" />,\n\t\t\t\t\t\t\t\tintent: 'borderless',\n\t\t\t\t\t\t\t\trounded: 'full',\n\t\t\t\t\t\t\t\tto: '/settings/site-settings',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div>{title}</div>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t<PageContent>\n\t\t\t\t<Form context={formContext}>\n\t\t\t\t\t<Stack>\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Page Title\"\n\t\t\t\t\t\t\tsubtitle=\"This title appears in the browser tab, is important for SEO\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<FormInput name=\"title\" label=\"Title\" validations={{ required: 'Title is required' }} />\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection title=\"Layout\" subtitle=\"Control the sites layout design\">\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<div className=\"flex space-x-6\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t'w-[200px] h-[200px] relative rounded-md hover:opacity-80 cursor-pointer',\n\t\t\t\t\t\t\t\t\t\t\tlayout === 'sidebar' && 'ring-2 ring-green-500'\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tformContext.setFieldValue('layout', 'sidebar')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img src={LayoutSidebar} alt=\"Sidebar\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t'w-[200px] h-[200px] relative rounded-md hover:opacity-80 cursor-pointer',\n\t\t\t\t\t\t\t\t\t\t\tlayout === 'topbar' && 'ring-2 ring-green-500'\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tformContext.setFieldValue('layout', 'topbar')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img src={LayoutTopbar} alt=\"Topbar\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection title=\"Navigation\" subtitle=\"Set up what pages are visible in the nav bar\">\n\t\t\t\t\t\t\t<CardWrapper className=\"overflow-hidden\">\n\t\t\t\t\t\t\t\t<Table schema={navSchema} items={db.entities.all()} />\n\t\t\t\t\t\t\t</CardWrapper>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\ttitle=\"Email Signature\"\n\t\t\t\t\t\t\tsubtitle=\"This signature will be included at the bottom of every notification.\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Card>\n\t\t\t\t\t\t\t\t<FormEditor name=\"signature\" />\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t<div className=\"flex items-center justify-end\">\n\t\t\t\t\t\t\t<Actions\n\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: 'Update',\n\t\t\t\t\t\t\t\t\t\tintent: 'primary',\n\t\t\t\t\t\t\t\t\t\ticon: <CheckIcon className=\"w-5 h-5\" />,\n\t\t\t\t\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Stack>\n\t\t\t\t</Form>\n\t\t\t</PageContent>\n\t\t</>\n\t)\n}\n\nexport default SiteSettingsForm\n","import { FC } from 'react'\nimport { RouteComponentProps } from '@reach/router'\n\nconst Test: FC<RouteComponentProps> = () => {\n\treturn <div>Hi</div>\n}\n\nexport default Test\n","import { FC, Suspense } from 'react'\nimport { Router, Redirect, RouteComponentProps } from '@reach/router'\nimport db from 'db'\n\nimport PageSidebar from '@primer/components/Layouts/PageSidebar'\nimport PageTopbar from '@primer/components/Layouts/PageTopbar'\n\nimport Login from 'pages/Login/Login'\n\n// logged in\nimport Home from 'pages/Home'\nimport NotFound from 'pages/NotFound'\n\n// entity\nimport Units from 'pages/Units/Units'\nimport ViewUnit from 'pages/Units/ViewUnit'\nimport UnitForm from 'pages/Units/UnitForm'\nimport UnitHistory from 'pages/Units/UnitHistory'\nimport PageBuilder from 'pages/PageBuilder/PageBuilder'\n\n// entity value\nimport ValueHistory from 'pages/Values/ValueHistory'\n\n// settings\nimport Settings from 'pages/Settings/Settings'\n\n// notifications\nimport Notifications from 'pages/Settings/Notifications/Notifications'\nimport NotificationForm from 'pages/Settings/Notifications/NotificationForm'\n\n// templates\nimport Templates from 'pages/Settings/Templates/Templates'\nimport TemplateForm from 'pages/Settings/Templates/TemplateForm'\n\n// roles\nimport Roles from 'pages/Settings/Roles/Roles'\nimport RoleForm from 'pages/Settings/Roles/RoleForm'\n\n// entities\nimport Entities from 'pages/Settings/Entities/Entities'\nimport EntityForm from 'pages/Settings/Entities/EntityForm'\n\n// workflows\nimport Workflows from 'pages/Settings/Workflows/Workflows'\nimport WorkflowForm from 'pages/Settings/Workflows/WorkflowForm'\n\n// modules\nimport Modules from 'pages/Settings/Modules/Modules'\nimport AddModule from 'pages/Settings/Modules/AddModule'\n\n// site settings\nimport SiteSettings from 'pages/Settings/SiteSettings/SiteSettings'\nimport SiteSettingsForm from 'pages/Settings/SiteSettings/SiteSettingsForm'\n\nimport Test from 'pages/Test'\n\nconst isDev = !process.env.NODE_ENV || process.env.NODE_ENV === 'development'\n\nconst Route: FC<RouteComponentProps> = ({ children }) => <>{children}</>\n\nconsole.log('process.env', process.env)\n\nconst Router2 = () => {\n\tconst Wrapper = db.siteSettings.get('layout') === 'sidebar' ? PageSidebar : PageTopbar\n\n\tconst entities = db.entities.all()\n\n\treturn (\n\t\t<Suspense fallback={null}>\n\t\t\t<Router basepath={process.env.PUBLIC_URL}>\n\t\t\t\t<Login path=\"/login\" />\n\n\t\t\t\t{entities.map((entity) => (\n\t\t\t\t\t<PageBuilder key={entity.id} path={`/${entity.key}/:id/plan/:keyName`} />\n\t\t\t\t))}\n\n\t\t\t\t<WorkflowForm path=\"/settings/workflows/create\" mode=\"create\" />\n\t\t\t\t<WorkflowForm path=\"/settings/workflows/:id/edit\" mode=\"edit\" />\n\n\t\t\t\t<Wrapper path=\"/\">\n\t\t\t\t\t<Redirect from=\"/\" to=\"home\" noThrow={isDev} />\n\t\t\t\t\t<NotFound default />\n\t\t\t\t\t<Home path=\"/home\" />\n\t\t\t\t\t<Home path=\"/events\" />\n\t\t\t\t\t<Home path=\"/users\" />\n\n\t\t\t\t\t{entities.map((entity) => (\n\t\t\t\t\t\t<Route key={entity.id} path={`/${entity.key}`}>\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Units path=\"/\" entityId={entity.id} />\n\t\t\t\t\t\t\t<ViewUnit path=\":id\" />\n\t\t\t\t\t\t\t<UnitForm path=\"/create\" entityId={entity.id} mode=\"create\" />\n\t\t\t\t\t\t\t<UnitHistory path=\":id/history\" />\n\t\t\t\t\t\t\t<UnitForm path=\":id/edit\" entityId={entity.id} mode=\"edit\" />\n\t\t\t\t\t\t\t{/* <PageBuilder path=\":id/plan/:name\" /> */}\n\t\t\t\t\t\t</Route>\n\t\t\t\t\t))}\n\n\t\t\t\t\t<ValueHistory path=\"/value-history/:id\" />\n\n\t\t\t\t\t<Settings path=\"/settings\">\n\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t<Redirect from=\"/\" to=\"entities\" noThrow={isDev} />\n\n\t\t\t\t\t\t<Route path=\"/entities\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Entities path=\"/\" />\n\t\t\t\t\t\t\t<EntityForm path=\"/create\" mode=\"create\" />\n\t\t\t\t\t\t\t<EntityForm path=\":id/edit\" mode=\"edit\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/roles\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Roles path=\"/\" />\n\t\t\t\t\t\t\t<RoleForm path=\"/create\" mode=\"create\" />\n\t\t\t\t\t\t\t<RoleForm path=\":id/edit\" mode=\"edit\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/templates\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Templates path=\"/\" />\n\t\t\t\t\t\t\t<TemplateForm path=\"/create\" mode=\"create\" />\n\t\t\t\t\t\t\t<TemplateForm path=\":id/edit\" mode=\"edit\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/notifications\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Notifications path=\"/\" />\n\t\t\t\t\t\t\t<NotificationForm path=\"/create\" mode=\"create\" />\n\t\t\t\t\t\t\t<NotificationForm path=\":id/edit\" mode=\"edit\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/workflows\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Workflows path=\"/\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/modules\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<Modules path=\"/\" />\n\t\t\t\t\t\t\t<AddModule path=\"/add\" />\n\t\t\t\t\t\t</Route>\n\n\t\t\t\t\t\t<Route path=\"/site-settings\">\n\t\t\t\t\t\t\t<NotFound default />\n\t\t\t\t\t\t\t<SiteSettings path=\"/\" />\n\t\t\t\t\t\t\t<SiteSettingsForm path=\"/edit\" />\n\t\t\t\t\t\t</Route>\n\t\t\t\t\t</Settings>\n\n\t\t\t\t\t{/* <PageBuilder path=\"/page-builder\" /> */}\n\t\t\t\t</Wrapper>\n\t\t\t\t<Test path=\"/test\" />\n\t\t\t</Router>\n\t\t</Suspense>\n\t)\n}\n\nexport default Router2\n","import { useEffect, useReducer } from 'react'\nimport Router from './Router'\nimport 'react-quill/dist/quill.snow.css'\nimport './main.css'\nimport { renderContainer } from 'db'\n\nconst App = () => {\n\tconst [, dispatch] = useReducer(() => ({}), {})\n\tuseEffect(() => {\n\t\trenderContainer.current = dispatch\n\t}, [dispatch])\n\n\treturn <Router />\n}\n\nexport default App\n","import { Suspense } from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nconsole.log('build #' + process.env.REACT_APP_COMMIT)\n\nReactDOM.render(\n\t<Suspense fallback={null}>\n\t\t<App />\n\t</Suspense>,\n\tdocument.getElementById('root')\n)\n"],"sourceRoot":""}